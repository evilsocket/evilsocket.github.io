<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>This Is Not a Post About BLE, Introducing BLEAH | evilsocket</title>
<meta name="description" content="This is not a post about BLE, but rather on how to hack it … well, to be honest, BLE devices are usually very easy to hack, so it’s just a quick intro to it, I’">


  <link rel="alternate" href="/atom.xml" title="evilsocket" type="application/atom+xml">


<link rel="icon" href="/images/favicon.ico">

<!-- Open Graph -->
<meta property="og:type" content="article">
<meta property="og:title" content="This Is Not a Post About BLE, Introducing BLEAH">
<meta property="og:description" content="This is not a post about BLE, but rather on how to hack it … well, to be honest, BLE devices are usually very easy to hack, so it’s just a quick intro to it, I’">
<meta property="og:url" content="/2017/09/23/This-is-not-a-post-about-BLE-introducing-BLEAH/">
<meta property="og:site_name" content="evilsocket">

  
  
    <meta property="og:image" content="/images/2017/09/dr_evil.jpg">
  


<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="This Is Not a Post About BLE, Introducing BLEAH">
<meta name="twitter:description" content="This is not a post about BLE, but rather on how to hack it … well, to be honest, BLE devices are usually very easy to hack, so it’s just a quick intro to it, I’">

<!-- Schema.org JSON-LD -->


<script type="application/ld+json">
{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.evilsocket.net/2017/09/23/This-is-not-a-post-about-BLE-introducing-BLEAH/"},"headline":"This Is Not a Post About BLE, Introducing BLEAH","description":"This is not a post about BLE, but rather on how to hack it … well, to be honest, BLE devices are usually very easy to hack, so it’s just a quick intro to it, I’","image":"https://www.evilsocket.net/images/2017/09/dr_evil.jpg","datePublished":"2017-09-23T15:06:56.000Z","dateModified":"2020-05-26T20:30:56.000Z","author":{"@type":"Person","name":"Simone Margaritelli","description":"Italian cybersecurity researcher and open-source developer","url":"https://www.evilsocket.net","sameAs":["https://github.com/evilsocket","https://twitter.com/evilsocket","http://it.linkedin.com/in/simonemargaritelli/"],"jobTitle":"Security Researcher","worksFor":{"@type":"Organization","name":"Independent"}},"publisher":{"@type":"Organization","name":"evilsocket","url":"https://www.evilsocket.net","logo":{"@type":"ImageObject","url":"https://www.evilsocket.net/images/glider.png"}},"keywords":"ble, btle, bluetooth, bluetooth low energy, bleah","articleSection":"Technology","inLanguage":"en"}
</script>


<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<!-- Styles -->
<link rel="stylesheet" href="/css/style.css">


<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-22026549-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-22026549-1');
</script>


<meta name="generator" content="Hexo 5.4.2"></head>
<body class="post-page">
  <header class="site-header">
  <div class="header-inner">
    <div class="site-branding">
      <a href="/" class="site-logo">
        
          <img src="/images/glider.png" alt="evilsocket" width="50" height="50">
        
        <div class="site-title-group">
          <span class="site-title">evilsocket</span>
          <span class="site-motto">Preoccupied with a single leaf, you won't see the tree. Preoccupied with a single tree... you'll miss the entire forest.</span>
        </div>
      </a>
    </div>
    
    <nav class="site-nav">
      
        <a href="/" class="nav-link">
          HOME
        </a>
      
        <a href="/atom.xml" class="nav-link">
          RSS
        </a>
      
    </nav>
  </div>
</header>

  
  <main class="main-content">
    <article class="post-full">
  <header class="post-header">
    <h1 class="post-title">This Is Not a Post About BLE, Introducing BLEAH</h1>
    <div class="post-meta">
      BY <span class="post-author">Simone Margaritelli</span>
      — <time datetime="2017-09-23T15:06:56.000Z">23 Sep 2017</time>
      
        — <a href="/tags/ble/" class="post-category">ble</a>, <a href="/tags/btle/" class="post-category">btle</a>, <a href="/tags/bluetooth/" class="post-category">bluetooth</a>, <a href="/tags/bluetooth-low-energy/" class="post-category">bluetooth low energy</a>, <a href="/tags/bleah/" class="post-category">bleah</a>
      
    </div>
  </header>

  <div class="post-content">
    <p>This is not a post about BLE, but rather on how to hack it … well, to be honest, BLE devices are usually very easy to hack, so it’s just a quick intro to it, I’ll also take the chance to open source one of the last tools I’ve made and that I kept private so far. I moved the features I thought to be dangerous ( aka: auto fuzzing all the BLE things and bring chaos ) in a private fork which will stay private, however it’s not that complicated to chain <code>bleah</code> with other tools ( cough … radamsa … cough ) and have <strong>lots of fun</strong>.</p>
<p><img src="/images/2017/09/dr_evil.jpg" alt="dr.evil"></p>
<p>Oh and this is also because <a target="_blank" rel="noopener" href="https://twitter.com/Viss">someone</a> asked me some intro on BLE, so yeah, his fault.</p>
<span id="more"></span>

<p>For some more detailed (and serious) information, there’s <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Bluetooth_Low_Energy">a lot of stuff</a> online already, you know how to Google.</p>
<h3 id="Bluetooth-Low-Energy-the-honest-version"><a href="#Bluetooth-Low-Energy-the-honest-version" class="headerlink" title="Bluetooth Low Energy - the honest version."></a>Bluetooth Low Energy - the honest version.</h3><p>BLE is a cheap and very insecure version of Bluetooth, in which you have no channel hopping (all hail easy sniffing and MITM!) and no builtin protocol security (fuzzing like there’s no tomorrow dudez!), it is mostly used for two reasons:</p>
<ul>
<li>Decent batteries are expensive.</li>
<li>Decent batteries are big.</li>
</ul>
<p>If you wanna build and sell some IoT-smart-whatever crap, and you wanna do it quickly because your competitor is about to go on the market with the same shit, you take Bluetooth, you strip it from the very few close-to-decent things it has and voilà, you have its retarded little brother which won’t bother the battery too much but will be functional enough to burp random data at you from time to time … easy win, litte R&amp;D efforts, very small production costs.</p>
<p>&lt;/rant&gt;</p>
<p>Being the retarded little brother of BT, it doesn’t really take too long to explain how to hack it.</p>
<p>Imagine you have a BT device, which 99% of the times it’s discoverable, on the same frequency and channel, always, that literally burps at you its information ( what it’s called <strong>advertisement data</strong>, <a href="/2015/01/29/nike-fuelband-se-ble-protocol-reversed/">sometimes they also broadcast security tokens</a>, etc … to anyone … ), you connect to it (because 99.999999% of the times it allows anyone to connect) and the device tells you <strong>everything</strong> you need to know in order to control it, read data from it and write data to it … how kind, isn’t it? :D</p>
<p>You are provided with read and write primitives / channels ( called <code>characteristics</code> ), each one with a specific identifier, some of them <a target="_blank" rel="noopener" href="https://www.bluetooth.com/specifications/gatt/services">are standard</a> and some of them are usually vendor specific, therefore you won’t be able to easily map something like <code>d0611e78-bbb4-4591-a5f8-487910ae4366</code> to something like <code>Apple Continuity Service</code> (more on how to solve this problem later).</p>
<p>Rather than this, all the implementation details ( aka: the communication protocol ) are up to the vendor … you see now?</p>
<p><img src="/images/2017/09/chaos.jpg" alt="pure chaos"></p>
<h3 id="Methodologies-and-required-hardware"><a href="#Methodologies-and-required-hardware" class="headerlink" title="Methodologies and required hardware (?)"></a>Methodologies and required hardware (?)</h3><p>As I was saying yesterday night to Viss, you can approach BLE hacking in two ways.</p>
<p>You can go passive, therefore you’ll need a <a target="_blank" rel="noopener" href="https://github.com/greatscottgadgets/ubertooth">Ubertooth One</a> to sniff raw BLE packets out of the air and Wireshark to visualize them. In this case you’ll end up performing signal analysis / RE on the raw bitstream you’ve managed to capture, simply try some replay attack or blackbox fuzzing ( aka: throw mutated stuff back at the mother fucker ). As for this first methodology, <a target="_blank" rel="noopener" href="http://blog.attify.com/2017/01/17/exploiting-iot-enabled-ble-smart-bulb-security/">there’re already</a> plenty of good examples online, it’s just like sniffing TCP, but with BLE.</p>
<p>Or you can go active (the way I like it :D), and that doesn’t require any specific hardware other than a bluetooth dongle which supports BLE, most likely your Linux laptop already does, and exploit those little bastards for what they are, just <strong>retarded bluetooth devices</strong>. Find the mobile app (they always have one, they’re <strong>smart</strong> toys after all), reverse it to find the right characteristics to use for your goal and then just blow the thing up. My point is that you’ll end up reversing “something” anyway, so let it be cheap and effective, right?</p>
<p>Let’s start by verifying if your hardware supports BLE by performing a scan ( I’m assuming you are using GNU/Linux, bluez and all the default BT stack utilities are installed, etc ):</p>
<pre><code>sudo hcitool lescan</code></pre>
<p>If it worked, you’ll see an output like:</p>
<pre><code>LE Scan ...
AA:BB:CC:DD:EE:FF (unknown)
AA:BB:CC:DD:EE:FF STORZ&amp;BICKEL
AA:BB:CC:DD:EE:FF (unknown)
AA:BB:CC:DD:EE:FF (unknown)
AA:BB:CC:DD:EE:FF (unknown)
AA:BB:CC:DD:EE:FF (unknown)
AA:BB:CC:DD:EE:FF (unknown)
AA:BB:CC:DD:EE:FF (unknown)
AA:BB:CC:DD:EE:FF (unknown)
AA:BB:CC:DD:EE:FF [LG] webOS TV OLED55E6V</code></pre>
<p>That means you’re ready to go. Go find the Android application of the device and reverse it, <a href="/2017/04/27/Android-Applications-Reversing-101/">here’s my 1 on 1 on Android reversing</a> and <a href="/tags/bluetooth/">here</a> you will find a few examples of how to use this approach.</p>
<p>I could now explain you how to read advertisement data using <code>hcitool</code>, how to connect to it using <code>gatttool</code> and how to enumerate services, characteristics and handles, how to mask flags and translate their bits to permissions, etc … but I made it a little bit easier for you (and for me), so let’s skip this boring stuff ok? :P</p>
<h3 id="Introducing-BLEAH"><a href="#Introducing-BLEAH" class="headerlink" title="Introducing BLEAH"></a>Introducing BLEAH</h3><p><a target="_blank" rel="noopener" href="https://github.com/evilsocket/bleah">BLEAH</a> is a <strong>dead easy to use tool</strong>, because retarded devices should be <strong>dead easy to hack</strong>, based on <a target="_blank" rel="noopener" href="https://github.com/IanHarvey">Iah Harvey</a>‘s <code>bluepy</code> python package.</p>
<p>But let me give you some examples and swag.</p>
<p>Scanning for BTLE devices continuously:</p>
<pre><code>sudo bleah -t0</code></pre>
<p><img src="/images/2017/09/ss1.png" alt="scan"></p>
<p>Connect to a specific device and enumerate all the things:</p>
<pre><code>sudo bleah -b &quot;aa:bb:cc:dd:ee:ff&quot; -e</code></pre>
<p><img src="/images/2017/09/ss2.png" alt="enum"></p>
<p>Write the bytes <code>hello world</code> to a specific characteristic of the device:</p>
<pre><code>sudo bleah -b &quot;aa:bb:cc:dd:ee:ff&quot; -u &quot;c7d25540-31dd-11e2-81c1-0800200c9a66&quot; -d &quot;hello world&quot;</code></pre>
<p><img src="/images/2017/09/ss3.png" alt="write"></p>
<p>Hint: there’s a <code>--data-file</code> argument which is perfect in combination with things like <code>radamsa</code> … just saying.</p>
<p>As usual the public fork of this tool is on <a target="_blank" rel="noopener" href="https://github.com/evilsocket/bleah">github</a>, now you know and have everything you need to bring chaos in the BLE world, enjoy :D</p>
<div style="position:relative;height:0;padding-bottom:75.0%"><iframe src="https://www.youtube.com/embed/qbmWs6Jf5dc?ecver=2" width="480" height="360" frameborder="0" style="position:absolute;width:100%;height:100%;left:0" allowfullscreen></iframe></div>

  </div>

  
    <div class="post-tags">
      
        <a href="/tags/ble/" class="tag">#ble</a>
      
        <a href="/tags/btle/" class="tag">#btle</a>
      
        <a href="/tags/bluetooth/" class="tag">#bluetooth</a>
      
        <a href="/tags/bluetooth-low-energy/" class="tag">#bluetooth low energy</a>
      
        <a href="/tags/bleah/" class="tag">#bleah</a>
      
    </div>
  

  <nav class="post-navigation">
    
      <a href="/2017/12/07/DIY-Portable-Secrets-Manager-with-a-RPI-Zero-and-the-ARC-Project/" class="nav-prev">
        <span class="nav-label">PREVIOUS</span>
        <span class="nav-title">DIY Portable Secrets Manager With a Raspberry Pi Zero and ARC</span>
      </a>
    
    
      <a href="/2017/08/25/Mini-Post-Hacking-a-Herb-Vaporizer-using-GNU-Linux-and-BLE-raw-commands/" class="nav-next">
        <span class="nav-label">NEXT</span>
        <span class="nav-title">Hacking a Herb Vaporizer to Set Its Temperature Limit From 190C to 6553.5C Remotely</span>
      </a>
    
  </nav>
</article>


  


<section class="related-posts">
  <h3 class="related-title">YOU MIGHT ALSO LIKE...</h3>
  <div class="cards-grid cards-grid-related">
    
      

<article class="card card-light">
  <a href="/2018/07/28/Project-PITA-Writeup-build-a-mini-mass-deauther-using-bettercap-and-a-Raspberry-Pi-Zero-W/" class="card-link">
    
      <div class="card-image" style="background-image: url('/images/2018/07/deauth.png')">
        
      </div>
    
    
    
      <div class="card-content">
        <h2 class="card-title">Project PITA: Build a Mini Mass Deauther Using Bettercap and a Raspberry Pi Zero W</h2>
        
        <div class="card-footer">
          <span class="card-read-more">READ MORE</span>
        </div>
      </div>
    
  </a>
</article>

    
      

<article class="card card-overlay">
  <a href="/2018/02/27/All-hail-bettercap-2-0-one-tool-to-rule-them-all/" class="card-link">
    
      <div class="card-image" style="background-image: url('https://www.bettercap.org/img/logo.png')">
        
          <div class="card-overlay-content">
            <h2 class="card-title">All Hail Bettercap 2.0, One Tool to Rule Them All.</h2>
            <span class="card-read-more">READ MORE</span>
          </div>
        
      </div>
    
    
    
  </a>
</article>

    
      

<article class="card card-overlay">
  <a href="/2017/08/25/Mini-Post-Hacking-a-Herb-Vaporizer-using-GNU-Linux-and-BLE-raw-commands/" class="card-link">
    
      <div class="card-image" style="background-image: url('/images/2017/08/ble_1.png')">
        
          <div class="card-overlay-content">
            <h2 class="card-title">Hacking a Herb Vaporizer to Set Its Temperature Limit From 190C to 6553.5C Remotely</h2>
            <span class="card-read-more">READ MORE</span>
          </div>
        
      </div>
    
    
    
  </a>
</article>

    
      

<article class="card card-light">
  <a href="/2015/02/12/RuberTooth-A-complete-Ruby-porting-of-the-ubertooth-libraries-and-utilities/" class="card-link">
    
      <div class="card-image" style="background-image: url('/images/2015/02/ubertooth.jpg')">
        
      </div>
    
    
    
      <div class="card-content">
        <h2 class="card-title">RuberTooth - a Complete Ruby Porting of the Ubertooth Libraries and Utilities.</h2>
        
        <div class="card-footer">
          <span class="card-read-more">READ MORE</span>
        </div>
      </div>
    
  </a>
</article>

    
  </div>
</section>




  </main>
  
  <footer class="site-footer">
  <div class="footer-inner">
    <div class="footer-social">
      
        
          
            <a href="https://github.com/evilsocket" class="social-link" target="_blank" rel="noopener" aria-label="GitHub">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
            </a>
          
        
          
            <a href="https://twitter.com/evilsocket" class="social-link" target="_blank" rel="noopener" aria-label="Twitter">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
            </a>
          
        
          
            <a href="http://it.linkedin.com/in/simonemargaritelli/" class="social-link" target="_blank" rel="noopener" aria-label="LinkedIn">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
            </a>
          
        
          
        
          
            <a href="mailto:evilsocket@gmail.com" class="social-link" aria-label="Email">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
            </a>
          
        
      
    </div>
    <p class="footer-copyright">
      &copy; 2025 evilsocket. 
      Powered by <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a>.
    </p>
  </div>
</footer>

  <!-- Minimal JS - no external dependencies needed -->
<script>
  // Lazy load images
  document.addEventListener('DOMContentLoaded', function() {
    var images = document.querySelectorAll('.card-image[data-bg]');
    images.forEach(function(img) {
      img.style.backgroundImage = 'url(' + img.dataset.bg + ')';
    });
  });
</script>

</body>
</html>
