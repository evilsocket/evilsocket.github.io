<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Hacking a Herb Vaporizer to Set Its Temperature Limit From 190C to 6553.5C Remotely | evilsocket</title>
<meta name="description" content="Tonight my brain decided, instead of sleeping (why even bother trying, right?), to start a new short adventure in the Bluetooth Low Energy world. I’m a happy Cr">


  <link rel="alternate" href="/atom.xml" title="evilsocket" type="application/atom+xml">


<link rel="icon" href="/images/favicon.ico">

<!-- Open Graph -->
<meta property="og:type" content="article">
<meta property="og:title" content="Hacking a Herb Vaporizer to Set Its Temperature Limit From 190C to 6553.5C Remotely">
<meta property="og:description" content="Tonight my brain decided, instead of sleeping (why even bother trying, right?), to start a new short adventure in the Bluetooth Low Energy world. I’m a happy Cr">
<meta property="og:url" content="/2017/08/25/Mini-Post-Hacking-a-Herb-Vaporizer-using-GNU-Linux-and-BLE-raw-commands/">
<meta property="og:site_name" content="evilsocket">

  
  
    <meta property="og:image" content="/images/2017/08/ble_1.png">
  


<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Hacking a Herb Vaporizer to Set Its Temperature Limit From 190C to 6553.5C Remotely">
<meta name="twitter:description" content="Tonight my brain decided, instead of sleeping (why even bother trying, right?), to start a new short adventure in the Bluetooth Low Energy world. I’m a happy Cr">

<!-- Schema.org JSON-LD -->


<script type="application/ld+json">
{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.evilsocket.net/2017/08/25/Mini-Post-Hacking-a-Herb-Vaporizer-using-GNU-Linux-and-BLE-raw-commands/"},"headline":"Hacking a Herb Vaporizer to Set Its Temperature Limit From 190C to 6553.5C Remotely","description":"Tonight my brain decided, instead of sleeping (why even bother trying, right?), to start a new short adventure in the Bluetooth Low Energy world. I’m a happy Cr","image":"https://www.evilsocket.net/images/2017/08/ble_1.png","datePublished":"2017-08-25T01:10:53.000Z","dateModified":"2025-12-19T18:35:53.164Z","author":{"@type":"Person","name":"Simone Margaritelli","description":"Italian cybersecurity researcher, hacker, and open-source developer with over two decades of experience in network security, AI, and offensive security tools.","url":"https://www.evilsocket.net","image":"https://www.evilsocket.net/images/glider.png","sameAs":["https://github.com/evilsocket","https://twitter.com/evilsocket","http://it.linkedin.com/in/simonemargaritelli/","https://www.goodreads.com/evilsocket","https://www.patreon.com/evilsocket","https://keybase.io/evilsocket"],"jobTitle":"Security Researcher","knowsAbout":["Cybersecurity","Penetration Testing","Network Security","Reverse Engineering","Open Source Development","Wireless Security","Machine Learning","Go Programming","Python","C/C++"],"award":["Creator of bettercap","Creator of pwnagotchi","Creator of OpenSnitch","CVE-2024-47176 discoverer"]},"publisher":{"@type":"Organization","name":"evilsocket","url":"https://www.evilsocket.net","logo":{"@type":"ImageObject","url":"https://www.evilsocket.net/images/glider.png"}},"keywords":"hacking, ble, linux, embedded devices, iot security, protocol reversing, btle, bluetooth, bluetooth low energy, low energy, terminal, crafty vaporizer, crafty, vaporizer, no authentication","articleSection":"Cybersecurity","inLanguage":"en"}
</script>


<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<!-- Styles -->
<link rel="stylesheet" href="/css/style.css">


<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-22026549-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-22026549-1');
</script>


<meta name="generator" content="Hexo 5.4.2"></head>
<body class="post-page">
  <header class="site-header">
  <div class="header-inner">
    <div class="site-branding">
      <a href="/" class="site-logo">
        
          <img src="/images/glider.png" alt="evilsocket" width="50" height="50">
        
        <div class="site-title-group">
          <span class="site-title">evilsocket</span>
          <span class="site-motto">Preoccupied with a single leaf, you won't see the tree. Preoccupied with a single tree... you'll miss the entire forest.</span>
        </div>
      </a>
    </div>
    
    <nav class="site-nav">
      
        <a href="/" class="nav-link">
          HOME
        </a>
      
        <a href="/atom.xml" class="nav-link">
          RSS
        </a>
      
    </nav>
  </div>
</header>

  
  <main class="main-content">
    <article class="post-full">
  <header class="post-header">
    <h1 class="post-title">Hacking a Herb Vaporizer to Set Its Temperature Limit From 190C to 6553.5C Remotely</h1>
    <div class="post-meta">
      BY <span class="post-author">Simone Margaritelli</span>
      — <time datetime="2017-08-25T01:10:53.000Z">25 Aug 2017</time>
      
        — <a href="/tags/hacking/" class="post-category">hacking</a>, <a href="/tags/ble/" class="post-category">ble</a>, <a href="/tags/linux/" class="post-category">linux</a>, <a href="/tags/embedded-devices/" class="post-category">embedded devices</a>, <a href="/tags/iot-security/" class="post-category">iot security</a>, <a href="/tags/protocol-reversing/" class="post-category">protocol reversing</a>, <a href="/tags/btle/" class="post-category">btle</a>, <a href="/tags/bluetooth/" class="post-category">bluetooth</a>, <a href="/tags/bluetooth-low-energy/" class="post-category">bluetooth low energy</a>, <a href="/tags/low-energy/" class="post-category">low energy</a>, <a href="/tags/terminal/" class="post-category">terminal</a>, <a href="/tags/crafty-vaporizer/" class="post-category">crafty vaporizer</a>, <a href="/tags/crafty/" class="post-category">crafty</a>, <a href="/tags/vaporizer/" class="post-category">vaporizer</a>, <a href="/tags/no-authentication/" class="post-category">no authentication</a>
      
    </div>
    <br/>
    <a target="_blank" rel="noopener" href="https://twitter.com/evilsocket" class="twitter-follow-button" data-show-count="false">Follow me on X</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
  </header>

  <div class="post-content">
    <p>Tonight my brain decided, instead of sleeping (why even bother trying, right?), to start a <a href="/2015/01/29/nike-fuelband-se-ble-protocol-reversed/">new</a> short adventure in the <strong>Bluetooth Low Energy</strong> world. I’m a happy <a target="_blank" rel="noopener" href="https://www.storz-bickel.com/eu/en/crafty.html">Crafty</a> vaporizer owner and as I discovered by chance, I can access it using my laptop.</p>
<p><img src="/images/2017/08/ble_1.png" alt="ble_1"></p>
<span id="more"></span>

<p>BTLE is conceptually easy, you’ve got “descriptors”, each one with an unique identifier and each one is arbitrarily used by the vendor for configuration purposes, control of the device, etc by read or write operations. So, first thing first, let’s reverse <a target="_blank" rel="noopener" href="https://play.google.com/store/apps/details?id=com.storz_bickel.app.m_vap">their mobile application</a> in order to identify interesting descriptors!</p>
<p><img src="/images/2017/08/ble_2.png" alt="ble_2"></p>
<p>Here it is, we can read and write stuff with <strong>no authentication whatsoever</strong> … so, let’s get evil, shall we? :) </p>
<p>How about writing to:</p>
<pre><code>public static final UUID characteristicTargetTemperatureUUID = UUID.fromString(&quot;00000021-4C45-4B43-4942-265A524F5453&quot;);</code></pre>
<p>The target temperature ( 190 C in my case ) is multiplied by 10 (<del>don’t ask</del> as someone <a target="_blank" rel="noopener" href="https://www.reddit.com/r/netsec/comments/6vvroj/hacking_a_herb_vaporizer_to_set_its_temperature/dm4e4gj/">vigorously pointed out</a>, that’s <em>“pretty common when you don’t have/want floating-point arithmetic, or you want to represent exact values for a certain precision”</em> … it doesn’t really matter for the scope of this blog post, but now we’re all happy) and stored as two bytes, <strong>so let’s try to overwrite it with the maximum!</strong> <em>-put evil laugh here-</em></p>
<p><img src="/images/2017/08/ble_temp.png" alt="ble_temp"></p>
<p>Which should be a limit of 6553.5 Celsius degrees.</p>
<p><img src="/images/2017/08/pew.jpg" alt="pew pew"></p>
<p><strong>BOOM BABY!!!</strong> <strong>I have no idea what happens if I turn it on now</strong> … it’s the only Crafty I have, and it’s not cheap, I’m not going to try, but the options are:</p>
<ol>
<li>Hopefully some firmware security measure blocks the device from melting.</li>
<li>Device melts in your hands.</li>
<li>Battery just dies before it melts. </li>
</ol>
<p>How likely is <strong>1</strong> given there’s no security at all at the BTLE layer? Maybe some hardware security device? If anyone has a spare Crafty to try, let me know …</p>
<h2 id="Disclosure"><a href="#Disclosure" class="headerlink" title="Disclosure"></a>Disclosure</h2><p>I can hear people screaming <strong>and what about responsible disclosure ?!</strong> … I don’t know why people give responsible disclosure for granted to be honest … I do this stuff for fun, if I need to start searching for contacts and wait for replies it becomes a job and it’s not fun anymore … ¯\_(ツ)_/¯</p>
<h2 id="Bonus-Level"><a href="#Bonus-Level" class="headerlink" title="Bonus Level"></a>Bonus Level</h2><p>On the info screen of the app, if you tap 5 times on the serial number and put the correct password, it’ll unlock some nice diagnostic menu … this is <code>SHA256(password)</code> :)</p>
<p><img src="/images/2017/08/ble_3.png" alt="ble_3"></p>
<p>Diagnostic menu options (<strong>also controllable via BTLE</strong>):</p>
<p><img src="/images/2017/08/ble_diag.png" alt="ble_3"></p>

  </div>

  
    <div class="post-tags">
      
        <a href="/tags/hacking/" class="tag">#hacking</a>
      
        <a href="/tags/ble/" class="tag">#ble</a>
      
        <a href="/tags/linux/" class="tag">#linux</a>
      
        <a href="/tags/embedded-devices/" class="tag">#embedded devices</a>
      
        <a href="/tags/iot-security/" class="tag">#iot security</a>
      
        <a href="/tags/protocol-reversing/" class="tag">#protocol reversing</a>
      
        <a href="/tags/btle/" class="tag">#btle</a>
      
        <a href="/tags/bluetooth/" class="tag">#bluetooth</a>
      
        <a href="/tags/bluetooth-low-energy/" class="tag">#bluetooth low energy</a>
      
        <a href="/tags/low-energy/" class="tag">#low energy</a>
      
        <a href="/tags/terminal/" class="tag">#terminal</a>
      
        <a href="/tags/crafty-vaporizer/" class="tag">#crafty vaporizer</a>
      
        <a href="/tags/crafty/" class="tag">#crafty</a>
      
        <a href="/tags/vaporizer/" class="tag">#vaporizer</a>
      
        <a href="/tags/no-authentication/" class="tag">#no authentication</a>
      
    </div>
  

  <nav class="post-navigation">
    
      <a href="/2017/09/23/This-is-not-a-post-about-BLE-introducing-BLEAH/" class="nav-prev">
        <span class="nav-label">PREVIOUS</span>
        <span class="nav-title">This Is Not a Post About BLE, Introducing BLEAH</span>
      </a>
    
    
      <a href="/2017/08/15/gpd-pocket-7-impressions-gnulinux-installation-and-offensive-setup/" class="nav-next">
        <span class="nav-label">NEXT</span>
        <span class="nav-title">GPD Pocket 7: Impressions, GNU/Linux Installation and Offensive Setup</span>
      </a>
    
  </nav>
</article>


  


<section class="related-posts">
  <h3 class="related-title">YOU MIGHT ALSO LIKE...</h3>
  <div class="cards-grid cards-grid-related">
    
      

<article class="card card-light">
  <a href="/2025/12/18/TP-Link-Tapo-C200-Hardcoded-Keys-Buffer-Overflows-and-Privacy-in-the-Era-of-AI-Assisted-Reverse-Engineering/" class="card-link">
    
      <div class="card-image" style="background-image: url('/images/2025/tapo/header.jpg')">
        
      </div>
    
    
    
      <div class="card-content">
        <h2 class="card-title">TP-Link Tapo C200: Hardcoded Keys, Buffer Overflows and Privacy in the Era of AI Assisted Reverse Engineering</h2>
        
        <div class="card-footer">
          <span class="card-read-more">READ MORE</span>
        </div>
      </div>
    
  </a>
</article>

    
      

<article class="card card-overlay">
  <a href="/2024/09/26/Attacking-UNIX-systems-via-CUPS-Part-I/" class="card-link">
    
      <div class="card-image" style="background-image: url('/images/2024/cups1/smart.jpg')">
        
          <div class="card-overlay-content">
            <h2 class="card-title">Attacking UNIX Systems via CUPS, Part I</h2>
            <span class="card-read-more">READ MORE</span>
          </div>
        
      </div>
    
    
    
  </a>
</article>

    
      

<article class="card card-overlay">
  <a href="/2022/10/20/Reverse-Engineering-the-Apple-MultiPeer-Connectivity-Framework/" class="card-link">
    
      <div class="card-image" style="background-image: url('/images/2022/cleartext.png')">
        
          <div class="card-overlay-content">
            <h2 class="card-title">Reverse Engineering the Apple MultiPeer Connectivity Framework</h2>
            <span class="card-read-more">READ MORE</span>
          </div>
        
      </div>
    
    
    
  </a>
</article>

    
      

<article class="card card-light">
  <a href="/2022/08/15/Process-behaviour-anomaly-detection-using-eBPF-and-unsupervised-learning-Autoencoders/" class="card-link">
    
      <div class="card-image" style="background-image: url('https://i.imgur.com/QEmpeDl.jpg')">
        
      </div>
    
    
    
      <div class="card-content">
        <h2 class="card-title">Process Behaviour Anomaly Detection Using eBPF and Unsupervised-Learning Autoencoders</h2>
        
        <div class="card-footer">
          <span class="card-read-more">READ MORE</span>
        </div>
      </div>
    
  </a>
</article>

    
  </div>
</section>




  </main>
  
  <footer class="site-footer">
  <div class="footer-inner">
    <div class="footer-social">
      
        
          
            <a href="https://github.com/evilsocket" class="social-link" target="_blank" rel="noopener" aria-label="GitHub">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
            </a>
          
        
          
            <a href="https://twitter.com/evilsocket" class="social-link" target="_blank" rel="noopener" aria-label="Twitter">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
            </a>
          
        
          
            <a href="http://it.linkedin.com/in/simonemargaritelli/" class="social-link" target="_blank" rel="noopener" aria-label="LinkedIn">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
            </a>
          
        
          
        
          
            <a href="mailto:evilsocket@gmail.com" class="social-link" aria-label="Email">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
            </a>
          
        
      
    </div>
    <p class="footer-copyright">
      &copy; 2026 evilsocket. 
      Powered by <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a>.
    </p>
  </div>
</footer>

  <script src="/a.js"></script>
<script type="text/javascript">
  A['\u0069\u006E\u0069\u0074']({ '\u0061\u0063\u0074\u0069\u006F\u006E': 'none', "statsEndpoint": "\u0068\u0074\u0074\u0070\u0073\u003A\u002F\u002F\u006E\u006F\u0062\u006F\u0074\u002D\u0073\u0074\u0061\u0074\u0073\u002E\u0065\u0076\u0069\u006C\u0073\u006F\u0063\u006B\u0065\u0074\u002E\u0077\u006F\u0072\u006B\u0065\u0072\u0073\u002E\u0064\u0065\u0076\u002F\u006C\u006F\u0067" });
</script>

<!-- Minimal JS - no external dependencies needed -->
<script>
  // Lazy load images
  document.addEventListener('DOMContentLoaded', function () {
    var images = document.querySelectorAll('.card-image[data-bg]');
    images.forEach(function (img) {
      img.style.backgroundImage = 'url(' + img.dataset.bg + ')';
    });
  });
</script>
</body>
</html>
