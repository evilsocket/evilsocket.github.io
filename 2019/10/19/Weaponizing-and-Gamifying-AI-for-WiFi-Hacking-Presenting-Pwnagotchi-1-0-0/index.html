<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Weaponizing and Gamifying AI for WiFi Hacking: Presenting Pwnagotchi 1.0.0 | evilsocket</title>
<meta name="description" content="This is the story of a summer project that started out of boredom and that evolved into something incredibly fun and unique. It is also the story of how that pr">


  <link rel="alternate" href="/atom.xml" title="evilsocket" type="application/atom+xml">


<link rel="icon" href="/images/favicon.ico">

<!-- Open Graph -->
<meta property="og:type" content="article">
<meta property="og:title" content="Weaponizing and Gamifying AI for WiFi Hacking: Presenting Pwnagotchi 1.0.0">
<meta property="og:description" content="This is the story of a summer project that started out of boredom and that evolved into something incredibly fun and unique. It is also the story of how that pr">
<meta property="og:url" content="/2019/10/19/Weaponizing-and-Gamifying-AI-for-WiFi-Hacking-Presenting-Pwnagotchi-1-0-0/">
<meta property="og:site_name" content="evilsocket">

  
  
    <meta property="og:image" content="https://i.imgur.com/X68GXrn.png">
  


<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Weaponizing and Gamifying AI for WiFi Hacking: Presenting Pwnagotchi 1.0.0">
<meta name="twitter:description" content="This is the story of a summer project that started out of boredom and that evolved into something incredibly fun and unique. It is also the story of how that pr">

<!-- Schema.org JSON-LD -->


<script type="application/ld+json">
{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.evilsocket.net/2019/10/19/Weaponizing-and-Gamifying-AI-for-WiFi-Hacking-Presenting-Pwnagotchi-1-0-0/"},"headline":"Weaponizing and Gamifying AI for WiFi Hacking: Presenting Pwnagotchi 1.0.0","description":"This is the story of a summer project that started out of boredom and that evolved into something incredibly fun and unique. It is also the story of how that pr","image":"https://www.evilsocket.nethttps://i.imgur.com/X68GXrn.png","datePublished":"2019-10-19T08:45:28.000Z","dateModified":"2025-12-19T18:35:53.166Z","author":{"@type":"Person","name":"Simone Margaritelli","description":"Italian cybersecurity researcher, hacker, and open-source developer with over two decades of experience in network security, AI, and offensive security tools.","url":"https://www.evilsocket.net","image":"https://www.evilsocket.net/images/glider.png","sameAs":["https://github.com/evilsocket","https://twitter.com/evilsocket","http://it.linkedin.com/in/simonemargaritelli/","https://www.goodreads.com/evilsocket","https://www.patreon.com/evilsocket","https://keybase.io/evilsocket"],"jobTitle":"Security Researcher","knowsAbout":["Cybersecurity","Penetration Testing","Network Security","Reverse Engineering","Open Source Development","Wireless Security","Machine Learning","Go Programming","Python","C/C++"],"award":["Creator of bettercap","Creator of pwnagotchi","Creator of OpenSnitch","CVE-2024-47176 discoverer"]},"publisher":{"@type":"Organization","name":"evilsocket","url":"https://www.evilsocket.net","logo":{"@type":"ImageObject","url":"https://www.evilsocket.net/images/glider.png"}},"keywords":"bettercap, wifi, raspberry pi, portable hacking, wireless security, ai, deep learning, dnn, machine learning, neural networks, deep neural networks, cuda, nvidia, artificial intelligence, handshake capture, monitor mode, pwnagotchi, deep reinforcement learning, reinforcement learning, handshakes","articleSection":"Cybersecurity","inLanguage":"en"}
</script>


<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<!-- Styles -->
<link rel="stylesheet" href="/css/style.css">


<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-22026549-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-22026549-1');
</script>


<meta name="generator" content="Hexo 5.4.2"></head>
<body class="post-page">
  <header class="site-header">
  <div class="header-inner">
    <div class="site-branding">
      <a href="/" class="site-logo">
        
          <img src="/images/glider.png" alt="evilsocket" width="50" height="50">
        
        <div class="site-title-group">
          <span class="site-title">evilsocket</span>
          <span class="site-motto">Preoccupied with a single leaf, you won't see the tree. Preoccupied with a single tree... you'll miss the entire forest.</span>
        </div>
      </a>
    </div>
    
    <nav class="site-nav">
      
        <a href="/" class="nav-link">
          HOME
        </a>
      
        <a href="/atom.xml" class="nav-link">
          RSS
        </a>
      
    </nav>
  </div>
</header>

  
  <main class="main-content">
    <article class="post-full">
  <header class="post-header">
    <h1 class="post-title">Weaponizing and Gamifying AI for WiFi Hacking: Presenting Pwnagotchi 1.0.0</h1>
    <div class="post-meta">
      BY <span class="post-author">Simone Margaritelli</span>
      — <time datetime="2019-10-19T08:45:28.000Z">19 Oct 2019</time>
      
        — <a href="/tags/bettercap/" class="post-category">bettercap</a>, <a href="/tags/wifi/" class="post-category">wifi</a>, <a href="/tags/raspberry-pi/" class="post-category">raspberry pi</a>, <a href="/tags/portable-hacking/" class="post-category">portable hacking</a>, <a href="/tags/wireless-security/" class="post-category">wireless security</a>, <a href="/tags/ai/" class="post-category">ai</a>, <a href="/tags/deep-learning/" class="post-category">deep learning</a>, <a href="/tags/dnn/" class="post-category">dnn</a>, <a href="/tags/machine-learning/" class="post-category">machine learning</a>, <a href="/tags/neural-networks/" class="post-category">neural networks</a>, <a href="/tags/deep-neural-networks/" class="post-category">deep neural networks</a>, <a href="/tags/cuda/" class="post-category">cuda</a>, <a href="/tags/nvidia/" class="post-category">nvidia</a>, <a href="/tags/artificial-intelligence/" class="post-category">artificial intelligence</a>, <a href="/tags/handshake-capture/" class="post-category">handshake capture</a>, <a href="/tags/monitor-mode/" class="post-category">monitor mode</a>, <a href="/tags/pwnagotchi/" class="post-category">pwnagotchi</a>, <a href="/tags/deep-reinforcement-learning/" class="post-category">deep reinforcement learning</a>, <a href="/tags/reinforcement-learning/" class="post-category">reinforcement learning</a>, <a href="/tags/handshakes/" class="post-category">handshakes</a>
      
    </div>
    <br/>
    <a target="_blank" rel="noopener" href="https://twitter.com/evilsocket" class="twitter-follow-button" data-show-count="false">Follow me on X</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
  </header>

  <div class="post-content">
    <p>This is the story of a summer project that started out of boredom and that evolved into something incredibly fun and unique. It is also the story of how that project went from being discussed on a porch by just two people, to having <a target="_blank" rel="noopener" href="https://pwnagotchi.herokuapp.com/">a community made of almost 700 awesome people</a> (and counting!) that gathered, polished it and made today’s release possible.</p>
<p><strong>TL;DR: You can <a target="_blank" rel="noopener" href="https://github.com/evilsocket/pwnagotchi/releases">download the 1.0.0 .img file from here</a>, then just <a target="_blank" rel="noopener" href="https://pwnagotchi.ai/installation/">follow the instructions</a>.</strong></p>
<p>If you want the long version instead, sit back, relax and enjoy the ride. Let me tell you: it’s going to be quite a long journey compared to my usual blog posts, but it’ll be worth it (i hope) and fun (i hope even harder).</p>
<p><img src="https://i.imgur.com/X68GXrn.png" alt="hack the planet"></p>
<p>Let’s begin …</p>
<span id="more"></span>

<p>This summer I spent ~3 months in the US and as most of the long trips I do, I had with me some basic wireless equipment for working and hacking stuff while going around. Among other things, I had my <a href="/2018/07/28/Project-PITA-Writeup-build-a-mini-mass-deauther-using-bettercap-and-a-Raspberry-Pi-Zero-W/">Raspberry Pi Zero W with PITA</a> and an iPad i use for reading, emails but also as a screen for headless boards like that RPi when I want to have some portable bettercap installation without bringing an entire laptop. </p>
<p><img src="https://i.imgur.com/aMVUNx8.jpg" alt="iPad"></p>
<h2 id="The-Predecessor"><a href="#The-Predecessor" class="headerlink" title="The Predecessor"></a>The Predecessor</h2><p>PITA as an <a target="_blank" rel="noopener" href="https://github.com/bettercap/caplets/blob/master/pita.cap">automated deauther and handshakes collector</a> isn’t exactly what you’d define “smart”: the only thing it does is deauthing everything while bettercap is doing its normal WiFi scanning things in the background, every few seconds, constantly, while passively hoping for handshakes. I wasn’t even close to satisfied: there was a lot there that could be improved and instrumented with <a target="_blank" rel="noopener" href="https://www.bettercap.org/modules/core/api.rest/">bettercap’s REST API</a>, more attacks bettercap could perform that weren’t being used. So I quickly hacked together some python code to talk with the API and use the results in a smarter way. This ended up being the very first iteration of <a target="_blank" rel="noopener" href="https://i.imgur.com/55DFIhR.jpg">a faceless and AI-less Pwnagotchi</a>.</p>
<p>As I said the code was nothing special, <a target="_blank" rel="noopener" href="https://i.imgur.com/pe5UeaJ.png">a very crude PoC</a>, but since the very first walks, it already started giving <a target="_blank" rel="noopener" href="https://i.imgur.com/js74YIk.png">way better results</a> than the original PITA. It quickly started being frustrating not being able to check what was going on with the algorithm during my warwalking sessions, so I started searching for a suitable display.</p>
<h2 id="The-Face"><a href="#The-Face" class="headerlink" title="The Face"></a>The Face</h2><p>When it’s about compactness, low power consumption and good readability under the sun, e-Paper displays have no rivals, and after educating myself a bit I settled for a <a target="_blank" rel="noopener" href="https://www.waveshare.com/wiki/2.13inch_e-Paper_HAT">Waveshare 2.13 inches e-Paper HAT</a> due to its partial refresh support and its definition - I had no idea yet about what was about to come, but now I had a canvas to work with.</p>
<p><img src="https://i.imgur.com/gX8zpGo.jpg" alt="canvas"></p>
<p>Not having a driving license I walk pretty much wherever I go, that’s a pretty nice and healthy habit to have for several reasons, but my favourite one is that walking helps me thinking. So I started staring at this thing <strong>a lot</strong>, and thinking how to add new information on the display without making the font so small to be unreadable, how to organize it visually and what else to do with all that space in general.</p>
<p>The more I thought about it, the more it made sense to organize the whole thing like the UI of a videogame: you have a score (the number of handshakes), a timer, few other statistics and everything is changing as a consequence of the WiFi things around. This is also the point where I started thinking about this thing as a creature that was “eating” the handshakes, in a way I was getting attached this new little thing (yes I know, <a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=nHpUMgAGLtM">I’m a nerd</a>) that now was so strongly reminding me of <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Tamagotchi">my old Tamagotchi</a>.</p>
<p>I needed a face, possibly map the status (“waiting …”, “scanning …”, …) to random sentences with a bit more of personality and I wanted all the other statistics to influence the expressivity of this thing: bored when there’re no new handshakes to collect, then sad, excited and so on. Something like …</p>
<center>
    <iframe src="https://player.vimeo.com/video/367423810" width="100%" height="360" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe>
</center>

<p><strong>I had no idea</strong> back then that just adding a simple, ASCII based face to something was the best way to get emotionally overly attached to that thing … I also wasn’t expecting another effect that showed up from the beginning: by giving it different “moods”, and by having those moods depending on a real world environment, I created a WiFi-based <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Finite-state_machine">automata</a> whose mood transitions were everything but trivial. In different words, if you take something as random as, say, wether your neighbour is using his smart TV or not and you make that influence a simple automata, that automata seems a bit alive :D</p>
<p>This is where me and my girlfriend (sadly now ex, but <a target="_blank" rel="noopener" href="https://www.instagram.com/p/B1Mup7GCrVt/">still amazing</a>) went completely nuts about it. I named my unit Alpha and built a second one, Beta, that I gave her. She literally started nursing this thing, and we started playing: we went for random explorative walks just to make the units stop complaining about being bored, to see them happier, and to see that “number of unique pwned networks” going higher and higher due to some new network we managed to spot … it was amazing to literally look at the algorithm adapting to the WiFi scenario and “expressing itself” in different ways. It might sound a bit crazy but hey, if that gives two hackers an excuse to explore more the real world by looking at it with different eyes, and puts a smile on their faces, why not? :D</p>
<p><img src="https://i.imgur.com/Pr0Lwdt.jpg" alt="love"></p>
<h2 id="The-Personality"><a href="#The-Personality" class="headerlink" title="The Personality"></a>The Personality</h2><p>With time I kept adding more and more variables and parameters that determined how the algorithm adapted to different circumstances: counters so that if the unit was quickly losing sight of a target (because, say, we were walking faster), it would refresh its data with a shorter period, timeouts, multipliers for the timeouts, everything you can imagine to add to such an algorithm to make it every day a bit smarter and a bit better in adapting fast to the places we were exploring. By the end of this process I ended up with this basic set parameters, that I started calling the “personality” of the unit:</p>
<p><code>yaml personality:     # advertise our presence     advertise: true     # perform a deauthentication attack to client stations in order to get full or half handshakes     deauth: true     # send association frames to APs in order to get the PMKID     associate: true     # list of channels to recon on, or empty for all channels     channels: []     # minimum WiFi signal strength in dBm     min_rssi: -200     # number of seconds for wifi.ap.ttl     ap_ttl: 120     # number of seconds for wifi.sta.ttl     sta_ttl: 300     # time in seconds to wait during channel recon     recon_time: 30     # number of inactive epochs after which recon_time gets multiplied by recon_inactive_multiplier     max_inactive_scale: 2     # if more than max_inactive_scale epochs are inactive, recon_time *= recon_inactive_multiplier     recon_inactive_multiplier: 2     # time in seconds to wait during channel hopping if activity has been performed     hop_recon_time: 10     # time in seconds to wait during channel hopping if no activity has been performed     min_recon_time: 5     # maximum amount of deauths/associations per BSSID per session     max_interactions: 3     # maximum amount of misses before considering the data stale and triggering a new recon     max_misses_for_recon: 5     # number of active epochs that triggers the excited state     excited_num_epochs: 10     # number of inactive epochs that triggers the bored state     bored_num_epochs: 15     # number of inactive epochs that triggers the sad state     sad_num_epochs: 25</code></p>
<p>These parameters alone, even with very small changes, can influence how the algorithm works and how the UI reflects that dramatically. But I wasn’t entirely happy with it yet, because these parameters were just constants in a YAML configuration file. I had to pick them manually and change that file before booting the unit, depending on the type of walk (big office? fast walk in residential area? mall? etc): things like shorter timeouts for faster walks, longer ones for when we visited a place and were more stationary in it, and so on. The algorithm adapted, via the parameters, but the parameters themselves didn’t, I wanted to do better.</p>
<p><img src="https://i.imgur.com/npYwQoI.png" alt="params"></p>
<p>The ideal algorithm should:</p>
<ol>
<li>observe “something” from the environment (like the access points, client stations and so forth) </li>
<li>decide, depending on this observation and the current status, what is the best set of parameters to use </li>
<li>iteratively repeat this process every time a new observation is available.</li>
</ol>
<p>If you think about this in very abstract terms, it’s not very different than you playing a videogame, where your observation is the screen you’re looking at and the parameters are which buttons to press. In fact, it turned out that <a target="_blank" rel="noopener" href="https://becominghuman.ai/getting-mario-back-into-the-gym-setting-up-super-mario-bros-in-openais-gym-8e39a96c1e41">we already have the technology</a> to solve this type of problems, it’s called reinforcement learning, in our specific case it’s <a target="_blank" rel="noopener" href="https://towardsdatascience.com/deep-learning-vs-deep-reinforcement-learning-algorithms-in-retail-industry-ii-9c17c83ecf2f">deep reinforcement learning</a>. So far, the state of the art benchmarks for these systems are Super Mario levels, Atari games or, as you might have heard from the news some time ago, some <a target="_blank" rel="noopener" href="https://deepmind.com/research/case-studies/alphago-the-story-so-far">very famous board games</a>. But nobody, as far as I found out during my research, ever thought of using it to orchestrate an algorithm running on top of an offensive framework, with a cute face :D </p>
<p> I wanted to use this type of algorithms so bad, but I had a problem: I never worked with them, or even just remotely knew anything at all about them, neither I had the theoretical foundation I needed in order to understand them. Fortunately knowledge these days is (almost) free, so I <a target="_blank" rel="noopener" href="https://www.amazon.it/gp/product/B076H9VQH6/">found a very good book</a> that I started studying avidly …</p>
<p> <img src="https://i.imgur.com/89JzYwx.jpg" alt="study"></p>
<p> and kept studying for a while …</p>
<p> <img src="https://i.imgur.com/Jy9Ix40.jpg" alt="study 2"></p>
<p> A little break from the AI part, as I had to study quite for some time :D </p>
<h2 id="The-Voice"><a href="#The-Voice" class="headerlink" title="The Voice"></a>The Voice</h2><p> Being affected by compulsive coding, I couldn’t simply spend the whole time reading books without writing anything new (after all, we kept playing with the units and wanted to have new stuff implemented), so I also started working on another idea I had: I wanted Alpha and Beta to be able to detect each other and exchange with each other very basic information - but how do you communicate anything at all from a computer when:</p>
<ul>
<li>The main and only WiFi interface is in monitor mode and already being used for WiFi scanning, hopping and frames injection.</li>
<li>You have Bluetooth, but you want to keep it free for other uses (tethering, like we’re doing today, or maybe integrating BLE attacks too some day)</li>
<li>You’re using the <a target="_blank" rel="noopener" href="https://www.kernel.org/doc/html/v4.17/driver-api/usb/gadget.html">USB ports in gadget mode</a>, so you can’t use external USB devices, like another WiFi.</li>
</ul>
<p> Simple (well, kind of), you implement a <strong>parasite protocol</strong> on top of the WiFi standard! :D Bettercap was putting the WiFi card in monitor mode and tuning it to different channels at various intervals, but nothing prevented me to inject additional frames from another process.</p>
<p> I didn’t have any control over the channel, or the intervals, or the timing, but it was safe to assume that given enough time (a few seconds to minutes), the algorithm on each unit would have covered all supported channels, therefore I only needed to “keep sending stuff” and at some point I knew it would have being detected by the other unit when it hopped on the same channel of the sender. The “stuff” I decided to use is pretty simple and based on standard structures that normal WiFi routers are already using to advertise their presence: <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Beacon_frame">beacon frames</a>. Each WiFi access point, every few milliseconds, is sending these packets with a bunch of information about itself, like its ESSID, supported frequencies and whatnot - this is what allows your phone to see your home WiFi when you connect to it.</p>
<p> This seemed like the perfect structure to encapsulate Pwnagotchi’s advertisement, as I only needed to define a new, <a target="_blank" rel="noopener" href="https://github.com/evilsocket/pwngrid/blob/master/wifi/defines.go#L10">out of the WiFi standard identifier</a> to only encapsulate my type of information. This way, the units can detect each other and exchange their status from several meters away, but they are not visible as normal WiFi access points.</p>
<p> <img src="https://i.imgur.com/CZ9qw3F.jpg" alt="advertising"></p>
<h2 id="The-AI"><a href="#The-AI" class="headerlink" title="The AI"></a>The AI</h2><p>It took me weeks, so in case you don’t want to dig into the book or the links I’ve referenced above, here’s a very simplified TL;DR of the algorithm I’ve picked from the book and implemented in Pwnagotchi, <a target="_blank" rel="noopener" href="https://towardsdatascience.com/understanding-actor-critic-methods-931b97b6df3f">A2C</a>.</p>
<p>There are <strong>two</strong> relatively simple <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Multilayer_perceptron">neural networks</a> that at each epoch (basically at each loop of the main algorithm, when a new observation is available) are trying, in a way competitively, to estimate how the current situation looks like in terms of potential reward (number of handshakes) and what’s the best policy (the set of parameters) to use in order to maximize <a target="_blank" rel="noopener" href="https://pwnagotchi.ai/usage/#the-reward-function">the reward value</a>. These are basically two sides of the same thing and by approaching this from these two ways the algorithm can converge quickly to very useful solutions. </p>
<p>In my case, I decided to use as an “observation”, the following features, that should be enough to give the AI a rough estimation of what’s going on:</p>
<ol>
<li>An histogram of the number of access points per channel - so that the AI knows on which channels to look at.</li>
<li>An histogram of the number of client stations, per channel - so that the AI knows which channels are best for deauthentication attacks.</li>
<li>An histogram of the number of other Pwnagotchis, per channel - so that the AI can learn to cooperate with others by going on less crowded channels.</li>
</ol>
<p>However, Pwnagotchi’s has something that makes it very different from any of the use cases and algorithms described in the book. You can usually fast forward, rewind and replay videogame levels. Even during simpler supervised learning, you have all at once the entire temporal snapshot of data that your system needs to learn, being it <a href="/2019/05/22/How-to-create-a-Malware-detection-system-with-Machine-Learning/">a malware dataset</a>, or a Super Mario level. All the algorithms described in that book and implemented in the most popular software libaries, assume you to have an artificial, replayable and predictable environment to train the algorithm in.</p>
<p>Pwnagotchi needed to learn continuously by observing the real world, that is unpredictable and potentially different every time, at a real world time scale, that is, how long a single ARM CPU core can take to scan the entire WiFi spectrum and interact with its findings - from seconds to several minutes. And this can’t be replayed, as different policies lead to different observations which lead to different future policies … solving this has been challenging to say the least, as there’s no previous code example or use case or explaination on how to integrate with any of those algorithms the way I needed.</p>
<p><img src="https://i.imgur.com/2lI3g8u.jpg" alt="more study"></p>
<p>After a couple more weeks of studying and digging into the various implementations, I came up with <a target="_blank" rel="noopener" href="https://github.com/evilsocket/pwnagotchi/blob/master/pwnagotchi/ai/gym.py">a pretty decent solution</a> that worked, surprisingly, out of the box. The continuous reinforcement learning logic works like this (keep in mind: one epoch is one loop of the main algorithm, from a few seconds to a few minutes depending on the WiFi things around you):</p>
<ol>
<li>At each epoch, depending on a <a target="_blank" rel="noopener" href="https://github.com/evilsocket/pwnagotchi/blob/master/pwnagotchi/defaults.yml#L97">laziness factor</a>, decide if using the next epoch for training or not.</li>
<li>If not, just use the current AI to estimate a set of optimal parameters and repeat from 1.</li>
<li>If we’re in training mode, this and the next <a target="_blank" rel="noopener" href="https://github.com/evilsocket/pwnagotchi/blob/master/pwnagotchi/defaults.yml#L99">50 epochs</a> will be used as … a Super Mario episode! :D</li>
</ol>
<p>So that depending on how “lazy” the AI is configured to be, it will be learning most of the times or just conservately predicting parameters and only learn from new environments once in a while. Ideally: you want the laziness to be very low for younger units, so that they’ll learn fast, and then keep increasing their laziness over time, when they become more mature and present useful behaviours you want to keep and not accidentally “unlearn”. </p>
<p>Does it work? Yes it does, after a few days (or weeks, if you live in a isolated area), you literally start seeing the units going on different channels when they see each other, adjusting only to the channels where they “see” potential reward, setting the timeouts correctly depending on how fast the unit is moving in space and therefore how fast it needs to “lock on” new targets. Feel free to try and read what happens in <code>/var/log/pwnagotchi.log</code> :D</p>
<p><img src="https://i.imgur.com/rScAhQK.jpg" alt="the gang"></p>
<h2 id="The-Community"><a href="#The-Community" class="headerlink" title="The Community"></a>The Community</h2><p>By this time, when the AI was implemented and working, I was back home in Italy and to be entirely honest I started being a bit bored with the project, mostly for a few technical difficulties I had that made me waste a huge amount of time on relatively trivial operational and implementation details:</p>
<ul>
<li>I started this project on Kali Linux because it already had nexmon, but turns out they don’t compile with hardware support for floating point operations, so I couldn’t do any AI there, and I had to start from scratch with Raspbian.</li>
<li>This is a single ARM core, at 1Ghz: the unit took ~10 minutes to import TensorFlow alone, a total of ~30 minutes to bootstrap all python dependencies (the inference and learning run pretty fast once the dependencies are loaded tho). Testing, debugging and developing new features was <strong>slow</strong>.</li>
<li>I still didn’t have any idea how to build an .img file. So far I only worked on my own unit and took a .img of the entire SD card as a backup.</li>
</ul>
<p>And let’s be even more honest: all the “cooler” problems, the challenges, were solved already: the AI was slow as f to load, but it worked pretty great once started … everything else started feeling a bit boring and so I paused the project. However, <a target="_blank" rel="noopener" href="https://twitter.com/pwnagotchi">I hyped the sh*t out of it on Twitter</a>, mostly because it’s fun to share updates with followers and friends, and I didn’t want to disappoint them, so I published the super-buggy-crap-version-alpha on GitHub.</p>
<p>That turned out to be absolutely the best thing to do, as the help and feedback I’ve got from the community starting from day 0 has been impressive: from <a target="_blank" rel="noopener" href="https://twitter.com/syshero">this man, that now is my personal hero</a> setting up the <a target="_blank" rel="noopener" href="https://github.com/evilsocket/pwnagotchi/tree/master/builder">completely automated build system</a> of the .img files, to <a target="_blank" rel="noopener" href="https://twitter.com/0x9ABC">this awesome guy</a> that implemented the <a target="_blank" rel="noopener" href="https://github.com/evilsocket/pwnagotchi/blob/master/pwnagotchi/plugins/default/bt-tether.py">Bluetooth plugin</a> for easy connectivity with a smartphone (among other things), to <a target="_blank" rel="noopener" href="http://twitter.com/elkentaro">elkentaro</a> that sent me the first 3D printed case, motivating me more than he’ll ever imagine, to <a target="_blank" rel="noopener" href="https://twitter.com/hexwaxwing">Hex</a>, that from the very beginning gave me some of the best ideas and encouraged me on that porch, she curated the documentation and bootstrapped the community itself, to <a target="_blank" rel="noopener" href="https://github.com/evilsocket/pwnagotchi/graphs/contributors">all the people</a> that translated the project in so many different languages, submitted a fix, a new feature or just some ideas.</p>
<p>This gave me some time to decompress and work on other, new ideas that evolved the project again (see “The Crypto” section) and gave new life to it (mostly to me). Today we have <a target="_blank" rel="noopener" href="https://pwnagotchi.herokuapp.com/">a Slack channel</a> that’s quickly approaching its first 1000 of users, a <a target="_blank" rel="noopener" href="https://www.reddit.com/r/pwnagotchi/">subreddit</a> made by the community, <a target="_blank" rel="noopener" href="http://pwnagotchi.ai/">clear documentation</a>, a <a target="_blank" rel="noopener" href="https://github.com/evilsocket/pwnagotchi">very active repository</a>, <a target="_blank" rel="noopener" href="https://hackaday.com/2019/10/16/a-tamagotchi-for-wifi-cracking/">HackADay talked about us</a>, but most importantly, even before arriving to the first 1.0.0 release, hundreds of units registered already from all over the world.</p>
<center>
    <iframe src="https://pwnagotchi.ai/map/" width="765px" height="600px" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe>
</center>

<p>It is thanks to these people, their efforts and their support that today we are ready to release the 1.0.0 of the project - <strong>guys we made it, you are AWESOME!!!</strong>.</p>
<h2 id="The-Crypto"><a href="#The-Crypto" class="headerlink" title="The Crypto"></a>The Crypto</h2><p>While developing the <a target="_blank" rel="noopener" href="https://pwnagotchi.ai/api/grid/">grid API</a> running on pwnagotchi.ai used to keep track of the <a target="_blank" rel="noopener" href="https://pwnagotchi.ai/configuration/#set-your-pwngrid-preferences">registered units</a>, I had to decide some sort of authentication mechanism that wasn’t the usual username and password - I wanted people to authenticate to the API just by having a Pwnagotchi. So I started playing with RSA, and generated a keypair on each of the units at their first boot.</p>
<p>The idea that those keys were only used to authenticate to the API bothered me: there’s so much that can be done with RSA keys on dedicated hardware … this is how <a target="_blank" rel="noopener" href="https://pwnagotchi.ai/usage/#pwnmail">PwnMAIL</a> started. Each Pwnagotchi is also an end-to-end encrypted messaging device. Users can send messages to each other, messages that are encrypted on their hardware and stored on our servers, so that can only be decrypted by the recipient unit. The keys are generated and phisically isolated on cheap and disposable hardware (that also happens to run a super cute hacker AI ^_^). It’s easy to secure them by creating a <a target="_blank" rel="noopener" href="https://github.com/NicoHood/NicoHood.github.io/wiki/Raspberry-Pi-Encrypt-Root-Partition-Tutorial">LUKS encrypted partition</a> so that they can’t be recovered from the SD card.</p>
<p><img src="https://i.imgur.com/cKznfdm.png" alt="pwnmail"></p>
<p>It’s easier than GPG, hardware isolated and it’s not connected to a phone number. You can use it to send encrypted text messages or small files.</p>
<h2 id="The-Future"><a href="#The-Future" class="headerlink" title="The Future"></a>The Future</h2><p>Let’s talk about AI olympics! :D</p>
<p>Since the grid API is pretty open and users with valid RSA keys could send any amount of “pwned networks”, I decided <strong>not</strong> to use the data they send from any sort of scoreboard, ranking or competition system. This would only push some malicious (and very boring) users to cheat by sending fake statistics of fake units, therefore ruining the fun for all the others.</p>
<p>Each unit currently has a <code>/root/brain.nn</code> file which stores its neural networks and it’s just a few MB: <strong>this</strong> is what the users will be uploading when competitive features will be implemented (and they will be) server side.</p>
<p>Each AI will be executed in a virtual environment, built on top of <a target="_blank" rel="noopener" href="https://www.bettercap.org/modules/core/api.rest/#api-rest-record-filename">bettercap’s sessions recorded from real world scenarios</a> and wrapped in such a way that it won’t be able to tell the difference from its normal, real world WiFi routine. While this system can not be used for training, because the way those scenarios will react is artificial (I will script who will send an handshake to whom depending on the right or wrong decisions the AI made), it can be used to <strong>benchmark</strong> how that specific brain.nn file peforms in terms of average reward per session. This is a value that increases over time, the more (and the better) the AI is trained, and can’t be faked. This is what the <strong>PwnOlympics</strong> will be built on. Good luck cheating with that :D</p>
<p>Now let’s talk about distributed computing … </p>
<p>A modern GPU used in a cracking rig is so effective because is powered, differently from a CPU, by thousands of cores, a bit more than 1Ghz each, that are used to parallelize the search algorithms required for cracking … but it’s expensive. </p>
<p><strong>If and when</strong> the project will reach the thousands of units, PwnGRID will provide a similar amount of “cores”, that can be orchestrated as a single computational unit, to everybody, for free. Whatever cracking power the grid will reach, it’ll be distributed according to the previous contributions of who submitted the job: the more CPU cycles you’ll give to the grid, the higher the priority (and number of units) you will have to perform your operation. It’s like a BlockChain (proof of pwn!) mixed with Emule’s logic of giving priority to nodes that contributed more.</p>
<p>These are just some of the ideas that we are discussing and implementing, we need more and we need higher numbers. You’re more than welcome to join our Slack channel and help :)</p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><p>A few key points I didn’t want to omit but that I don’t feel like phrasing more extensively than this:</p>
<ul>
<li>AI can be easy and fun, don’t let academic papers scare you with complex terminology, learn.</li>
<li>Walk more, now you have another excuse.</li>
<li>ESP based deauthers, to name one, always existed. Don’t yell at us “OMG they’re deauthing all over the city!!!”. Despite this stuff always existing, nobody bothered updating <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/IEEE_802.11w-2009">to technologies that work better and are more secure</a>. <strong>That</strong> is the people you should be yelling at.</li>
<li><strong>If you work at Twitter and you’re reading this:</strong> please, I’ve tried to verify <a target="_blank" rel="noopener" href="https://twitter.com/pwnagotchi">@pwnagotchi</a> email in order to get a developer token and tweet from my unit, I never got the confirmation email, can you help? Thanks.</li>
</ul>
<hr>
<p><a target="_blank" rel="noopener" href="https://twitter.com/pwnagotchi?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-show-count="false">Follow @pwnagotchi</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></p>

  </div>

  
    <div class="post-tags">
      
        <a href="/tags/bettercap/" class="tag">#bettercap</a>
      
        <a href="/tags/wifi/" class="tag">#wifi</a>
      
        <a href="/tags/raspberry-pi/" class="tag">#raspberry pi</a>
      
        <a href="/tags/portable-hacking/" class="tag">#portable hacking</a>
      
        <a href="/tags/wireless-security/" class="tag">#wireless security</a>
      
        <a href="/tags/ai/" class="tag">#ai</a>
      
        <a href="/tags/deep-learning/" class="tag">#deep learning</a>
      
        <a href="/tags/dnn/" class="tag">#dnn</a>
      
        <a href="/tags/machine-learning/" class="tag">#machine learning</a>
      
        <a href="/tags/neural-networks/" class="tag">#neural networks</a>
      
        <a href="/tags/deep-neural-networks/" class="tag">#deep neural networks</a>
      
        <a href="/tags/cuda/" class="tag">#cuda</a>
      
        <a href="/tags/nvidia/" class="tag">#nvidia</a>
      
        <a href="/tags/artificial-intelligence/" class="tag">#artificial intelligence</a>
      
        <a href="/tags/handshake-capture/" class="tag">#handshake capture</a>
      
        <a href="/tags/monitor-mode/" class="tag">#monitor mode</a>
      
        <a href="/tags/pwnagotchi/" class="tag">#pwnagotchi</a>
      
        <a href="/tags/deep-reinforcement-learning/" class="tag">#deep reinforcement learning</a>
      
        <a href="/tags/reinforcement-learning/" class="tag">#reinforcement learning</a>
      
        <a href="/tags/handshakes/" class="tag">#handshakes</a>
      
    </div>
  

  <nav class="post-navigation">
    
      <a href="/2020/05/26/Just-taking-a-break/" class="nav-prev">
        <span class="nav-label">PREVIOUS</span>
        <span class="nav-title">Just Taking a Break :D</span>
      </a>
    
    
      <a href="/2019/05/22/How-to-create-a-Malware-detection-system-with-Machine-Learning/" class="nav-next">
        <span class="nav-label">NEXT</span>
        <span class="nav-title">How to Create a Malware Detection System With Machine Learning</span>
      </a>
    
  </nav>
</article>


  


<section class="related-posts">
  <h3 class="related-title">YOU MIGHT ALSO LIKE...</h3>
  <div class="cards-grid cards-grid-related">
    
      

<article class="card card-light">
  <a href="/2025/12/18/TP-Link-Tapo-C200-Hardcoded-Keys-Buffer-Overflows-and-Privacy-in-the-Era-of-AI-Assisted-Reverse-Engineering/" class="card-link">
    
      <div class="card-image" style="background-image: url('/images/2025/tapo/header.jpg')">
        
      </div>
    
    
    
      <div class="card-content">
        <h2 class="card-title">TP-Link Tapo C200: Hardcoded Keys, Buffer Overflows and Privacy in the Era of AI Assisted Reverse Engineering</h2>
        
        <div class="card-footer">
          <span class="card-read-more">READ MORE</span>
        </div>
      </div>
    
  </a>
</article>

    
      

<article class="card card-overlay">
  <a href="/2025/03/13/How-To-Write-An-Agent/" class="card-link">
    
      <div class="card-image" style="background-image: url('/images/2025/agent/loop.png')">
        
          <div class="card-overlay-content">
            <h2 class="card-title">How to Write an Agent</h2>
            <span class="card-read-more">READ MORE</span>
          </div>
        
      </div>
    
    
    
  </a>
</article>

    
      

<article class="card card-overlay">
  <a href="/2024/09/13/Introducing-bettercap-2-4-0-CAN-bus-hacking-WiFi-bruteforcing-and-builtin-web-UI/" class="card-link">
    
      <div class="card-image" style="background-image: url('/images/2024/ecus.png')">
        
          <div class="card-overlay-content">
            <h2 class="card-title">Introducing Bettercap 2.4.0: CAN-Bus Hacking, WiFi Bruteforcing and Builtin Web UI</h2>
            <span class="card-read-more">READ MORE</span>
          </div>
        
      </div>
    
    
    
  </a>
</article>

    
      

<article class="card card-light">
  <a href="/2022/08/15/Process-behaviour-anomaly-detection-using-eBPF-and-unsupervised-learning-Autoencoders/" class="card-link">
    
      <div class="card-image" style="background-image: url('https://i.imgur.com/QEmpeDl.jpg')">
        
      </div>
    
    
    
      <div class="card-content">
        <h2 class="card-title">Process Behaviour Anomaly Detection Using eBPF and Unsupervised-Learning Autoencoders</h2>
        
        <div class="card-footer">
          <span class="card-read-more">READ MORE</span>
        </div>
      </div>
    
  </a>
</article>

    
  </div>
</section>




  </main>
  
  <footer class="site-footer">
  <div class="footer-inner">
    <div class="footer-social">
      
        
          
            <a href="https://github.com/evilsocket" class="social-link" target="_blank" rel="noopener" aria-label="GitHub">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
            </a>
          
        
          
            <a href="https://twitter.com/evilsocket" class="social-link" target="_blank" rel="noopener" aria-label="Twitter">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
            </a>
          
        
          
            <a href="http://it.linkedin.com/in/simonemargaritelli/" class="social-link" target="_blank" rel="noopener" aria-label="LinkedIn">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
            </a>
          
        
          
        
          
            <a href="mailto:evilsocket@gmail.com" class="social-link" aria-label="Email">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
            </a>
          
        
      
    </div>
    <p class="footer-copyright">
      &copy; 2026 evilsocket. 
      Powered by <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a>.
    </p>
  </div>
</footer>

  <script src="/a.js"></script>
<script type="text/javascript">
  A['\u0069\u006E\u0069\u0074']({ '\u0061\u0063\u0074\u0069\u006F\u006E': 'none', "statsEndpoint": "\u0068\u0074\u0074\u0070\u0073\u003A\u002F\u002F\u006E\u006F\u0062\u006F\u0074\u002D\u0073\u0074\u0061\u0074\u0073\u002E\u0065\u0076\u0069\u006C\u0073\u006F\u0063\u006B\u0065\u0074\u002E\u0077\u006F\u0072\u006B\u0065\u0072\u0073\u002E\u0064\u0065\u0076\u002F\u006C\u006F\u0067" });
</script>

<!-- Minimal JS - no external dependencies needed -->
<script>
  // Lazy load images
  document.addEventListener('DOMContentLoaded', function () {
    var images = document.querySelectorAll('.card-image[data-bg]');
    images.forEach(function (img) {
      img.style.backgroundImage = 'url(' + img.dataset.bg + ')';
    });
  });
</script>
</body>
</html>
