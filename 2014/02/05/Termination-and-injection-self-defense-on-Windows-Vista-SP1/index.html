<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Termination and Injection Self Defense on Windows &gt;= Vista SP1 | evilsocket</title>
<meta name="description" content="On a previous post I’ve talked about how to perform API hooking at kernel level on 32bit Windows systems to prevent a process from being terminated.Today I’m go">


  <link rel="alternate" href="/atom.xml" title="evilsocket" type="application/atom+xml">


<link rel="icon" href="/images/favicon.ico">

<!-- Open Graph -->
<meta property="og:type" content="article">
<meta property="og:title" content="Termination and Injection Self Defense on Windows &gt;= Vista SP1">
<meta property="og:description" content="On a previous post I’ve talked about how to perform API hooking at kernel level on 32bit Windows systems to prevent a process from being terminated.Today I’m go">
<meta property="og:url" content="/2014/02/05/Termination-and-injection-self-defense-on-Windows-Vista-SP1/">
<meta property="og:site_name" content="evilsocket">

  
  
    <meta property="og:image" content="/images/default-cover.svg">
  


<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Termination and Injection Self Defense on Windows &gt;= Vista SP1">
<meta name="twitter:description" content="On a previous post I’ve talked about how to perform API hooking at kernel level on 32bit Windows systems to prevent a process from being terminated.Today I’m go">

<!-- Schema.org JSON-LD -->


<script type="application/ld+json">
{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.evilsocket.net/2014/02/05/Termination-and-injection-self-defense-on-Windows-Vista-SP1/"},"headline":"Termination and Injection Self Defense on Windows &gt;= Vista SP1","description":"On a previous post I’ve talked about how to perform API hooking at kernel level on 32bit Windows systems to prevent a process from being terminated.Today I’m go","image":"https://www.evilsocket.net/images/default-cover.svg","datePublished":"2014-02-05T21:08:04.000Z","dateModified":"2014-05-19T20:56:10.000Z","author":{"@type":"Person","name":"Simone Margaritelli","description":"Italian cybersecurity researcher and open-source developer","url":"https://www.evilsocket.net","sameAs":["https://github.com/evilsocket","https://twitter.com/evilsocket","http://it.linkedin.com/in/simonemargaritelli/"],"jobTitle":"Security Researcher","worksFor":{"@type":"Organization","name":"Independent"}},"publisher":{"@type":"Organization","name":"evilsocket","url":"https://www.evilsocket.net","logo":{"@type":"ImageObject","url":"https://www.evilsocket.net/images/glider.png"}},"keywords":"api hooking, anti-tampering, kernel, obcallbacks, windows internals, kernel security, driver development, security, ObRegisterCallbacks, driver, process protection, self protection, memory injection, Windows","articleSection":"Technology","inLanguage":"en"}
</script>


<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<!-- Styles -->
<link rel="stylesheet" href="/css/style.css">


<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-22026549-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-22026549-1');
</script>


<meta name="generator" content="Hexo 5.4.2"></head>
<body class="post-page">
  <header class="site-header">
  <div class="header-inner">
    <div class="site-branding">
      <a href="/" class="site-logo">
        
          <img src="/images/glider.png" alt="evilsocket" width="50" height="50">
        
        <div class="site-title-group">
          <span class="site-title">evilsocket</span>
          <span class="site-motto">Preoccupied with a single leaf, you won't see the tree. Preoccupied with a single tree... you'll miss the entire forest.</span>
        </div>
      </a>
    </div>
    
    <nav class="site-nav">
      
        <a href="/" class="nav-link">
          HOME
        </a>
      
        <a href="/atom.xml" class="nav-link">
          RSS
        </a>
      
    </nav>
  </div>
</header>

  
  <main class="main-content">
    <article class="post-full">
  <header class="post-header">
    <h1 class="post-title">Termination and Injection Self Defense on Windows &gt;= Vista SP1</h1>
    <div class="post-meta">
      BY <span class="post-author">Simone Margaritelli</span>
      — <time datetime="2014-02-05T21:08:04.000Z">5 Feb 2014</time>
      
        — <a href="/tags/api-hooking/" class="post-category">api hooking</a>, <a href="/tags/anti-tampering/" class="post-category">anti-tampering</a>, <a href="/tags/kernel/" class="post-category">kernel</a>, <a href="/tags/obcallbacks/" class="post-category">obcallbacks</a>, <a href="/tags/windows-internals/" class="post-category">windows internals</a>, <a href="/tags/kernel-security/" class="post-category">kernel security</a>, <a href="/tags/driver-development/" class="post-category">driver development</a>, <a href="/tags/security/" class="post-category">security</a>, <a href="/tags/ObRegisterCallbacks/" class="post-category">ObRegisterCallbacks</a>, <a href="/tags/driver/" class="post-category">driver</a>, <a href="/tags/process-protection/" class="post-category">process protection</a>, <a href="/tags/self-protection/" class="post-category">self protection</a>, <a href="/tags/memory-injection/" class="post-category">memory injection</a>, <a href="/tags/Windows/" class="post-category">Windows</a>
      
    </div>
    <br/>
    <a target="_blank" rel="noopener" href="https://twitter.com/evilsocket" class="twitter-follow-button" data-show-count="false">Follow me on X</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
  </header>

  <div class="post-content">
    <p>On a <a href="/2014/02/01/keservicedescriptortable-patching-aka-how-to-hook-win32-api-patching-the-kernel/">previous post</a> I’ve talked about how to perform API hooking at kernel level on 32bit Windows systems to prevent a process from being terminated.<br>Today I’m gonna talk about <a target="_blank" rel="noopener" href="http://msdn.microsoft.com/en-us/library/windows/hardware/ff557759(v=vs.85).aspx">OBR and callbacks</a>, mainly to show how to achieve the same result on 64bit systems starting from Vista SP1 and later.</p>
<span id="more"></span>

<h2 id="Why-should-I-prevent-a-process-from-being-killed"><a href="#Why-should-I-prevent-a-process-from-being-killed" class="headerlink" title="Why should I prevent a process from being killed?"></a>Why should I prevent a process from being killed?</h2><p>If you try to search for some code samples or documentation about this topic, you will find that almost anyone will say that denying a computer administrator to terminate a process is wrong, so process self-protection should be avoided.<br>This is true 99% of the cases, the remaining 1% are those cases when a process is vital for the system infrastructure security such as anti malwares, IPS and IDS. Those kind of softwares have to protect themself from malicious software trying to terminate their services and processes or inject arbitrary code into their executable address space, so that’s when an appropriate protection is vital.</p>
<h2 id="The-user-mode-curse"><a href="#The-user-mode-curse" class="headerlink" title="The user mode curse"></a>The user mode curse</h2><p>No matter how hard you try, there’s really no 100% safe way to do this in user mode … you could try API hooking, passive monitoring, process sandboxing, whatever, there’s always a way to bypass a user mode protection. API hooks can be overwritten, monitoring can be eluded with straight calls to ntdll and obfuscation, sandboxing can be detected.<br>That’s why kernel patching was the most used technique on pre Vista systems, once you are in the kernel you have full power and the lowest level possible vision of what is happening on a computer, moreover you don’t need to handle all the abstractions a user mode environment implies.</p>
<h2 id="Drivers-and-Ob-Callbacks"><a href="#Drivers-and-Ob-Callbacks" class="headerlink" title="Drivers and Ob Callbacks"></a>Drivers and Ob Callbacks</h2><p>When you talk about working in the Windows kernel, you talk about developing a driver, that’s why Microsoft implemented a set of brand new API to intercept and eventually filter events and actions on object handles before they are actually executed by the kernel.<br>Enough talking, let’s see how the <strong>ObRegisterCallbacks</strong> is defined:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">NTSTATUS <span class="title">ObRegisterCallbacks</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">  _In_   POB_CALLBACK_REGISTRATION CallBackRegistration,</span></span></span><br><span class="line"><span class="function"><span class="params">  _Out_  PVOID *RegistrationHandle</span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>;</span><br></pre></td></tr></table></figure>

<p>This function accepts an input structure pointer that defines what object handles you want to monitor and which actions on them and gives you back a <strong>RegistrationHandle</strong> i.e. a global object we will use from now on to work with those callbacks.</p>
<p>The OB_CALLBACK_REGISTRATION structure content:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">OB_CALLBACK_REGISTRATION</span> &#123;</span></span><br><span class="line">  USHORT                    Version;</span><br><span class="line">  USHORT                    OperationRegistrationCount;</span><br><span class="line">  UNICODE_STRING            Altitude;</span><br><span class="line">  PVOID                     RegistrationContext;</span><br><span class="line">  OB_OPERATION_REGISTRATION *OperationRegistration;</span><br><span class="line">&#125; OB_CALLBACK_REGISTRATION, *POB_CALLBACK_REGISTRATION;</span><br></pre></td></tr></table></figure>

<p>The <strong>Altitude</strong> field is basically the <a target="_blank" rel="noopener" href="http://msdn.microsoft.com/en-us/library/windows/hardware/ff549689(v=vs.85).aspx">load order</a> you want your driver to be loaded at, <strong>RegistrationContext</strong> is an arbitrary object you want to be passed down to your callbacks and finally the <strong>OperationRegistration</strong> field is a pointer to an array of OB_OPERATION_REGISTRATION structures which defines every detail of our callback. So let’s say we want to intercept every access to object handles of processes ( OpenProcess, etc ), we would declare:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">OB_OPERATION_REGISTRATION opRegistrations[<span class="number">1</span>] = &#123; &#123; <span class="number">0</span> &#125; &#125;;</span><br><span class="line"></span><br><span class="line">opRegistrations[<span class="number">0</span>].ObjectType    = PsProcessType;</span><br><span class="line">opRegistrations[<span class="number">0</span>].Operations    = OB_OPERATION_HANDLE_CREATE;</span><br><span class="line">opRegistrations[<span class="number">0</span>].PreOperation  = YourPreCallback;</span><br><span class="line">opRegistrations[<span class="number">0</span>].PostOperation = YourPostCallback;</span><br></pre></td></tr></table></figure>

<p><em>YourPreCallback</em> and <em>YourPostCallback</em> are obviously two routines that will be called before the process handle is actually opened ( the pre callback ) and after the operation is completed ( post callback ).<br>For our purposes, the post callback can be declared just as:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">VOID <span class="title">YourPostCallback</span><span class="params">( PVOID RegistrationContext, POB_POST_OPERATION_INFORMATION OperationInformation )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	UNREFERENCED_PARAMETER(RegistrationContext);</span><br><span class="line">	UNREFERENCED_PARAMETER(OperationInformation);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>While the pre callback will do all the dirty work for us ( we want to block an unauthorized access to our processes before they’re actually performed, right? )</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">OB_PREOP_CALLBACK_STATUS <span class="title">YourPreCallback</span><span class="params">( PVOID RegistrationContext, POB_PRE_OPERATION_INFORMATION OperationInformation )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	PEPROCESS OpenedProcess = (PEPROCESS)OperationInformation-&gt;Object,</span><br><span class="line">			  CurrentProcess = PsGetCurrentProcess();</span><br><span class="line">	ULONG     ulProcessId = PsGetProcessId(OpenedProcess);</span><br><span class="line"></span><br><span class="line">	UNREFERENCED_PARAMETER(RegistrationContext);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Allow operations from the process itself</span></span><br><span class="line">	<span class="keyword">if</span>( CurrentProcess == OpenedProcess )</span><br><span class="line">		<span class="keyword">goto</span> done;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Allow operations from within the kernel</span></span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>( OperationInformation-&gt;KernelHandle == <span class="number">1</span> )</span><br><span class="line">		<span class="keyword">goto</span> done;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * PUT YOUR PROTECTED PROCESS ID HERE</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>( ulProcessId != <span class="number">1234</span> )</span><br><span class="line">		<span class="keyword">goto</span> done;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Remove access bits from open access mask.</span></span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>( OperationInformation-&gt;Operation == OB_OPERATION_HANDLE_CREATE )</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>( ( OperationInformation-&gt;Parameters-&gt;CreateHandleInformation.OriginalDesiredAccess &amp; PROCESS_TERMINATE ) == PROCESS_TERMINATE )</span><br><span class="line">		&#123;</span><br><span class="line">			DbgPrintEx( DPFLTR_IHVDRIVER_ID, DPFLTR_WARNING_LEVEL, <span class="string">&quot;Requested protected process termination.\n&quot;</span> );</span><br><span class="line"></span><br><span class="line">			OperationInformation-&gt;Parameters-&gt;CreateHandleInformation.DesiredAccess &amp;= ~PROCESS_TERMINATE;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>( ( OperationInformation-&gt;Parameters-&gt;CreateHandleInformation.OriginalDesiredAccess &amp; PROCESS_VM_OPERATION ) == PROCESS_VM_OPERATION )</span><br><span class="line">		&#123;</span><br><span class="line">			OperationInformation-&gt;Parameters-&gt;CreateHandleInformation.DesiredAccess &amp;= ~PROCESS_VM_OPERATION;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>( ( OperationInformation-&gt;Parameters-&gt;CreateHandleInformation.OriginalDesiredAccess &amp; ~PROCESS_VM_READ ) == PROCESS_VM_READ )</span><br><span class="line">		&#123;</span><br><span class="line">			OperationInformation-&gt;Parameters-&gt;CreateHandleInformation.DesiredAccess &amp;= ~PROCESS_VM_READ;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>( ( OperationInformation-&gt;Parameters-&gt;CreateHandleInformation.OriginalDesiredAccess &amp; PROCESS_VM_WRITE ) == PROCESS_VM_WRITE )</span><br><span class="line">		&#123;</span><br><span class="line">			DbgPrintEx( DPFLTR_IHVDRIVER_ID, DPFLTR_WARNING_LEVEL, <span class="string">&quot;Requested protected process virtual memory write access ( INJECTION! ).\n&quot;</span> );</span><br><span class="line"></span><br><span class="line">			OperationInformation-&gt;Parameters-&gt;CreateHandleInformation.DesiredAccess &amp;= ~PROCESS_VM_WRITE;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">done:</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> OB_PREOP_SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>What this callback is doing, is preventing process with PID 1234 from being accessed with <strong>PROCESS_TERMINATE</strong>, <strong>PROCESS_VM_OPERATION</strong>, <strong>PROCESS_VM_READ</strong> or <strong>PROCESS_VM_WRITE</strong> privileges, so any malicious software that will try to terminate it or to call API such as (Write|Read)ProcessMemory will inevitably fail with the good old 0x00000005 error ( ACCESS_DENIED ).</p>
<p>When your driver unloads, don’t forget to call <strong>ObUnRegisterCallbacks</strong> on the RegistrationHandle you’ve previously saved on a global object to correctly inform the kernel that you are not going to intercept those operations anymore.</p>
<p>Well, easy peasy, this is how AV and security softwares are being protected nowdays on 64bit systems from malicious termination, code injection, credential theft from memory (well you are just an idiot if you keep sensible data as clear text in memory -.-) and any kind of manipulation which could lead to the system damages.</p>

  </div>

  
    <div class="post-tags">
      
        <a href="/tags/api-hooking/" class="tag">#api hooking</a>
      
        <a href="/tags/anti-tampering/" class="tag">#anti-tampering</a>
      
        <a href="/tags/kernel/" class="tag">#kernel</a>
      
        <a href="/tags/obcallbacks/" class="tag">#obcallbacks</a>
      
        <a href="/tags/windows-internals/" class="tag">#windows internals</a>
      
        <a href="/tags/kernel-security/" class="tag">#kernel security</a>
      
        <a href="/tags/driver-development/" class="tag">#driver development</a>
      
        <a href="/tags/security/" class="tag">#security</a>
      
        <a href="/tags/ObRegisterCallbacks/" class="tag">#ObRegisterCallbacks</a>
      
        <a href="/tags/driver/" class="tag">#driver</a>
      
        <a href="/tags/process-protection/" class="tag">#process protection</a>
      
        <a href="/tags/self-protection/" class="tag">#self protection</a>
      
        <a href="/tags/memory-injection/" class="tag">#memory injection</a>
      
        <a href="/tags/Windows/" class="tag">#Windows</a>
      
    </div>
  

  <nav class="post-navigation">
    
      <a href="/2014/02/11/On-Windows-syscall-mechanism-and-syscall-numbers-extraction-methods/" class="nav-prev">
        <span class="nav-label">PREVIOUS</span>
        <span class="nav-title">On Windows Syscall Mechanism and Syscall Numbers Extraction Methods</span>
      </a>
    
    
      <a href="/2014/02/02/Process-introspection-for-fun-and-profit/" class="nav-next">
        <span class="nav-label">NEXT</span>
        <span class="nav-title">Process Introspection for Fun and Profit</span>
      </a>
    
  </nav>
</article>


  


<section class="related-posts">
  <h3 class="related-title">YOU MIGHT ALSO LIKE...</h3>
  <div class="cards-grid cards-grid-related">
    
      

<article class="card card-light">
  <a href="/2025/12/18/TP-Link-Tapo-C200-Hardcoded-Keys-Buffer-Overflows-and-Privacy-in-the-Era-of-AI-Assisted-Reverse-Engineering/" class="card-link">
    
      <div class="card-image" style="background-image: url('/images/2025/tapo/header.jpg')">
        
      </div>
    
    
    
      <div class="card-content">
        <h2 class="card-title">TP-Link Tapo C200: Hardcoded Keys, Buffer Overflows and Privacy in the Era of AI Assisted Reverse Engineering</h2>
        
        <div class="card-footer">
          <span class="card-read-more">READ MORE</span>
        </div>
      </div>
    
  </a>
</article>

    
      

<article class="card card-overlay">
  <a href="/2016/04/18/How-I-defeated-an-obfuscated-and-anti-tamper-APK-with-some-Python-and-a-home-made-Smali-emulator/" class="card-link">
    
      <div class="card-image" style="background-image: url('/images/2016/04/apktool.png')">
        
          <div class="card-overlay-content">
            <h2 class="card-title">How I Defeated an Obfuscated and Anti-Tamper APK With Some Python and a Home-Made Smali Emulator.</h2>
            <span class="card-read-more">READ MORE</span>
          </div>
        
      </div>
    
    
    
  </a>
</article>

    
      

<article class="card card-overlay">
  <a href="/2016/01/28/Why-you-shouldn-t-trust-CloudFlare-s-Flexible-SSL-and-how-to-bypass-it-with-BetterCap/" class="card-link">
    
      <div class="card-image" style="background-image: url('/images/2016/01/Schermata-2016-01-28-alle-18-08-27.png')">
        
          <div class="card-overlay-content">
            <h2 class="card-title">Why You Shouldn&#39;t Trust CloudFlare&#39;s &#39;Flexible SSL&#39; and How to Bypass It With BetterCap</h2>
            <span class="card-read-more">READ MORE</span>
          </div>
        
      </div>
    
    
    
  </a>
</article>

    
      

<article class="card card-light">
  <a href="/2015/05/04/Android-Native-API-Hooking-with-Library-Injection-and-ELF-Introspection/" class="card-link">
    
      <div class="card-image" style="background-image: url('/images/default-cover.svg')">
        
      </div>
    
    
    
      <div class="card-content">
        <h2 class="card-title">Android Native API Hooking With Library Injection and ELF Introspection.</h2>
        
        <div class="card-footer">
          <span class="card-read-more">READ MORE</span>
        </div>
      </div>
    
  </a>
</article>

    
  </div>
</section>




  </main>
  
  <footer class="site-footer">
  <div class="footer-inner">
    <div class="footer-social">
      
        
          
            <a href="https://github.com/evilsocket" class="social-link" target="_blank" rel="noopener" aria-label="GitHub">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
            </a>
          
        
          
            <a href="https://twitter.com/evilsocket" class="social-link" target="_blank" rel="noopener" aria-label="Twitter">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
            </a>
          
        
          
            <a href="http://it.linkedin.com/in/simonemargaritelli/" class="social-link" target="_blank" rel="noopener" aria-label="LinkedIn">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
            </a>
          
        
          
        
          
            <a href="mailto:evilsocket@gmail.com" class="social-link" aria-label="Email">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
            </a>
          
        
      
    </div>
    <p class="footer-copyright">
      &copy; 2026 evilsocket. 
      Powered by <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a>.
    </p>
  </div>
</footer>

  <script src="/a.js"></script>
<script type="text/javascript">
  A['\u0069\u006E\u0069\u0074']({ '\u0061\u0063\u0074\u0069\u006F\u006E': 'none', "statsEndpoint": "\u0068\u0074\u0074\u0070\u0073\u003A\u002F\u002F\u006E\u006F\u0062\u006F\u0074\u002D\u0073\u0074\u0061\u0074\u0073\u002E\u0065\u0076\u0069\u006C\u0073\u006F\u0063\u006B\u0065\u0074\u002E\u0077\u006F\u0072\u006B\u0065\u0072\u0073\u002E\u0064\u0065\u0076\u002F\u006C\u006F\u0067" });
</script>

<!-- Minimal JS - no external dependencies needed -->
<script>
  // Lazy load images
  document.addEventListener('DOMContentLoaded', function () {
    var images = document.querySelectorAll('.card-image[data-bg]');
    images.forEach(function (img) {
      img.style.backgroundImage = 'url(' + img.dataset.bg + ')';
    });
  });
</script>
</body>
</html>
