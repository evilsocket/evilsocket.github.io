<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Using ARM Inline Assembly and Naked Functions to Fool Disassemblers | evilsocket</title>
<meta name="description" content="On this post I want to share a simple trick I learned a while ago, it’s nothing special but if you think about it, it’s quite nice :)
Sometimes we want to obfus">


  <link rel="alternate" href="/atom.xml" title="evilsocket" type="application/atom+xml">


<link rel="icon" href="/images/favicon.ico">

<!-- Open Graph -->
<meta property="og:type" content="article">
<meta property="og:title" content="Using ARM Inline Assembly and Naked Functions to Fool Disassemblers">
<meta property="og:description" content="On this post I want to share a simple trick I learned a while ago, it’s nothing special but if you think about it, it’s quite nice :)
Sometimes we want to obfus">
<meta property="og:url" content="/2015/05/02/Using-ARM-Inline-Assembly-and-Naked-Functions-to-fool-Disassemblers/">
<meta property="og:site_name" content="evilsocket">

  
  
    <meta property="og:image" content="/images/2015/05/hopper.png">
  


<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Using ARM Inline Assembly and Naked Functions to Fool Disassemblers">
<meta name="twitter:description" content="On this post I want to share a simple trick I learned a while ago, it’s nothing special but if you think about it, it’s quite nice :)
Sometimes we want to obfus">

<!-- Schema.org JSON-LD -->


<script type="application/ld+json">
{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.evilsocket.net/2015/05/02/Using-ARM-Inline-Assembly-and-Naked-Functions-to-fool-Disassemblers/"},"headline":"Using ARM Inline Assembly and Naked Functions to Fool Disassemblers","description":"On this post I want to share a simple trick I learned a while ago, it’s nothing special but if you think about it, it’s quite nice :) Sometimes we want to obfus","image":"https://www.evilsocket.net/images/2015/05/hopper.png","datePublished":"2015-05-02T14:37:19.000Z","dateModified":"2015-05-10T13:34:23.000Z","author":{"@type":"Person","name":"Simone Margaritelli","description":"Italian cybersecurity researcher and open-source developer","url":"https://www.evilsocket.net","sameAs":["https://github.com/evilsocket","https://twitter.com/evilsocket","http://it.linkedin.com/in/simonemargaritelli/"],"jobTitle":"Security Researcher","worksFor":{"@type":"Organization","name":"Independent"}},"publisher":{"@type":"Organization","name":"evilsocket","url":"https://www.evilsocket.net","logo":{"@type":"ImageObject","url":"https://www.evilsocket.net/images/glider.png"}},"keywords":"arm, hack, ida, assembly, naked functions, inline, inline assembly, disassembler, hopper, objdump, trick","articleSection":"Technology","inLanguage":"en"}
</script>


<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<!-- Styles -->
<link rel="stylesheet" href="/css/style.css">


<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-22026549-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-22026549-1');
</script>


<meta name="generator" content="Hexo 5.4.2"></head>
<body class="post-page">
  <header class="site-header">
  <div class="header-inner">
    <div class="site-branding">
      <a href="/" class="site-logo">
        
          <img src="/images/glider.png" alt="evilsocket" width="50" height="50">
        
        <span class="site-title">evilsocket</span>
      </a>
    </div>
    
    <nav class="site-nav">
      
        <a href="/" class="nav-link">
          HOME
        </a>
      
        <a href="/atom.xml" class="nav-link">
          RSS
        </a>
      
    </nav>
  </div>
</header>

  
  <main class="main-content">
    <article class="post-full">
  <header class="post-header">
    <h1 class="post-title">Using ARM Inline Assembly and Naked Functions to Fool Disassemblers</h1>
    <div class="post-meta">
      BY <span class="post-author">Simone Margaritelli</span>
      — <time datetime="2015-05-02T14:37:19.000Z">2 May 2015</time>
      
        — <a href="/tags/arm/" class="post-category">arm</a>, <a href="/tags/hack/" class="post-category">hack</a>, <a href="/tags/ida/" class="post-category">ida</a>, <a href="/tags/assembly/" class="post-category">assembly</a>, <a href="/tags/naked-functions/" class="post-category">naked functions</a>, <a href="/tags/inline/" class="post-category">inline</a>, <a href="/tags/inline-assembly/" class="post-category">inline assembly</a>, <a href="/tags/disassembler/" class="post-category">disassembler</a>, <a href="/tags/hopper/" class="post-category">hopper</a>, <a href="/tags/objdump/" class="post-category">objdump</a>, <a href="/tags/trick/" class="post-category">trick</a>
      
    </div>
  </header>

  
  
    <div class="post-cover">
      <img src="/images/2015/05/hopper.png" alt="Using ARM Inline Assembly and Naked Functions to Fool Disassemblers">
    </div>
  

  <div class="post-content">
    <p>On this post I want to share a simple trick I learned a while ago, it’s nothing special but if you think about it, it’s quite nice :)</p>
<p>Sometimes we want to obfuscate/hide strings in our program to make reversing more difficult and the more common approach is to encrypt them somehow and put them inside binary buffers instead of plain ASCII strings.<br>One downside of this naive approach is of course, once decompiled, the access to these binary buffers will easily be noticed by a seasoned reverser, he would assume some sort of obfuscation/encryption/whatever and start reversing the algorithm to unobfuscate the strings in a matter of minutes.</p>
<p>One thing you can do to make his/her life harder ( but not impossible ) is embedding your encrypted data as code … how?</p>
<span id="more"></span>

<h2 id="UPDATE-NOTE-10-May-2015"><a href="#UPDATE-NOTE-10-May-2015" class="headerlink" title="UPDATE/NOTE (10 May 2015)"></a>UPDATE/NOTE (10 May 2015)</h2><p>After a few critics I feel the need to do some clarifications.</p>
<ul>
<li><p>This is not intended to be the definitive obfuscation method, it’s just a <strong>simple</strong> and <strong>small</strong> example of out-of-the-box thinking while coding in C.<br>Indeed it’s a simple and naive trick that wouldn’t create much problems to good reversers and a properly implemented recursive disassembler.</p>
</li>
<li><p>Please don’t comment with things such as “The hello world string would be visible anyway” … of course it will be! That’s just an example, ideally the data stored in the function would be encrypted, thus binary.</p>
</li>
<li><p>It is possible to fool even a recursive disasm, just make a call to the fake function, catch the signal and go on … the disasm will see the call and consider it as a legit function.</p>
</li>
<li><p>Nice things happen when you start declaring odd sized constants on ARM, since the opcode align is of 4 bytes, that could screw in some cases the analysis of the next code portions.</p>
</li>
</ul>
<h2 id="Naked-Functions"><a href="#Naked-Functions" class="headerlink" title="Naked Functions"></a>Naked Functions</h2><p>Let’s start with the definition of what a <strong>naked</strong> function is. Basically whenever you declare a C/C++ function inside your code, the compiler will add some extra assembly code to the beginning and to the end of it, this code is responsible for cleaning the stack, popping arguments of the function and so forth.<br>If you try to compile the following function:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">( <span class="keyword">int</span> a, <span class="keyword">int</span> b )</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The resulting ( ARM ) assembly will be:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">push	&#123;fp&#125;		; (str fp, [sp, #-4]!)</span><br><span class="line">add	fp, sp, #0</span><br><span class="line">sub	sp, sp, #12</span><br><span class="line">str	r0, [fp, #-8]</span><br><span class="line">str	r1, [fp, #-12]</span><br><span class="line">ldr	r2, [fp, #-8]</span><br><span class="line">ldr	r3, [fp, #-12]</span><br><span class="line">add	r3, r2, r3</span><br><span class="line">mov	r0, r3</span><br><span class="line">sub	sp, fp, #0</span><br><span class="line">pop	&#123;fp&#125;		; (ldr fp, [sp], #4)</span><br><span class="line">bx	lr</span><br></pre></td></tr></table></figure>

<p>As you can see, there’s a lot of extra stuff rather than just the expected <strong>add</strong> operator.<br>The first instructions basically save the current frame pointer and load the function arguments into the appropriate registers, then the <strong>add r3, r2, r3</strong> itself is performed ( this is the original purpose of our sum function ), the result is moved inside <strong>R0</strong> ( which by convention is the register that stores the return value of the function ), the original stack is restored and eventually there’s a branch to <strong>LR</strong>, namely a jump back to the previous address ( the one that called <strong>sum</strong> ).</p>
<p>In order to “avoid” those extra operators ( and generally speaking it’s not a good idea to avoid them unless you really know what you’re doing ), we can use the <strong>naked</strong> GCC attribute, its definition on the <a target="_blank" rel="noopener" href="https://gcc.gnu.org/onlinedocs/gcc/Function-Attributes.html">docs</a> is:</p>
<pre><code>Use this attribute on the ARM, AVR, IP2K, RX and SPU ports to indicate that the specified
function does not need prologue/epilogue sequences generated by the compiler.
It is up to the programmer to provide these sequences. The only statements that can be safely
included in naked functions are asm statements that do not have operands. All other statements,
including declarations of local variables, if statements, and so forth, should be avoided.
Naked functions should be used to implement the body of an assembly function, while allowing
the compiler to construct the requisite function declaration for the assembler.</code></pre>
<p>Now, let’s try to use this attribute with the same sum function:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">__attribute__ ((naked)) <span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">( <span class="keyword">int</span> a, <span class="keyword">int</span> b )</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The resulting assembly code will be just:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mov	r2, r0</span><br><span class="line">mov	r3, r1</span><br><span class="line">add	r3, r2, r3</span><br><span class="line">mov	r0, r3</span><br></pre></td></tr></table></figure>

<p>As you can see, only the add and return operations have been compiled this time, with no prologue and epilogue whatsoever.<br>Obviously if you try to call the naked sum function, the program will crash with a <strong>Segmentation Fault</strong> message, due to the stack not being properly prepared and cleaned as we saw in the previous example.</p>
<p>So how can we use the naked attribute?</p>
<h2 id="Inline-ASM"><a href="#Inline-ASM" class="headerlink" title="Inline ASM"></a>Inline ASM</h2><p>If you’re a C/C++ developer you probably already know ( or at least you should! ) that you can use raw assembly inside your C/C++ code using the <strong>asm</strong> gcc directive, if you don’t you definitely need to read the <a target="_blank" rel="noopener" href="https://gcc.gnu.org/onlinedocs/gcc/Basic-Asm.html#Basic-Asm">GCC documentation</a> about that ( and shame on you! :D ).<br>An interesting ASM directive we can exploit for our purpose is <strong>.long</strong> ( you can find it <a target="_blank" rel="noopener" href="http://www.coranac.com/files/gba/re-ejected-gasref.pdf">here</a> inside the “Constannt Definition Directives” section ), which basically allows you to directly define a constant value inside your assembly code.<br>You would normally use that to define a numeric constant to use in your code, but what happens if we embed it in a naked function?</p>
<p>Let’s take the following example:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">__attribute__ ((naked)) <span class="function"><span class="keyword">void</span> <span class="title">my_mum_said_im_special</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">asm</span> ( <span class="string">&quot;.long 0x6C6C6548&quot;</span> );</span><br><span class="line">    <span class="keyword">asm</span> ( <span class="string">&quot;.long 0x6f57206f&quot;</span> );</span><br><span class="line">    <span class="keyword">asm</span> ( <span class="string">&quot;.long 0x00646c72&quot;</span> );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>What you see there is the definition of four constants of four bytes each, 16 bytes in total, which are the string</p>
<pre><code>&quot;\0dlroW olleH&quot;</code></pre>
<p>Seems familiar? No? Well … try to reverse it and you’ll get the famous “Hello World” constant string with his null byte, since it’s represented as numbers the ARM endianess requires them to be in reverse order.</p>
<p>Now some magic with pointers, let’s try to take the address of this function, cast it to a *<em>const char **</em> and printf it.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *s = (<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;my_mum_said_im_special;</span><br><span class="line"><span class="built_in">printf</span>( <span class="string">&quot;%s\n&quot;</span>, s );</span><br></pre></td></tr></table></figure>

<p>The output will be, as expected, an “Hello World” :D</p>
<p>But how does the decompiler sees this function? Is it able to determine it’s actually just data and not code? The answer of course it’s <strong>NO</strong>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">00000338 &lt;my_mum_said_im_special&gt;:</span><br><span class="line">  cfstr64vs	mvdx6, [ip], #-288	; 0xfffffee0</span><br><span class="line">  svcvs	0x0057206f</span><br><span class="line">  rsbeq	r6, r4, r2, ror ip</span><br></pre></td></tr></table></figure>

<p>The <strong>objdump</strong> utility simply took those bytes and tried to interpret them as ARM opcodes, miserably failing to detect them as data instead of code.<br>What about more sophisticated disassemblers?</p>
<p>The following is a screenshot of the <strong>Hopper</strong> disassembler:</p>
<p><img src="/images/2015/05/hopper.png" alt="Hopper"></p>
<p>In this case we even get a totally different code … what about <strong>IDA</strong>, the state of the art disassembler?</p>
<p><img src="/images/2015/05/ida.jpg" alt="ida"></p>
<p>Again different code :D</p>
<p>Now try to imagine, instead of a simple “Hello World”, to put some strongly encrypted data or even strongly encrypted code that you can decrypt and execute at runtime.<br>In my experiments, this trick not only is able to fool every decompiler I tried, but in some cases it’s even able to screw all the code that follows the naked function and/or make the decompiler crash!</p>
<p>Enjoy :)</p>

  </div>

  
    <div class="post-tags">
      
        <a href="/tags/arm/" class="tag">#arm</a>
      
        <a href="/tags/hack/" class="tag">#hack</a>
      
        <a href="/tags/ida/" class="tag">#ida</a>
      
        <a href="/tags/assembly/" class="tag">#assembly</a>
      
        <a href="/tags/naked-functions/" class="tag">#naked functions</a>
      
        <a href="/tags/inline/" class="tag">#inline</a>
      
        <a href="/tags/inline-assembly/" class="tag">#inline assembly</a>
      
        <a href="/tags/disassembler/" class="tag">#disassembler</a>
      
        <a href="/tags/hopper/" class="tag">#hopper</a>
      
        <a href="/tags/objdump/" class="tag">#objdump</a>
      
        <a href="/tags/trick/" class="tag">#trick</a>
      
    </div>
  

  <nav class="post-navigation">
    
      <a href="/2015/05/04/Android-Native-API-Hooking-with-Library-Injection-and-ELF-Introspection/" class="nav-prev">
        <span class="nav-label">PREVIOUS</span>
        <span class="nav-title">Android Native API Hooking With Library Injection and ELF Introspection.</span>
      </a>
    
    
      <a href="/2015/05/01/Dynamically-inject-a-shared-library-into-a-running-process-on-Android-ARM/" class="nav-next">
        <span class="nav-label">NEXT</span>
        <span class="nav-title">Dynamically Inject a Shared Library Into a Running Process on Android/ARM</span>
      </a>
    
  </nav>
</article>


  


<section class="related-posts">
  <h3 class="related-title">YOU MIGHT ALSO LIKE...</h3>
  <div class="cards-grid cards-grid-related">
    
      

<article class="card card-light">
  <a href="/2016/10/09/IoCOFFEE-Reversing-the-Smarter-Coffee-IoT-machine-protocol-to-make-coffee-using-terminal/" class="card-link">
    
      <div class="card-image" style="background-image: url('/images/2016/10/terminal.png')">
        
      </div>
    
    
    
      <div class="card-content">
        
          <span class="card-category">reversing</span>
        
        <h2 class="card-title">Reversing the Smarter Coffee IoT Machine Protocol to Make Coffee Using the Terminal.</h2>
        
        <div class="card-footer">
          <span class="card-read-more">READ MORE</span>
        </div>
      </div>
    
  </a>
</article>

    
      

<article class="card card-overlay">
  <a href="/2016/01/18/Autopwn-every-Android-4-2-device-on-your-network-using-BetterCap-and-the-addJavascriptInterface-vulnerability/" class="card-link">
    
      <div class="card-image" style="background-image: url('/images/2016/01/hacked.jpg')">
        
          <div class="card-overlay-content">
            
              <span class="card-category">android</span>
            
            <h2 class="card-title">Autopwn Every Android &lt; 4.2 Device on Your Network Using BetterCap and the addJavascriptInterface Vulnerability.</h2>
            <span class="card-read-more">READ MORE</span>
          </div>
        
      </div>
    
    
    
  </a>
</article>

    
      

<article class="card card-overlay">
  <a href="/2015/05/04/Android-Native-API-Hooking-with-Library-Injection-and-ELF-Introspection/" class="card-link">
    
      <div class="card-image" style="background-image: url('/images/default-cover.svg')">
        
          <div class="card-overlay-content">
            
              <span class="card-category">android</span>
            
            <h2 class="card-title">Android Native API Hooking With Library Injection and ELF Introspection.</h2>
            <span class="card-read-more">READ MORE</span>
          </div>
        
      </div>
    
    
    
  </a>
</article>

    
      

<article class="card card-light">
  <a href="/2015/05/01/Dynamically-inject-a-shared-library-into-a-running-process-on-Android-ARM/" class="card-link">
    
      <div class="card-image" style="background-image: url('/images/2015/05/116572.jpg')">
        
      </div>
    
    
    
      <div class="card-content">
        
          <span class="card-category">android</span>
        
        <h2 class="card-title">Dynamically Inject a Shared Library Into a Running Process on Android/ARM</h2>
        
        <div class="card-footer">
          <span class="card-read-more">READ MORE</span>
        </div>
      </div>
    
  </a>
</article>

    
  </div>
</section>




  </main>
  
  <footer class="site-footer">
  <div class="footer-inner">
    <div class="footer-social">
      
        
          
            <a href="https://github.com/evilsocket" class="social-link" target="_blank" rel="noopener" aria-label="GitHub">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
            </a>
          
        
          
            <a href="https://twitter.com/evilsocket" class="social-link" target="_blank" rel="noopener" aria-label="Twitter">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
            </a>
          
        
          
            <a href="http://it.linkedin.com/in/simonemargaritelli/" class="social-link" target="_blank" rel="noopener" aria-label="LinkedIn">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
            </a>
          
        
          
        
          
            <a href="mailto:evilsocket@gmail.com" class="social-link" aria-label="Email">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
            </a>
          
        
      
    </div>
    <p class="footer-copyright">
      &copy; 2025 evilsocket. 
      Powered by <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a>.
    </p>
  </div>
</footer>

  <!-- Minimal JS - no external dependencies needed -->
<script>
  // Lazy load images
  document.addEventListener('DOMContentLoaded', function() {
    var images = document.querySelectorAll('.card-image[data-bg]');
    images.forEach(function(img) {
      img.style.backgroundImage = 'url(' + img.dataset.bg + ')';
    });
  });
</script>

</body>
</html>
