<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Introducing Bettercap 2.4.0: CAN-Bus Hacking, WiFi Bruteforcing and Builtin Web UI | evilsocket</title>
<meta name="description" content="I’m happy to announce, after quite some time, the new bettercap 2.4.0 major release. Other than including a plethora of long due fixes (additionally to what the">


  <link rel="alternate" href="/atom.xml" title="evilsocket" type="application/atom+xml">


<link rel="icon" href="/images/favicon.ico">

<!-- Open Graph -->
<meta property="og:type" content="article">
<meta property="og:title" content="Introducing Bettercap 2.4.0: CAN-Bus Hacking, WiFi Bruteforcing and Builtin Web UI">
<meta property="og:description" content="I’m happy to announce, after quite some time, the new bettercap 2.4.0 major release. Other than including a plethora of long due fixes (additionally to what the">
<meta property="og:url" content="/2024/09/13/Introducing-bettercap-2-4-0-CAN-bus-hacking-WiFi-bruteforcing-and-builtin-web-UI/">
<meta property="og:site_name" content="evilsocket">

  
  
    <meta property="og:image" content="/images/2024/ecus.png">
  


<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Introducing Bettercap 2.4.0: CAN-Bus Hacking, WiFi Bruteforcing and Builtin Web UI">
<meta name="twitter:description" content="I’m happy to announce, after quite some time, the new bettercap 2.4.0 major release. Other than including a plethora of long due fixes (additionally to what the">

<!-- Schema.org JSON-LD -->


<script type="application/ld+json">
{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.evilsocket.net/2024/09/13/Introducing-bettercap-2-4-0-CAN-bus-hacking-WiFi-bruteforcing-and-builtin-web-UI/"},"headline":"Introducing Bettercap 2.4.0: CAN-Bus Hacking, WiFi Bruteforcing and Builtin Web UI","description":"I’m happy to announce, after quite some time, the new bettercap 2.4.0 major release. Other than including a plethora of long due fixes (additionally to what the","image":"https://www.evilsocket.net/images/2024/ecus.png","datePublished":"2024-09-13T10:46:25.000Z","dateModified":"2024-09-13T17:16:00.000Z","author":{"@type":"Person","name":"Simone Margaritelli","description":"Italian cybersecurity researcher and open-source developer","url":"https://www.evilsocket.net","sameAs":["https://github.com/evilsocket","https://twitter.com/evilsocket","http://it.linkedin.com/in/simonemargaritelli/"],"jobTitle":"Security Researcher","worksFor":{"@type":"Organization","name":"Independent"}},"publisher":{"@type":"Organization","name":"evilsocket","url":"https://www.evilsocket.net","logo":{"@type":"ImageObject","url":"https://www.evilsocket.net/images/glider.png"}},"keywords":"bettercap, can-bus, canbus, car hacking, ics, wifi bruteforcing, webui","articleSection":"Technology","inLanguage":"en"}
</script>


<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<!-- Styles -->
<link rel="stylesheet" href="/css/style.css">


<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-22026549-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-22026549-1');
</script>


<meta name="generator" content="Hexo 5.4.2"></head>
<body class="post-page">
  <header class="site-header">
  <div class="header-inner">
    <div class="site-branding">
      <a href="/" class="site-logo">
        
          <img src="/images/glider.png" alt="evilsocket" width="50" height="50">
        
        <span class="site-title">evilsocket</span>
      </a>
    </div>
    
    <nav class="site-nav">
      
        <a href="/" class="nav-link">
          HOME
        </a>
      
        <a href="/atom.xml" class="nav-link">
          RSS
        </a>
      
    </nav>
  </div>
</header>

  
  <main class="main-content">
    <article class="post-full">
  <header class="post-header">
    <h1 class="post-title">Introducing Bettercap 2.4.0: CAN-Bus Hacking, WiFi Bruteforcing and Builtin Web UI</h1>
    <div class="post-meta">
      BY <span class="post-author">Simone Margaritelli</span>
      — <time datetime="2024-09-13T10:46:25.000Z">13 Sep 2024</time>
      
        — <a href="/tags/bettercap/" class="post-category">bettercap</a>, <a href="/tags/can-bus/" class="post-category">can-bus</a>, <a href="/tags/canbus/" class="post-category">canbus</a>, <a href="/tags/car-hacking/" class="post-category">car hacking</a>, <a href="/tags/ics/" class="post-category">ics</a>, <a href="/tags/wifi-bruteforcing/" class="post-category">wifi bruteforcing</a>, <a href="/tags/webui/" class="post-category">webui</a>
      
    </div>
  </header>

  
  
    <div class="post-cover">
      <img src="/images/2024/ecus.png" alt="Introducing Bettercap 2.4.0: CAN-Bus Hacking, WiFi Bruteforcing and Builtin Web UI">
    </div>
  

  <div class="post-content">
    <p>I’m happy to announce, after quite some time, the new bettercap 2.4.0 major release. Other than including a plethora of long due fixes (additionally to what the <a target="_blank" rel="noopener" href="https://github.com/bettercap/bettercap/releases/tag/v2.33.0">recent 2.33.0 already fixed</a>), it also packs a few new functionalities that extend its reach to car and industrial control system hacking. It’ll possibly take me some time to update the documentation on <a target="_blank" rel="noopener" href="https://bettercap.org/">the official website</a> so I’m here today to write a bit about the new features. Also remember that you can use the <code>help</code>, <code>help ui</code>, <code>help can</code> and <code>help wifi</code> commands to check all the new options and added functionalities.</p>
<span id="more"></span>

<h2 id="Car-and-ICS-hacking-with-the-new-CAN-module"><a href="#Car-and-ICS-hacking-with-the-new-CAN-module" class="headerlink" title="Car and ICS hacking with the new CAN module"></a>Car and ICS hacking with the new CAN module</h2><p>One of the protocols that always fascinated me but that I never really approached other than attending conference talks about it is CAN-bus. There are <a target="_blank" rel="noopener" href="https://www.reddit.com/r/CarHacking/comments/ltbrzk/can_bus_and_car_hacking_getting_started_resources/">plenty of resources</a> to get you started with it so I’m not going too much into the details of it or the related attacks. The bottom line is that CAN-bus is a protocol used inside cars and some ICS that some components use to communicate diagnostics to the rest of the system. Everything is broadcasted, most of it is in the clear, there’re a multitude of attacks that can be performed, it’s a mess.</p>
<p>From a security researcher perspective however, other than the very basic ones inside the <code>can-tools</code> package, there’s not a single decent tool oriented to security. Most people end up writing their own python code that only works for that specific scenario or only showcases a specific attack.</p>
<p>So the new CAN module is an attempt to create a framework for this research that we can all easily access and use. Specifically, the new module can interact with any CAN-bus hardware that supports <code>socketcan</code> (if there’s also interest in CAN-bus over serial let me know and I’ll do my best to integrate it) and allows to:</p>
<h3 id="Read-write-and-fuzz-raw-frames"><a href="#Read-write-and-fuzz-raw-frames" class="headerlink" title="Read, write and fuzz raw frames"></a>Read, write and fuzz raw frames</h3><p>The very basic of CAN-bus functionalities. Set your device and enable the module to start reading raw frames:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">set can.device &#x2F;dev&#x2F;can0</span><br><span class="line"></span><br><span class="line">can.recon on</span><br></pre></td></tr></table></figure>

<p>You can also load and <strong>replay</strong> a dump previously captured with candump:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">set can.dump obd2-candump-2023-11-22_031813.log</span><br><span class="line"></span><br><span class="line">can.recon on</span><br></pre></td></tr></table></figure>

<p>Inject raw frames as <code>id#hex-data</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">can.inject 0#aabbccddee</span><br></pre></td></tr></table></figure>

<p>Or generate random ones for fuzzing with <code>can.fuzz id size</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">can.fuzz ff 8</span><br></pre></td></tr></table></figure>

<p>And show a list of the detected ECUs:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">can.show</span><br></pre></td></tr></table></figure>

<h3 id="Load-your-own-DBC-files-decode-traffic-and-fuzz-with-them"><a href="#Load-your-own-DBC-files-decode-traffic-and-fuzz-with-them" class="headerlink" title="Load your own DBC files, decode traffic and fuzz with them"></a>Load your own DBC files, decode traffic and fuzz with them</h3><p>You can also use CAN-bus database files that describe a specific protocol, in which case bettercap will use it to automatically parse every frame on the bus (<a target="_blank" rel="noopener" href="https://www.csselectronics.com/pages/obd2-dbc-file">css-electronics</a> and <a target="_blank" rel="noopener" href="https://github.com/commaai/opendbc">comma.ai</a> have some very good ones):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">set can.device &#x2F;dev&#x2F;can0</span><br><span class="line"></span><br><span class="line">can.dbc.load css-electronics&#x2F;obd2-pack-v5&#x2F;obd2-dbc&#x2F;CSS-Electronics-11-bit-OBD2-v2.2.dbc</span><br><span class="line"></span><br><span class="line">can.recon on</span><br></pre></td></tr></table></figure>

<p>When running with a DBC, you’ll also be able to use use it for fuzzing. For instance, to generate a specific message given its id, with randomized content:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">can.fuzz 12</span><br></pre></td></tr></table></figure>

<p>To instead pick a random message from a specific ECU and generate its contents randomly:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">can.fuzz ECU_name</span><br></pre></td></tr></table></figure>

<h3 id="Decode-OBD2-PIDs-with-builtin-decoder"><a href="#Decode-OBD2-PIDs-with-builtin-decoder" class="headerlink" title="Decode OBD2 PIDs with builtin decoder"></a>Decode OBD2 PIDs with builtin decoder</h3><p>Alternatively to using a DBC, if you work with OBD2 standard PIDs, you can just enable the builtin PID parser:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">set can.device &#x2F;dev&#x2F;can0</span><br><span class="line">set can.parse.obd2 true</span><br><span class="line">can.recon on</span><br></pre></td></tr></table></figure>

<p>For the first iteration of the CAN module this is all. I’m sure that many new features will be added in the future and many integrations with the builting scripting engine (the module can <a target="_blank" rel="noopener" href="https://www.bettercap.org/usage/scripting/">already be scripted</a>).</p>
<p>Now to the WiFi :D</p>
<h2 id="Wireless-low-hanging-fruits-with-the-new-WiFi-bruteforcer"><a href="#Wireless-low-hanging-fruits-with-the-new-WiFi-bruteforcer" class="headerlink" title="Wireless low-hanging fruits with the new WiFi bruteforcer"></a>Wireless low-hanging fruits with the new WiFi bruteforcer</h2><p>A while back a user created a github issue with a <a target="_blank" rel="noopener" href="https://github.com/bettercap/bettercap/issues/1075">very smart feature request</a>: since many routers and printers have very simple wifi passwords, it is reasonable to expect that a wordlist based attack might be more successful at times than capturing and cracking the handshake.</p>
<p>So now we have <code>wifi.bruteforce</code>, that works wonderfully on both macOS and Linux:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">set wifi.interface en0</span><br><span class="line"></span><br><span class="line"># one or comma separated list</span><br><span class="line">set wifi.bruteforce.target TargetRouter</span><br><span class="line"></span><br><span class="line"># uncomment to attempt a password for each access point before moving to the next one</span><br><span class="line"># set wifi.bruteforce.wide true</span><br><span class="line"></span><br><span class="line"># set the wordlist to use</span><br><span class="line">set wifi.bruteforce.wordlist &#x2F;path&#x2F;to&#x2F;your&#x2F;wordlist.txt</span><br><span class="line"></span><br><span class="line"># stop at the first successful login</span><br><span class="line">set wifi.bruteforce.stop_at_first true</span><br><span class="line"></span><br><span class="line">wifi.bruteforce on</span><br></pre></td></tr></table></figure>

<h2 id="Builtin-Web-UI"><a href="#Builtin-Web-UI" class="headerlink" title="Builtin Web UI"></a>Builtin Web UI</h2><p>Due to a series of issues with how Kali linux packaged bettercap’s webui, many users had a lot of troubles making it work correctly. Now the web ui is not something you have to download separately anymore, but it’s integrated as a module and all you have to do is:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ui on</span><br></pre></td></tr></table></figure>

<p>Obviously the CAN module is already integrated with it. I hope this makes things easier :D</p>
<p><img src="/images/2024/ecus.png" alt="ECU panel"></p>
<p><img src="/images/2024/pids.png" alt="PIDs"></p>
<h2 id="A-final-note-about-BLE-and-precompiled-binaries"><a href="#A-final-note-about-BLE-and-precompiled-binaries" class="headerlink" title="A final note about BLE and precompiled binaries"></a>A final note about BLE and precompiled binaries</h2><p>I’m also <a target="_blank" rel="noopener" href="https://github.com/bettercap/bettercap/issues/1116">rewriting the BLE module</a>, but this will take some more time as I’m trying to make it work in a stable way for every supported operating system, which is everything but simple :D </p>
<p>Precompiled binaries will soon be uploaded to the github repo, meanwhile you can use the docker image or compile from source (compilation with <code>make</code> has been fixed too).</p>
<p>Stay tuned and as usual <a target="_blank" rel="noopener" href="https://github.com/bettercap/bettercap/releases/tag/v2.4.0">enjoy</a>!</p>

  </div>

  
    <div class="post-tags">
      
        <a href="/tags/bettercap/" class="tag">#bettercap</a>
      
        <a href="/tags/can-bus/" class="tag">#can-bus</a>
      
        <a href="/tags/canbus/" class="tag">#canbus</a>
      
        <a href="/tags/car-hacking/" class="tag">#car hacking</a>
      
        <a href="/tags/ics/" class="tag">#ics</a>
      
        <a href="/tags/wifi-bruteforcing/" class="tag">#wifi bruteforcing</a>
      
        <a href="/tags/webui/" class="tag">#webui</a>
      
    </div>
  

  <nav class="post-navigation">
    
      <a href="/2024/09/26/Attacking-UNIX-systems-via-CUPS-Part-I/" class="nav-prev">
        <span class="nav-label">PREVIOUS</span>
        <span class="nav-title">Attacking UNIX Systems via CUPS, Part I</span>
      </a>
    
    
      <a href="/2023/11/02/Enumerate-Bruteforce-Attack-All-The-Things-Presenting-Legba/" class="nav-next">
        <span class="nav-label">NEXT</span>
        <span class="nav-title">Enumerate/Bruteforce/Attack All the Things! Presenting Legba</span>
      </a>
    
  </nav>
</article>


  


<section class="related-posts">
  <h3 class="related-title">YOU MIGHT ALSO LIKE...</h3>
  <div class="cards-grid cards-grid-related">
    
      

<article class="card card-light">
  <a href="/2019/10/19/Weaponizing-and-Gamifying-AI-for-WiFi-Hacking-Presenting-Pwnagotchi-1-0-0/" class="card-link">
    
      <div class="card-image" style="background-image: url('https://i.imgur.com/X68GXrn.png')">
        
      </div>
    
    
    
      <div class="card-content">
        
          <span class="card-category">bettercap</span>
        
        <h2 class="card-title">Weaponizing and Gamifying AI for WiFi Hacking: Presenting Pwnagotchi 1.0.0</h2>
        
        <div class="card-footer">
          <span class="card-read-more">READ MORE</span>
        </div>
      </div>
    
  </a>
</article>

    
      

<article class="card card-overlay">
  <a href="/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/" class="card-link">
    
      <div class="card-image" style="background-image: url('https://raw.githubusercontent.com/bettercap/media/master/logo.png')">
        
          <div class="card-overlay-content">
            
              <span class="card-category">bettercap</span>
            
            <h2 class="card-title">Pwning WPA/WPA2 Networks With Bettercap and the PMKID Client-Less Attack</h2>
            <span class="card-read-more">READ MORE</span>
          </div>
        
      </div>
    
    
    
  </a>
</article>

    
      

<article class="card card-overlay">
  <a href="/2018/07/28/Project-PITA-Writeup-build-a-mini-mass-deauther-using-bettercap-and-a-Raspberry-Pi-Zero-W/" class="card-link">
    
      <div class="card-image" style="background-image: url('/images/2018/07/deauth.png')">
        
          <div class="card-overlay-content">
            
              <span class="card-category">bettercap</span>
            
            <h2 class="card-title">Project PITA: Build a Mini Mass Deauther Using Bettercap and a Raspberry Pi Zero W</h2>
            <span class="card-read-more">READ MORE</span>
          </div>
        
      </div>
    
    
    
  </a>
</article>

    
      

<article class="card card-light">
  <a href="/2018/02/27/All-hail-bettercap-2-0-one-tool-to-rule-them-all/" class="card-link">
    
      <div class="card-image" style="background-image: url('https://www.bettercap.org/img/logo.png')">
        
      </div>
    
    
    
      <div class="card-content">
        
          <span class="card-category">bettercap</span>
        
        <h2 class="card-title">All Hail Bettercap 2.0, One Tool to Rule Them All.</h2>
        
        <div class="card-footer">
          <span class="card-read-more">READ MORE</span>
        </div>
      </div>
    
  </a>
</article>

    
  </div>
</section>




  </main>
  
  <footer class="site-footer">
  <div class="footer-inner">
    <div class="footer-social">
      
        
          
            <a href="https://github.com/evilsocket" class="social-link" target="_blank" rel="noopener" aria-label="GitHub">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
            </a>
          
        
          
            <a href="https://twitter.com/evilsocket" class="social-link" target="_blank" rel="noopener" aria-label="Twitter">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
            </a>
          
        
          
            <a href="http://it.linkedin.com/in/simonemargaritelli/" class="social-link" target="_blank" rel="noopener" aria-label="LinkedIn">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
            </a>
          
        
          
        
          
            <a href="mailto:evilsocket@gmail.com" class="social-link" aria-label="Email">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
            </a>
          
        
      
    </div>
    <p class="footer-copyright">
      &copy; 2025 evilsocket. 
      Powered by <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a>.
    </p>
  </div>
</footer>

  <!-- Minimal JS - no external dependencies needed -->
<script>
  // Lazy load images
  document.addEventListener('DOMContentLoaded', function() {
    var images = document.querySelectorAll('.card-image[data-bg]');
    images.forEach(function(img) {
      img.style.backgroundImage = 'url(' + img.dataset.bg + ')';
    });
  });
</script>

</body>
</html>
