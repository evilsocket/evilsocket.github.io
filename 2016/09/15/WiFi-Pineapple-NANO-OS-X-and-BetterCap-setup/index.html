<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>WiFi Pentesting With a Pineapple NANO, OS X and BetterCap | evilsocket</title>
<meta name="description" content="After a few weeks of testing on the field, I’ve found the perfect configuration for WiFi pentesting using a WiFi Pineapple NANO, an OSX laptop and BetterCap.Sin">


  <link rel="alternate" href="/atom.xml" title="evilsocket" type="application/atom+xml">


<link rel="icon" href="/images/favicon.ico">

<!-- Open Graph -->
<meta property="og:type" content="article">
<meta property="og:title" content="WiFi Pentesting With a Pineapple NANO, OS X and BetterCap">
<meta property="og:description" content="After a few weeks of testing on the field, I’ve found the perfect configuration for WiFi pentesting using a WiFi Pineapple NANO, an OSX laptop and BetterCap.Sin">
<meta property="og:url" content="/2016/09/15/WiFi-Pineapple-NANO-OS-X-and-BetterCap-setup/">
<meta property="og:site_name" content="evilsocket">

  
  
    <meta property="og:image" content="/images/2016/09/nano.jpg">
  


<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="WiFi Pentesting With a Pineapple NANO, OS X and BetterCap">
<meta name="twitter:description" content="After a few weeks of testing on the field, I’ve found the perfect configuration for WiFi pentesting using a WiFi Pineapple NANO, an OSX laptop and BetterCap.Sin">

<!-- Schema.org JSON-LD -->


<script type="application/ld+json">
{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.evilsocket.net/2016/09/15/WiFi-Pineapple-NANO-OS-X-and-BetterCap-setup/"},"headline":"WiFi Pentesting With a Pineapple NANO, OS X and BetterCap","description":"After a few weeks of testing on the field, I’ve found the perfect configuration for WiFi pentesting using a WiFi Pineapple NANO, an OSX laptop and BetterCap.Sin","image":"https://www.evilsocket.net/images/2016/09/nano.jpg","datePublished":"2016-09-15T12:48:23.000Z","dateModified":"2021-03-01T18:05:26.000Z","author":{"@type":"Person","name":"Simone Margaritelli","description":"Italian cybersecurity researcher and open-source developer","url":"https://www.evilsocket.net","sameAs":["https://github.com/evilsocket","https://twitter.com/evilsocket","http://it.linkedin.com/in/simonemargaritelli/"],"jobTitle":"Security Researcher","worksFor":{"@type":"Organization","name":"Independent"}},"publisher":{"@type":"Organization","name":"evilsocket","url":"https://www.evilsocket.net","logo":{"@type":"ImageObject","url":"https://www.evilsocket.net/images/glider.png"}},"keywords":"bettercap, mitm, firewall, osx, wifi pineapple, wifi pentesting, internet connection sharing, pineapple nano, setup","articleSection":"Technology","inLanguage":"en"}
</script>


<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<!-- Styles -->
<link rel="stylesheet" href="/css/style.css">


<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-22026549-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-22026549-1');
</script>


<meta name="generator" content="Hexo 5.4.2"></head>
<body class="post-page">
  <header class="site-header">
  <div class="header-inner">
    <div class="site-branding">
      <a href="/" class="site-logo">
        
          <img src="/images/glider.png" alt="evilsocket" width="50" height="50">
        
        <div class="site-title-group">
          <span class="site-title">evilsocket</span>
          <span class="site-motto">Preoccupied with a single leaf, you won't see the tree. Preoccupied with a single tree... you'll miss the entire forest.</span>
        </div>
      </a>
    </div>
    
    <nav class="site-nav">
      
        <a href="/" class="nav-link">
          HOME
        </a>
      
        <a href="/atom.xml" class="nav-link">
          RSS
        </a>
      
    </nav>
  </div>
</header>

  
  <main class="main-content">
    <article class="post-full">
  <header class="post-header">
    <h1 class="post-title">WiFi Pentesting With a Pineapple NANO, OS X and BetterCap</h1>
    <div class="post-meta">
      BY <span class="post-author">Simone Margaritelli</span>
      — <time datetime="2016-09-15T12:48:23.000Z">15 Sep 2016</time>
      
        — <a href="/tags/bettercap/" class="post-category">bettercap</a>, <a href="/tags/mitm/" class="post-category">mitm</a>, <a href="/tags/firewall/" class="post-category">firewall</a>, <a href="/tags/osx/" class="post-category">osx</a>, <a href="/tags/wifi-pineapple/" class="post-category">wifi pineapple</a>, <a href="/tags/wifi-pentesting/" class="post-category">wifi pentesting</a>, <a href="/tags/internet-connection-sharing/" class="post-category">internet connection sharing</a>, <a href="/tags/pineapple-nano/" class="post-category">pineapple nano</a>, <a href="/tags/setup/" class="post-category">setup</a>
      
    </div>
  </header>

  <div class="post-content">
    <p>After a few weeks of testing on the field, I’ve found the perfect configuration for WiFi pentesting using a WiFi Pineapple NANO, an OSX laptop and BetterCap.<br>Since different people from different forums had issues making this work ( mostly due to the difficulties of internet connection sharing between OSX and the Pineapple ) I’ve decided to share my setup today ^_^</p>
<p><img src="/images/2016/09/nano.jpg" alt="nano"></p>
<span id="more"></span>

<h3 id="WiFi-Pineapple-AKA-KARMA-attack-for-the-masses"><a href="#WiFi-Pineapple-AKA-KARMA-attack-for-the-masses" class="headerlink" title="WiFi Pineapple AKA KARMA attack for the masses"></a>WiFi Pineapple AKA KARMA attack for the masses</h3><p>First of all, let’s talk a little bit about the KARMA attack in case you have no idea what I’m talking about. <a target="_blank" rel="noopener" href="https://digi.ninja/karma/">DigiNinja</a> page on karma says:</p>
<pre><code>Karma is a set of patches to access point software to get it to respond to probe requests not just for itself but for any ESSID requested. This allows the AP to act as a lure to draw in any clients probing for known networks. The original Karma patches were released by Dino Dai Zovi for Madwifi, I then took over and ported the patches to Madwifi-ng and have now taken them to the new hostapd.</code></pre>
<p>Long story short, on each WiFi access point there’s a demon running called <strong>hostapd</strong> which receives probes from nearby clients ( your laptop, mobile, etc ) and only responds to the probes that were sent to its SSID, discarding everything else.<br>Someone created a patched version of the hostapd binary which instead accepts <strong>every probe</strong>, this results in a WiFi access point that pretends to be (for instance) your home network thus <strong>forcing</strong> nearby devices to automatically connect to it.</p>
<p>You can create such kind of “Evil Twin” AP using a Kali distribution, the right drivers, the right hardware and so forth, or you can also <a target="_blank" rel="noopener" href="https://penturalabs.wordpress.com/2013/04/25/blue-for-the-pineapple/">hack a cheap TPLink WR703N</a>, but the easiest, quickest (and IMHO more stable) solution is buying a WiFi Pineapple from <a target="_blank" rel="noopener" href="http://hakshop.myshopify.com/">Hak5 online shop</a>.</p>
<p>In my case, I have a MKV, a Tetra and a NANO, in this post I’ll talk about the latter.</p>
<h3 id="Internet-Connection-Sharing-with-OS-X"><a href="#Internet-Connection-Sharing-with-OS-X" class="headerlink" title="Internet Connection Sharing with OS X"></a>Internet Connection Sharing with OS X</h3><p>Once you’ve done with the <a target="_blank" rel="noopener" href="https://www.wifipineapple.com/pages/setup#nano">basic NANO configuration</a>, you’ll have your device up and running with the ip address <em>172.16.42.1</em>, in order to share the connection from your Mac wifi adapter to the NANO ( which is plugged to the Mac’s USB port at this point ) you’ll need to change this ip address to a different one which eventually will be “accepted” by the ICS OS X mechanism, so:</p>
<pre><code>ssh root@172.16.42.1

uci set network.lan.ipaddr=&#39;192.168.2.10&#39;
uci set network.lan.gateway=&#39;192.168.2.1&#39;
uci commit &amp;&amp; reboot</code></pre>
<p>You’ll then enable internet connection sharing from your Mac WiFi adapter to the NANO USB-Eth adapter:</p>
<p><img src="/images/2016/09/ics.png" alt="ics"></p>
<p>And eventually you’ll need to configure a static ip address for the interface:</p>
<p><img src="/images/2016/09/ip.png" alt="ip"></p>
<p>Almost done, you need to apply the correct firewall rules on your Mac to make everything work between the two interfaces, this is a bash script I’ve made ( in my case the NANO ethernet interface is <strong>en4</strong>, change it to your needs ):</p>
<pre><code>#!/bin/bash

if [ &quot;$(id -u)&quot; != &quot;0&quot; ]; then
   echo &quot;This script must be run as root.&quot; 1&gt;&amp;2
   exit 1
fi

sysctl -w net.inet.ip.forwarding=1
pfctl -e
echo &quot;nat on en0 from en4:network to any -&gt; (en0)&quot; | pfctl -f -</code></pre>
<p>Once you’ve launched it, you can ssh again into your NANO and verify that the connection sharing is actually working.</p>
<p><img src="/images/2016/09/ics_working.png" alt="ics working"></p>
<p>Last step, just configure and start <strong>PineAP</strong> as you normally would:</p>
<p><img src="/images/2016/09/pineap.png" alt="pineap"></p>
<p>You now have your KARMA attack running and nearby WiFi enabled devices should start connecting to your evil AP very soon :)</p>
<h3 id="Port-Redirection-and-BetterCap"><a href="#Port-Redirection-and-BetterCap" class="headerlink" title="Port Redirection and BetterCap"></a>Port Redirection and BetterCap</h3><p>Unfortunately making bettercap run on the NANO is a <strong>pain in the ass</strong> and, even if you manage to do it, its hardware is simply not powerful enough to properly running it while handling multiple connections, so I’ve decided to run it on the laptop and have the NANO redirect all HTTP (and optionally HTTPS) traffic to it.</p>
<p>Here’s a simple bash script that you need to copy to your NANO, it will enable or disable port redirection to your bettercap instance running on the laptop:</p>
<pre><code>#!/bin/bash

if [[ $# -eq 0 ]] ; then
    echo &quot;Usage: $0 (enable|disable)&quot;
    exit 1
fi

action=&quot;$1&quot;
case $action in
    enable)
      echo &quot;Enabling ...&quot;
      iptables -t nat -A PREROUTING -p tcp --dport 80 -j DNAT --to-destination $(uci get network.lan.gateway):8080
      iptables -t nat -A POSTROUTING -j MASQUERADE
    ;;
    disable)
      echo &quot;Disabling ...&quot;
      iptables -t nat -D PREROUTING -p tcp --dport 80 -j DNAT --to-destination $(uci get network.lan.gateway):8080
    ;;
    *)
      echo &quot;Usage: $0 (enable|disable)&quot;
      exit 1
    ;;
esac</code></pre>
<p>Once you’ve enabled port redirection, you can simply start bettercap on your laptop with your preferred command line and start intercepting the traffic of the target clients that have been forced to connect to your evil access point :D</p>
<p><img src="/images/2016/09/setup.jpg" alt="final setup"></p>
<p><strong>DONE! :D</strong> You won’t even need to MITM something, with this attack the targets will connect to you … enjoy! :)</p>

  </div>

  
    <div class="post-tags">
      
        <a href="/tags/bettercap/" class="tag">#bettercap</a>
      
        <a href="/tags/mitm/" class="tag">#mitm</a>
      
        <a href="/tags/firewall/" class="tag">#firewall</a>
      
        <a href="/tags/osx/" class="tag">#osx</a>
      
        <a href="/tags/wifi-pineapple/" class="tag">#wifi pineapple</a>
      
        <a href="/tags/wifi-pentesting/" class="tag">#wifi pentesting</a>
      
        <a href="/tags/internet-connection-sharing/" class="tag">#internet connection sharing</a>
      
        <a href="/tags/pineapple-nano/" class="tag">#pineapple nano</a>
      
        <a href="/tags/setup/" class="tag">#setup</a>
      
    </div>
  

  <nav class="post-navigation">
    
      <a href="/2016/10/02/Un-po-di-consigli-per-aspiranti-professionisti-del-settore-della-sicurezza-informatica/" class="nav-prev">
        <span class="nav-label">PREVIOUS</span>
        <span class="nav-title">Un Po Di Consigli per Aspiranti Professionisti Del Settore Della Sicurezza Informatica</span>
      </a>
    
    
      <a href="/2016/08/24/RCE-against-every-open-source-BTS/" class="nav-next">
        <span class="nav-label">NEXT</span>
        <span class="nav-title">DISCLOSURE - RCE Against Every Open Source BTS Software.</span>
      </a>
    
  </nav>
</article>


  


<section class="related-posts">
  <h3 class="related-title">YOU MIGHT ALSO LIKE...</h3>
  <div class="cards-grid cards-grid-related">
    
      

<article class="card card-light">
  <a href="/2024/09/13/Introducing-bettercap-2-4-0-CAN-bus-hacking-WiFi-bruteforcing-and-builtin-web-UI/" class="card-link">
    
      <div class="card-image" style="background-image: url('/images/2024/ecus.png')">
        
      </div>
    
    
    
      <div class="card-content">
        <h2 class="card-title">Introducing Bettercap 2.4.0: CAN-Bus Hacking, WiFi Bruteforcing and Builtin Web UI</h2>
        
        <div class="card-footer">
          <span class="card-read-more">READ MORE</span>
        </div>
      </div>
    
  </a>
</article>

    
      

<article class="card card-overlay">
  <a href="/2021/02/13/Hide-your-servers-in-plain-sight-presenting-ShieldWall/" class="card-link">
    
      <div class="card-image" style="background-image: url('/images/2021/shieldwall_gophers_vikings.jpg')">
        
          <div class="card-overlay-content">
            <h2 class="card-title">Hide Your Servers in Plain Sight, Presenting ShieldWall</h2>
            <span class="card-read-more">READ MORE</span>
          </div>
        
      </div>
    
    
    
  </a>
</article>

    
      

<article class="card card-overlay">
  <a href="/2019/10/19/Weaponizing-and-Gamifying-AI-for-WiFi-Hacking-Presenting-Pwnagotchi-1-0-0/" class="card-link">
    
      <div class="card-image" style="background-image: url('https://i.imgur.com/X68GXrn.png')">
        
          <div class="card-overlay-content">
            <h2 class="card-title">Weaponizing and Gamifying AI for WiFi Hacking: Presenting Pwnagotchi 1.0.0</h2>
            <span class="card-read-more">READ MORE</span>
          </div>
        
      </div>
    
    
    
  </a>
</article>

    
      

<article class="card card-light">
  <a href="/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/" class="card-link">
    
      <div class="card-image" style="background-image: url('https://raw.githubusercontent.com/bettercap/media/master/logo.png')">
        
      </div>
    
    
    
      <div class="card-content">
        <h2 class="card-title">Pwning WPA/WPA2 Networks With Bettercap and the PMKID Client-Less Attack</h2>
        
        <div class="card-footer">
          <span class="card-read-more">READ MORE</span>
        </div>
      </div>
    
  </a>
</article>

    
  </div>
</section>




  </main>
  
  <footer class="site-footer">
  <div class="footer-inner">
    <div class="footer-social">
      
        
          
            <a href="https://github.com/evilsocket" class="social-link" target="_blank" rel="noopener" aria-label="GitHub">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
            </a>
          
        
          
            <a href="https://twitter.com/evilsocket" class="social-link" target="_blank" rel="noopener" aria-label="Twitter">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
            </a>
          
        
          
            <a href="http://it.linkedin.com/in/simonemargaritelli/" class="social-link" target="_blank" rel="noopener" aria-label="LinkedIn">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
            </a>
          
        
          
        
          
            <a href="mailto:evilsocket@gmail.com" class="social-link" aria-label="Email">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
            </a>
          
        
      
    </div>
    <p class="footer-copyright">
      &copy; 2025 evilsocket. 
      Powered by <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a>.
    </p>
  </div>
</footer>

  <!-- Minimal JS - no external dependencies needed -->
<script>
  // Lazy load images
  document.addEventListener('DOMContentLoaded', function() {
    var images = document.querySelectorAll('.card-image[data-bg]');
    images.forEach(function(img) {
      img.style.backgroundImage = 'url(' + img.dataset.bg + ')';
    });
  });
</script>

</body>
</html>
